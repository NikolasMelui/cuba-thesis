<?xml version='1.0' encoding='UTF-8' ?>
<server>
    <mbean code="com.haulmont.cuba.core.app.PersistenceConfig"
           name="haulmont.cuba:service=PersistenceConfig">
        <depends>haulmont.cuba:service=DeployMarker</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.core.app.DataCache"
           name="haulmont.cuba:service=DataCache">
        <depends>haulmont.cuba:service=PersistenceConfig</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.core.app.ResourceRepository"
           name="haulmont.cuba:service=ResourceRepository">
        <depends>haulmont.cuba:service=DeployMarker</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.security.app.UserSessions"
           name="haulmont.cuba:service=UserSessions">
        <depends>haulmont.cuba:service=PersistenceConfig</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.core.app.ConfigStorage"
           name="haulmont.cuba:service=ConfigStorage">
        <depends>haulmont.cuba:service=UserSessions</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.core.app.UniqueNumbers"
           name="haulmont.cuba:service=UniqueNumbers">
        <depends>haulmont.cuba:service=UserSessions</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.core.app.Emailer"
           name="haulmont.cuba:service=Emailer">
        <!--<depends>jboss:service=Mail</depends>-->
        <depends>haulmont.cuba:service=UserSessions</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.security.app.EntityLog"
           name="haulmont.cuba:service=EntityLog">
        <depends>haulmont.cuba:service=UserSessions</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.core.app.ReportEngine"
           name="haulmont.cuba:service=ReportEngine">
        <depends>haulmont.cuba:service=UserSessions</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.core.app.FileStorage"
           name="haulmont.cuba:service=FileStorage">
        <depends>haulmont.cuba:service=UserSessions</depends>
    </mbean>

    <mbean code="com.haulmont.cuba.core.app.CubaDeployer"
           name="haulmont.cuba:service=CubaDeployer">
        <depends>haulmont.cuba:service=PersistenceConfig</depends>
        <depends>haulmont.cuba:service=DataCache</depends>
        <depends>haulmont.cuba:service=ResourceRepository</depends>
        <depends>haulmont.cuba:service=UserSessions</depends>
        <depends>haulmont.cuba:service=ConfigStorage</depends>
        <depends>haulmont.cuba:service=EntityLog</depends>
        <depends>haulmont.cuba:service=Emailer</depends>
        <depends>haulmont.cuba:service=UniqueNumbers</depends>
        <depends>haulmont.cuba:service=ReportEngine</depends>
        <depends>haulmont.cuba:service=FileStorage</depends>
    </mbean>

    <mbean code="org.jboss.varia.scheduler.Scheduler"
           name="haulmont.cuba:service=HeartbeatScheduler">
        <attribute name="StartAtStartup">true</attribute>
        <attribute name="SchedulableClass">com.haulmont.cuba.core.app.Heartbeat$Starter</attribute>
        <attribute name="InitialStartDate">NOW</attribute>
        <attribute name="SchedulePeriod">1000</attribute>
        <attribute name="InitialRepetitions">-1</attribute>
        <depends>haulmont.cuba:service=CubaDeployer</depends>
    </mbean>
</server>
