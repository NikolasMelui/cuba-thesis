<!--
  ~ Copyright (c) 2008-2015 Haulmont. All rights reserved.
  ~ Use is subject to license terms, see http://www.cuba-platform.com/license for details.
  -->

<window xmlns="http://schemas.haulmont.com/cuba/5.4/window.xsd"
        class="com.haulmont.cuba.web.app.ui.statistics.StatisticsWindow"
        messagesPack="com.haulmont.cuba.web.app.ui.statistics"
        caption="msg://perfStat.caption">

    <dsContext>
        <collectionDatasource id="jmxInstancesDs"
                              class="com.haulmont.cuba.core.entity.JmxInstance"
                              view="_local"
                              allowCommit="false"
                              datasourceClass="com.haulmont.cuba.web.app.ui.jmxcontrol.ds.JmxInstancesDatasource">
        </collectionDatasource>

        <groupDatasource id="statisticsDs"
                         class="com.haulmont.cuba.web.app.ui.statistics.PerformanceParameter"
                         datasourceClass="com.haulmont.cuba.web.app.ui.statistics.StatisticsDatasource"
                         view="_local">
        </groupDatasource>

    </dsContext>

    <timers>
        <timer id="valuesTimer" delay="5000" autostart="true" repeating="true" onTimer="onRefresh"/>
    </timers>

    <assign name="fieldWidth" value="theme://cuba.web.display-mbeans.field.width"/>
    <layout expand="main" spacing="true">
        <groupBox width="800px">
            <grid spacing="true">
                <columns>
                    <column/>
                    <column/>
                    <column/>
                </columns>
                <rows>
                    <row>
                        <label value="msg://com.haulmont.cuba.web.app.ui.jmxcontrol/localJmxNode"/>
                        <label id="localJmxField" stylename="h2" width="${fieldWidth}"/>
                    </row>
                    <row>
                        <label value="msg://com.haulmont.cuba.web.app.ui.jmxcontrol/targetJmxNode" align="MIDDLE_CENTER"/>
                        <lookupPickerField id="jmxConnectionField" optionsDatasource="jmxInstancesDs"
                                           width="${fieldWidth}" align="MIDDLE_CENTER"/>
                        <button id="monitorThreads" caption="msg://threadsMonitor" invoke="onMonitorThreads"
                                align="MIDDLE_CENTER"/>
                    </row>
                </rows>
            </grid>
        </groupBox>
        <hbox id="main" width="800px">
            <groupTable id="paramsTable" reorderingAllowed="false" sortable="false" width="AUTO" height="100%">
                <columns>
                    <group>
                        <column id="parameterGroup"/>
                    </group>
                    <column id="parameterName" calculatable="true"/>
                    <column id="currentStringValue"/>
                    <column id="average1mStringValue"/>
                    <column id="averageForUptime"/>
                </columns>
                <rows datasource="statisticsDs"/>
            </groupTable>
        </hbox>
    </layout>

</window>