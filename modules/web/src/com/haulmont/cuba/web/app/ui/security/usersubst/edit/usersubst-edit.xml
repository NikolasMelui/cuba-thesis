<window xmlns="http://www.haulmont.com/schema/cuba/gui/window.xsd"
        class="com.haulmont.cuba.gui.components.BasicEditor"
        messagesPack="com.haulmont.cuba.web.app.ui.security.usersubst"
        caption="msg://userSubstitution.caption"
        datasource="subst">

    <metadataContext>
        <view class="com.haulmont.cuba.security.entity.UserSubstitution" name="usersubst.edit">
            <property name="user" view="usersubst.edit"/>
            <property name="substitutedUser" view="usersubst.edit"/>
            <property name="endDate"/>
        </view>

        <view class="com.haulmont.cuba.security.entity.User" name="usersubst.edit">
            <property name="login"/>
            <property name="name"/>
        </view>
    </metadataContext>

    <dsContext>
        <datasource id="subst"
                    class="com.haulmont.cuba.security.entity.UserSubstitution"
                    view="usersubst.edit"/>

        <collectionDatasource id="users" class="com.haulmont.cuba.security.entity.User" view="usersubst.edit">
            <query>
                select u from sec$User u
            </query>
        </collectionDatasource>
    </dsContext>

    <layout>
        <vbox spacing="true">
            <hbox stylename="edit-area" spacing="true" margin="true">
                <grid spacing="true">
                    <columns>
                        <column flex="1"/>
                        <column flex="1"/>
                    </columns>
                    <rows>
                        <row>
                            <vbox align="MIDDLE_RIGHT">
                                <label value="msg://user"/>
                            </vbox>
                            <textField id="user" datasource="subst" property="user"
                                       required="true" editable="false"/>
                        </row>
                        <row>
                            <vbox align="MIDDLE_RIGHT">
                                <label value="msg://substUser"/>
                            </vbox>
                            <lookupField id="substUser" datasource="subst" property="substitutedUser"
                                         required="true" optionsDatasource="users"/>
                        </row>
                        <row>
                            <vbox align="MIDDLE_RIGHT">
                                <label value="msg://endDate"/>
                            </vbox>
                            <dateField id="endDate" datasource="subst" property="endDate" dateFormat="dd/MM/yyyy"/>
                        </row>
                    </rows>
                </grid>
            </hbox>

            <iframe id="windowActions" src="/com/haulmont/cuba/gui/edit-window.actions.xml"/>
        </vbox>
    </layout>
</window>