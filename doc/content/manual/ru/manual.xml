<?xml version='1.0' encoding='UTF-8'?>
<!-- This document was created with Syntext Serna Free. --><!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" []>
<book id="platform" lang="ru">
  <bookinfo>
    <copyright>
      <year>2014</year>
      <holder>Haulmont (<ulink url="http://www.haulmont.ru/">www.haulmont.ru</ulink>)</holder>
    </copyright>
    <title>Платформа CUBA. Руководство по разработке приложений</title>
    <author><othername>Версия 5.3</othername>sreV</author>
  </bookinfo>
  <preface id="preface" lang="ru">
    <title>Предисловие</title>
    <para>Данное руководство содержит информацию, необходимую для разработки <firstterm>бизнес-приложений</firstterm> на  платформе <trademark>CUBA</trademark>. Под бизнес-приложениями здесь понимается широкий спектр информационных систем, предназначенных для поддержки деятельности предприятия, управления и принятия решений. </para>
    <section id="audience">
      <title>Целевая аудитория</title>
      <para>Данное Руководство предназначено для разработчиков, создающих бизнес-приложения с помощью платформы CUBA. Для успешной работы требуется знание следующих технологий:

<itemizedlist>
          <listitem>
            <para>Java Standard Edition</para>
          </listitem>
          <listitem>
            <para>Реляционные базы данных (SQL, DDL)</para>
          </listitem>
        </itemizedlist></para>
      <para>Для глубокого понимания принципов работы платформы полезным является знакомство со  следующими технологиями и фреймворками:</para>
      <itemizedlist>
        <listitem>
          <para>Gradle build system</para>
        </listitem>
        <listitem>
          <para>Spring Framework</para>
        </listitem>
        <listitem>
          <para>Java Persistence API</para>
        </listitem>
        <listitem>
          <para>Vaadin web applications framework</para>
        </listitem>
        <listitem>
          <para>HTML / CSS / JavaScript</para>
        </listitem>
        <listitem>
          <para>Java Servlets</para>
        </listitem>
        <listitem>
          <para>Java Swing</para>
        </listitem>
      </itemizedlist>
    </section>
    <section id="additional_info">
      <title>Дополнительные материалы</title>
      <para>Настоящее Руководство, а также другая документация по платформе CUBA, доступны по адресу <ulink url="https://www.cuba-platform.com/ru/manual">https://www.cuba-platform.com/ru/manual</ulink>.</para>
      <para>Ниже приведен список источников дополнительной информации по <application>Spring Framework</application>, <application>OpenJPA</application>, <application>Vaadin</application> и <application>Gradle</application>: </para>
      <para><itemizedlist>
          <listitem>
            <para><ulink url="http://projects.spring.io/spring-framework">http://projects.spring.io/spring-framework</ulink></para>
          </listitem>
          <listitem>
            <para><ulink url="http://openjpa.apache.org/builds/2.2.2/apache-openjpa/docs/main.html">http://openjpa.apache.org/builds/2.2.2/apache-openjpa/docs/main.html</ulink></para>
          </listitem>
          <listitem>
            <para><ulink url="https://vaadin.com/book">https://vaadin.com/book</ulink></para>
          </listitem>
          <listitem>
            <para><ulink url="http://www.gradle.org/docs/1.12/userguide/userguide.html">http://www.gradle.org/docs/1.12/userguide/userguide.html</ulink></para>
          </listitem>
        </itemizedlist></para>
    </section>
    <section id="feedback">
      <title>Обратная связь</title>
      <para>Если  у Вас имеются предложения по улучшению данного руководства,  обратитесь пожалуйста в службу поддержки по адресу <ulink url="https://www.cuba-platform.com/support">https://www.cuba-platform.com/support</ulink>. </para>
      <para>При обнаружении ошибки в документации укажите, пожалуйста, номер главы и приведите небольшой участок окружающего текста для облегчения поиска. </para>
    </section>
  </preface>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chapter_introduction.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chapter_setup.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chapter_quick_start.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chapter_framework.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chapter_development.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chapter_deployment.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="chapter_security.xml" encoding="UTF-8"/>
  <appendix>
    <title>Конфигурационные файлы</title>
    <para>В данном приложении описаны основные конфигурационные файлы, входящие в состав CUBA-приложений.</para>
    <section id="context.xml">
      <title>context.xml</title>
      <para>Файл <filename>context.xml</filename> является дескриптором развертывания приложения на сервере <application>Apache Tomcat</application>. В развернутом приложении этот файл располагается  в подкаталоге <filename>META-INF</filename> каталога веб-приложения или WAR-файла, например, <filename>tomcat/webapps/app-core/META-INF/context.xml</filename>. В проекте файлы данного типа находятся в каталогах <filename>/web/META-INF</filename> модулей <structname>core</structname>, <structname>web</structname>, <structname>portal</structname>.</para>
      <para>Основное предназначение файла для блока <structname>Middleware</structname> - определить источник данных и поместить его в JNDI под именем, заданным свойством приложения <property>
          <link linkend="cuba.dataSourceJndiName">cuba.dataSourceJndiName</link>
        </property>.</para>
      <para>Пример определения источника данных для <application>PostgreSQL</application>:<programlisting language="xml">&lt;Resource
    name=&quot;jdbc/CubaDS&quot;
    type=&quot;javax.sql.DataSource&quot;
    maxActive=&quot;100&quot;
    maxIdle=&quot;2&quot;
    maxWait=&quot;5000&quot;
    driverClassName=&quot;org.postgresql.Driver&quot;
    username=&quot;cuba&quot;
    password=&quot;cuba&quot;
    url=&quot;jdbc:postgresql://localhost/sales&quot;/&gt;</programlisting></para>
      <para>Пример определения источника данных для <application>Microsoft SQL Server</application>:<programlisting language="xml">&lt;Resource
    name=&quot;jdbc/CubaDS&quot;
    type=&quot;javax.sql.DataSource&quot;
    maxActive=&quot;100&quot;
    maxIdle=&quot;2&quot;
    maxWait=&quot;5000&quot;
    driverClassName=&quot;net.sourceforge.jtds.jdbc.Driver&quot;
    username=&quot;sa&quot;
    password=&quot;saPass1&quot;
    url=&quot;jdbc:jtds:sqlserver://localhost/sales&quot;/&gt;</programlisting></para>
      <para>Пример определения источника данных для <application>Oracle</application>:<programlisting language="xml">&lt;Resource
  name=&quot;jdbc/CubaDS&quot;
  type=&quot;javax.sql.DataSource&quot;
  maxActive=&quot;100&quot;
  maxIdle=&quot;2&quot;
  maxWait=&quot;5000&quot;
  driverClassName=&quot;oracle.jdbc.OracleDriver&quot;
  username=&quot;sales&quot;
  password=&quot;sales&quot;
  url=&quot;jdbc:oracle:thin:@//localhost:1521/orcl&quot;/&gt;</programlisting></para>
      <para>Для всех <link linkend="app_tiers">блоков</link>, являющихся веб-приложениями, данный файл может содержать код, отключающий сериализацию HTTP-сессий:<programlisting language="xml">&lt;Manager className=&quot;org.apache.catalina.session.PersistentManager&quot; debug=&quot;0&quot; distributable=&quot;false&quot;
         saveOnRestart=&quot;false&quot;&gt;
    &lt;Store className=&quot;org.apache.catalina.session.FileStore&quot;/&gt;
&lt;/Manager&gt;</programlisting></para>
    </section>
    <section id="datatypes.xml">
      <title>datatypes.xml</title>
      <para>Файл <filename>datatypes.xml</filename> определяет доступные типы данных атрибутов сущностей, см. <xref linkend="datatype"/></para>
      <para>Файл по умолчанию расположен в пакете <code>com.haulmont.chile.core.datatypes</code> <link linkend="base_projects">базового проекта</link> <structname>cuba</structname>. Если в прикладном проекте в <link linkend="app_modules">модуле</link> <structname>global</structname> создать аналогичный файл в корне CLASSPATH, то  типы данных будут загружены  из него.</para>
      <warning>
        <para>Механизм загрузки не поддерживает расширение, т.е. все типы данных загружаются из одного файла - либо из корня CLASSPATH, либо из пакета  <code>com.haulmont.chile.core.datatypes</code>.</para>
      </warning>
      <para>Доступные типы данных описываются в элементах <sgmltag>datatype</sgmltag>. Обязательным атрибутом является только class, в котором указывается класс типа данных, реализующий интерфейс <code>Datatype</code>. Набор остальных атрибутов зависит от класса, объекту которого при создании передается соответствующий XML элемент, и разбор атрибутов происходит в этом классе.</para>
      <para>Типичные атрибуты:<itemizedlist>
          <listitem>
            <para><sgmltag>format</sgmltag> - формат преобразования в строку без учета локали</para>
          </listitem>
          <listitem>
            <para><sgmltag>groupingSeparator</sgmltag> - символ-разделитель групп разрядов числа при форматировании без учета локали</para>
          </listitem>
          <listitem>
            <para><sgmltag>decimalSeparator</sgmltag> - символ-разделитель целой и дробной части числа при форматировании без учета локали</para>
          </listitem>
        </itemizedlist></para>
      <para>Пример:<programlisting language="xml">&lt;datatypes&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.BooleanDatatype&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.IntegerDatatype&quot;
              format=&quot;0&quot; groupingSeparator=&quot;&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.LongDatatype&quot;
              format=&quot;0&quot; groupingSeparator=&quot;&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.DoubleDatatype&quot;
              format=&quot;0.###&quot; decimalSeparator=&quot;.&quot; groupingSeparator=&quot;&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.BigDecimalDatatype&quot;
              format=&quot;0.####&quot; decimalSeparator=&quot;.&quot; groupingSeparator=&quot;&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.StringDatatype&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.DateTimeDatatype&quot;
              format=&quot;yyyy-MM-dd&apos;T&apos;HH:mm:ss.SSS&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.DateDatatype&quot;
              format=&quot;yyyy-MM-dd&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.TimeDatatype&quot;
              format=&quot;HH:mm:ss&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.UUIDDatatype&quot;/&gt;

    &lt;datatype class=&quot;com.haulmont.chile.core.datatypes.impl.ByteArrayDatatype&quot;/&gt;

&lt;/datatypes&gt;</programlisting></para>
    </section>
    <section id="dispatcher-spring.xml">
      <title>dispatcher-spring.xml</title>
      <para>Файлы данного типа определяют конфигурацию дополнительного контейнера <application>Spring Framework</application> для клиентских блоков, содержащих контроллеры <application>Spring MVC</application>. </para>
      <para>Набор файлов <filename>dispatcher-spring.xml</filename>, включая определенные в <link linkend="base_projects">базовых проектах</link>, задается в свойстве приложения <property>
          <link linkend="cuba.dispatcherSpringContextConfig">cuba.dispatcherSpringContextConfig</link>
        </property>. Последовательность перечисления файлов важна, так как каждый последующий файл может переопределять конфигурацию бинов, заданную в предыдущих файлах.</para>
      <para>Контейнер контроллеров Spring MVC создается таким образом, что основной контейнер (конфигурируемый файлами <filename>
          <link linkend="spring.xml">spring.xml</link>
        </filename>) является родительским по отношению к нему. Это означает, что бины контейнера контроллеров могут обращаться к бинам основного контейнера, а бины основного контейнера &quot;не видят&quot; контейнер контроллеров.</para>
    </section>
    <section id="menu.xml">
      <title>menu.xml</title>
      <para>Файлы данного типа используются в <link linkend="app_tiers">блоках</link> <structname>Web Client</structname> и <structname>Desktop Client</structname>, реализующих <link linkend="gui_framework">универсальный пользовательский интерфейс</link>, для описания структуры главного меню приложения.</para>
      <para>Схема XML доступна по адресу <ulink url="http://schemas.haulmont.com/cuba/5.2/menu.xsd">http://schemas.haulmont.com/cuba/5.2/menu.xsd</ulink></para>
      <para>Набор файлов <filename>menu.xml</filename>, включая определенные в <link linkend="base_projects">базовых проектах</link>, задается в свойстве приложения <property>
          <link linkend="cuba.menuConfig">cuba.menuConfig</link>
        </property>. </para>
      <para>Рассмотрим структуру файла.</para>
      <para><sgmltag>menu-config</sgmltag> - корневой элемент</para>
      <para>Элементы <sgmltag>menu-config</sgmltag>, образующие древовидную структуру:<itemizedlist>
          <listitem>
            <para><sgmltag>menu</sgmltag> - раскрывающееся меню, содержащее пункты и другие раскрывающиеся меню</para>
            <para>Атрибуты menu:<itemizedlist>
                <listitem>
                  <para><sgmltag>id</sgmltag> - идентификатор элемента, использующийся для формирования локализованного  названия (см. ниже)</para>
                </listitem>
                <listitem>
                  <para id="menu_insertBefore_insertAfter"><sgmltag>insertBefore</sgmltag>, <sgmltag>insertAfter</sgmltag> - идентификатор элемента или пункта меню, перед которым или после которого нужно вставить данный элемент. Используется в прикладном проекте для вставки элемента в нужное место меню, определенного в аналогичных файлах базовых проектов. Разумеется, использование одного из этих атрибутов для конкретного элемента исключает возможность использования второго атрибута для данного элемента.</para>
                  <para>Атрибуты <sgmltag>insertBefore</sgmltag>, <sgmltag>insertAfter</sgmltag> в Studio поддерживаются только для  элементов <sgmltag>menu</sgmltag> верхнего уровня. Поэтому если вы задали эти атрибуты вручную для других элементов, не открывайте дизайнер меню Studio, иначе они будут удалены.</para>
                </listitem>
              </itemizedlist></para>
            <para>Элементы menu:<itemizedlist>
                <listitem>
                  <para><sgmltag>menu</sgmltag></para>
                </listitem>
                <listitem>
                  <para><sgmltag>item</sgmltag> - пункт меню, см. далее</para>
                </listitem>
                <listitem>
                  <para><sgmltag>separator</sgmltag> - разделитель</para>
                </listitem>
              </itemizedlist></para>
          </listitem>
          <listitem>
            <para><sgmltag>item</sgmltag> - пункт меню</para>
            <para>Атрибуты <sgmltag>item</sgmltag>:<itemizedlist>
                <listitem>
                  <para><sgmltag>id</sgmltag> - идентификатор элемента, использующийся для формирования локализованного названия (см. ниже), и для связи с элементом файла <filename>
                      <link linkend="screens.xml">screens.xml</link>
                    </filename>, в котором зарегистрированы экраны UI. При выборе пункта меню в главном окне приложения будет открыт соответствующий экран.</para>
                </listitem>
                <listitem>
                  <para><sgmltag>shortcut</sgmltag> - горячая клавиша для вызова данного пункта меню. Возможные модификаторы - <literal>ALT</literal>, <literal>CTRL</literal>, <literal>SHIFT</literal> - отделяются символом &quot;<literal>-</literal>&quot;. Например:<programlisting>shortcut=&quot;ALT-C&quot;
shortcut=&quot;ALT-CTRL-C&quot;
shortcut=&quot;ALT-CTRL-SHIFT-C&quot;</programlisting></para>
                  <para>Горячие клавиши можно также задавать в <link linkend="app_properties">свойствах приложения</link> и использовать в <filename>menu.xml</filename> следующим образом:<programlisting>shortcut=&quot;${sales.menu.customer}&quot;</programlisting></para>
                </listitem>
                <listitem>
                  <para><sgmltag>openType</sgmltag> - тип открытия экрана, возможные значения соответствуют перечислению <code>WindowManager.OpenType</code>: <code>NEW_TAB</code>, <code>THIS_TAB</code>, <code>DIALOG</code>, <code>NEW_WINDOW</code>.</para>
                  <para>По умолчанию - <code>NEW_TAB</code>. </para>
                  <para>Значение <code>NEW_WINDOW</code> поддерживается только в <structname>Desktop Client</structname>, в <structname>Web Client</structname> оно эквивалентно <code>NEW_TAB</code>.</para>
                </listitem>
                <listitem>
                  <para><sgmltag>insertBefore</sgmltag>, <sgmltag>insertAfter</sgmltag> - идентификатор элемента или пункта меню, перед которым или после которого нужно вставить данный элемент. </para>
                  <para>Атрибуты <sgmltag>insertBefore</sgmltag>, <sgmltag>insertAfter</sgmltag> для элемента <sgmltag>item</sgmltag> не поддерживаются в Studio. Поэтому если вы задали эти атрибуты вручную, не открывайте дизайнер меню Studio, иначе они будут удалены.</para>
                </listitem>
                <listitem>
                  <para><sgmltag>resizable</sgmltag> - актуально для типа открытия экрана <code>DIALOG</code> - задает окну возможность изменения размера. Возможные значения: <code>true</code>, <code>false</code>.</para>
                  <para>По умолчанию главное меню не влияет на возможность изменения размера диалоговых окон.</para>
                </listitem>
              </itemizedlist></para>
            <para>Элементы <sgmltag>item</sgmltag>:<itemizedlist>
                <listitem>
                  <para><sgmltag>param</sgmltag> - задает параметр экрана, передаваемый в мэп метода <code>init()</code> <link linkend="screen_controller">контроллера</link>. Параметры, заданные в <filename>menu.xml</filename>, переопределяют одноименные параметры, заданные в <link linkend="screens.xml">
                      <filename>screens.xml</filename>
                    </link>.</para>
                  <para>Атрибуты <sgmltag>param</sgmltag>:<itemizedlist>
                      <listitem>
                        <para><sgmltag>name</sgmltag> - имя параметра</para>
                      </listitem>
                      <listitem>
                        <para><sgmltag>value</sgmltag> - значение параметра. Строковое значение может преобразовываться в некоторый объект по следующим правилам:<itemizedlist>
                            <listitem>
                              <para>Если строка представляет собой идентификатор сущности, записанный по правилам класса <code>EntityLoadInfo</code>, то загружается указанный экземпляр сущности.</para>
                            </listitem>
                            <listitem>
                              <para>Если строка имеет вид <code>${some_name}</code>, то значением параметра будет  свойство приложения <property>some_name</property>.</para>
                            </listitem>
                            <listitem>
                              <para>Строки <literal>true</literal> и <literal>false</literal> преобразуются в соответствующие значения типа <code>Boolean</code>.</para>
                            </listitem>
                            <listitem>
                              <para>Если ничего из вышеперечисленного не подходит, значением параметра становится сама строка.</para>
                            </listitem>
                          </itemizedlist></para>
                      </listitem>
                    </itemizedlist></para>
                </listitem>
                <listitem>
                  <para><sgmltag>permissions</sgmltag> - элемент, позволяющий задать набор разрешений текущего пользователя, при которых данный пункт меню доступен. Данный механизм имеет смысл  использовать только если необходимо привязать доступность пункта к специфическим разрешениям, или не к одному, а к нескольким разрешениям сразу. В большинстве случаев достаточно стандартной возможности подсистемы безопасности управлять доступностью пунктов меню по идентификаторам экранов.</para>
                  <para>Данный элемент должен содержать вложенные элементы <sgmltag>permission</sgmltag>, каждый из которых описывает одно требуемое разрешение. Пункт меню доступен только при наличии всех требуемых разрешений.</para>
                  <para>Атрибуты <sgmltag>permission</sgmltag>:<itemizedlist>
                      <listitem>
                        <para><sgmltag>type</sgmltag> - тип требуемого разрешения, задаваемый значением перечисления <code>PermissionType</code>: <code>SCREEN</code>, <code>ENTITY_OP</code>, <code>ENTITY_ATTR</code>, <code>SPECIFIC</code>, <code>UI</code>.</para>
                      </listitem>
                      <listitem>
                        <para><sgmltag>target</sgmltag> - объект, на который проверяется наличие разрешения. Зависит от типа разрешения:<itemizedlist>
                            <listitem>
                              <para><code>SCREEN</code> - идентификатор экрана, например <code>sales$Customer.lookup</code>.</para>
                            </listitem>
                            <listitem>
                              <para><code>ENTITY_OP</code> - строка вида <code>{entity_name}:{op}</code>, где <code>{op}</code> - <code>read</code>, <code>create</code>, <code>update</code>, <code>delete</code>. Например: <code>sales$Customer:create</code>.</para>
                            </listitem>
                            <listitem>
                              <para><code>ENTITY_ATTR</code> - строка вида <code>{entity_name}:{attribute}</code>, например <code>sales$Customer:name</code>.</para>
                            </listitem>
                            <listitem>
                              <para><code>SPECIFIC</code> - идентификатор специфического разрешения, например <code>sales.runInvoicing</code>.</para>
                            </listitem>
                            <listitem>
                              <para><code>UI</code> - путь к визуальному компоненту экрана.</para>
                            </listitem>
                          </itemizedlist></para>
                      </listitem>
                    </itemizedlist></para>
                </listitem>
              </itemizedlist></para>
          </listitem>
        </itemizedlist></para>
      <para>Пример файла меню:<programlisting language="xml">&lt;menu-config xmlns=&quot;http://schemas.haulmont.com/cuba/5.2/menu.xsd&quot;&gt;

    &lt;menu id=&quot;sales&quot; insertBefore=&quot;administration&quot;&gt;
        &lt;item id=&quot;sales$Customer.lookup&quot;/&gt;
        &lt;separator/&gt;
        &lt;item id=&quot;sales$Order.lookup&quot;/&gt;
    &lt;/menu&gt;

&lt;/menu-config&gt;</programlisting></para>
      <para>Локализованное название элемента меню формируется следующим образом: к идентификатору элемента добавляется префикс <literal>menu-config</literal> с точкой на конце, и полученная строка используется как ключ в <link linkend="main_message_pack">главном пакете сообщений</link>. Например:<programlisting>menu-config.sales=Sales
menu-config.sales$Customer.lookup=Customers</programlisting></para>
    </section>
    <section id="metadata.xml">
      <title>metadata.xml</title>
      <para>Файлы данного типа используются для регистрации неперсистентных сущностей и присвоения <link linkend="meta_annotations">мета-аннотаций</link>, см. <xref linkend="metadata_framework"/></para>
      <para>Схема XML доступна по адресу <ulink url="http://schemas.haulmont.com/cuba/5.2/metadata.xsd">http://schemas.haulmont.com/cuba/5.2/metadata.xsd</ulink></para>
      <para>Набор файлов <filename>metadata.xml</filename>, включая определенные в <link linkend="base_projects">базовых проектах</link>, задается в свойстве приложения <property>
          <link linkend="cuba.metadataConfig">cuba.metadataConfig</link>
        </property>. </para>
      <para>Рассмотрим структуру файла.</para>
      <para><sgmltag>metadata</sgmltag> - корневой элемент.</para>
      <para>Элементы <sgmltag>metadata</sgmltag>:<itemizedlist>
          <listitem>
            <para><sgmltag>metadata-model</sgmltag> - описатель метамодели проекта.</para>
            <para>Атрибут <sgmltag>
                <sgmltag>metadata-model</sgmltag>
              </sgmltag>: <itemizedlist>
                <listitem>
                  <para><sgmltag>root-package</sgmltag> - корневой пакет проекта.</para>
                </listitem>
              </itemizedlist></para>
            <para>Элементы <code>metadata-model</code>:<itemizedlist>
                <listitem>
                  <para><sgmltag>class</sgmltag> - класс неперсистентной сущности.</para>
                </listitem>
              </itemizedlist></para>
          </listitem>
          <listitem>
            <para><sgmltag>annotations</sgmltag> - корень элементов присвоения <link linkend="meta_annotations">мета-аннотаций</link> сущностей.</para>
            <para>Элементы <sgmltag>annotations</sgmltag>:<itemizedlist>
                <listitem>
                  <para><sgmltag>entity</sgmltag> - элемент сущности, которой присваиваются мета-аннотации.</para>
                  <para>Атрибуты <sgmltag>entity</sgmltag>:<itemizedlist>
                      <listitem>
                        <para><sgmltag>class</sgmltag> - класс сущности.</para>
                      </listitem>
                    </itemizedlist></para>
                  <para>Элементы <sgmltag>entity</sgmltag>:<itemizedlist>
                      <listitem>
                        <para><sgmltag>annotation</sgmltag> - элемент мета-аннотации.</para>
                        <para>Атрибуты <sgmltag>annotation</sgmltag>:<itemizedlist>
                            <listitem>
                              <para><sgmltag>name</sgmltag> - имя мета-аннотации.</para>
                            </listitem>
                            <listitem>
                              <para><sgmltag>value</sgmltag> - значение мета-аннотации.</para>
                            </listitem>
                          </itemizedlist></para>
                      </listitem>
                    </itemizedlist></para>
                </listitem>
              </itemizedlist></para>
          </listitem>
        </itemizedlist></para>
      <para>Пример:<programlisting language="xml">&lt;metadata xmlns=&quot;http://schemas.haulmont.com/cuba/5.2/metadata.xsd&quot;&gt;

    &lt;metadata-model root-package=&quot;com.sample.sales&quot;&gt;
        &lt;class&gt;com.sample.sales.entity.SomeTransientEntity&lt;/class&gt;
        &lt;class&gt;com.sample.sales.entity.OtherTransientEntity&lt;/class&gt;
    &lt;/metadata-model&gt;

    &lt;annotations&gt;
        &lt;entity class=&quot;com.haulmont.cuba.security.entity.User&quot;&gt;
            &lt;annotation name=&quot;com.haulmont.cuba.core.entity.annotation.TrackEditScreenHistory&quot; 
                        value=&quot;true&quot;/&gt;
            &lt;annotation name=&quot;com.haulmont.cuba.core.entity.annotation.EnableRestore&quot; 
                        value=&quot;true&quot;/&gt;
        &lt;/entity&gt;
    &lt;/annotations&gt;

&lt;/metadata&gt;</programlisting></para>
    </section>
    <section id="permissions.xml">
      <title>permissions.xml</title>
      <para>Файлы данного типа используются в блоках <structname>Web Client</structname> и <structname>Desktop Client</structname> для регистрации специфических <link linkend="permissions">разрешений</link> пользователей. </para>
      <para>Набор файлов <filename>permissions.xml</filename>, включая определенные в <link linkend="base_projects">базовых проектах</link>, задается в свойстве приложения <property>
          <link linkend="cuba.permissionConfig">cuba.permissionConfig</link>
        </property>. </para>
      <para>Схема XML доступна по адресу <ulink url="http://schemas.haulmont.com/cuba/5.2/permissions.xsd">http://schemas.haulmont.com/cuba/5.2/permissions.xsd</ulink>.</para>
      <para>Рассмотрим структуру файла.</para>
      <para><sgmltag>permission-config</sgmltag> - корневой элемент.</para>
      <para>Элементы <sgmltag>permission-config</sgmltag>:</para>
      <itemizedlist>
        <listitem>
          <para><code>specific</code> - описатель специфических разрешений.</para>
          <para>Элементы <code>specific</code>:<itemizedlist>
              <listitem>
                <para><code>category</code> - категория разрешений, используется для группировки в экране управления разрешениями <link linkend="roles">роли</link>. Атрибут <code>id</code> используется как ключ для получения локализованного названия категории.</para>
              </listitem>
              <listitem>
                <para><code>permission</code> - именованное разрешение. Атрибут <code>id</code> используется для получения значения разрешения  методом <code>Security.isSpecificPermitted()</code>, а также как ключ для получения локализованного названия разрешения для отображения в экране управления разрешениями <link linkend="roles">роли</link>.</para>
              </listitem>
            </itemizedlist></para>
        </listitem>
      </itemizedlist>
      <para>Пример:<programlisting language="xml">&lt;permission-config xmlns=&quot;http://schemas.haulmont.com/cuba/5.2/permissions.xsd&quot;&gt;
    &lt;specific&gt;
        &lt;category id=&quot;app&quot;&gt;
            &lt;permission id=&quot;app.doSomething&quot;/&gt;
            &lt;permission id=&quot;app.doSomethingOther&quot;/&gt;
        &lt;/category&gt;
    &lt;/specific&gt;
&lt;/permission-config&gt;</programlisting> </para>
    </section>
    <section id="persistence.xml">
      <title>persistence.xml</title>
      <para>Файлы данного типа являются стандартными для JPA и используются для регистрации персистентных сущностей и задания параметров функционирования фреймворка <link linkend="orm">ORM</link>.</para>
      <para>Набор файлов <filename>persistence.xml</filename>, включая определенные в <link linkend="base_projects">базовых проектах</link>, задается в свойстве приложения <property>
          <link linkend="cuba.persistenceConfig">cuba.persistenceConfig</link>
        </property>. </para>
      <para>На старте блока <structname>Middleware</structname> из заданных файлов собирается один <filename>persistence.xml</filename> и сохраняется в <link linkend="work_dir">рабочем каталоге</link> приложения. Параметры ORM могут переопределяться каждым следующим файлом списка, поэтому порядок указания файлов важен. Существует несколько параметров, жестко определяемых типом используемой СУБД (заданным в <property>
          <link linkend="cuba.dbmsType">cuba.dbmsType</link>
        </property>), которые невозможно переопределить в <filename>persistence.xml</filename>, это:<itemizedlist>
          <listitem>
            <para><literal>openjpa.jdbc.DBDictionary</literal></para>
          </listitem>
          <listitem>
            <para><literal>openjpa.jdbc.MappingDefaults</literal></para>
          </listitem>
        </itemizedlist>Кроме того, при выключенном свойстве приложения <property>
          <link linkend="cuba.disableOrmXmlGeneration">cuba.disableOrmXmlGeneration</link>
        </property> и наличии <link linkend="extension">расширенных сущностей</link> на старте приложения в рабочем каталоге создается файл <filename>orm.xml</filename> и путь к нему записывается в параметр <literal>openjpa.MetaDataFactory</literal>. В этом случае параметр <literal>openjpa.MetaDataFactory</literal> также нельзя задать в <filename>persistence.xml</filename> заранее. </para>
      <para>Пример файла:<programlisting language="xml">&lt;persistence xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot; version=&quot;1.0&quot;&gt;
    &lt;persistence-unit name=&quot;sales&quot; transaction-type=&quot;RESOURCE_LOCAL&quot;&gt;
        &lt;class&gt;com.sample.sales.entity.Customer&lt;/class&gt;
        &lt;class&gt;com.sample.sales.entity.Order&lt;/class&gt;
    &lt;/persistence-unit&gt;
&lt;/persistence&gt;</programlisting></para>
    </section>
    <section id="remoting-spring.xml">
      <title>remoting-spring.xml</title>
      <para>Файлы данного типа определяют конфигурацию дополнительного контейнера <application>Spring Framework</application> для блока <structname>Middleware</structname>, который предназначен для экспорта сервисов и других компонентов среднего слоя, доступных клиентскому уровню (далее <firstterm>контейнер удаленного доступа</firstterm>). </para>
      <para>Набор файлов <filename>remoting-spring.xml</filename>, включая определенные в <link linkend="base_projects">базовых проектах</link>, задается в свойстве приложения <property>
          <link linkend="cuba.remotingSpringContextConfig">cuba.remotingSpringContextConfig</link>
        </property>. Последовательность перечисления файлов важна, так как каждый последующий файл может переопределять конфигурацию бинов, заданную в предыдущих файлах.</para>
      <para>Контейнер удаленного доступа создается таким образом, что основной контейнер (конфигурируемый файлами <filename>
          <link linkend="spring.xml">spring.xml</link>
        </filename>) является родительским по отношению к нему. Это означает, что бины контейнера удаленного доступа могут обращаться к бинам основного контейнера, а бины основного контейнера &quot;не видят&quot; контейнер удаленного доступа.</para>
      <para>Основная задача контейнера удаленного доступа - сделать сервисы <structname>Middleware</structname> доступными клиентскому уровню с помощью механизма <application>Spring HttpInvoker</application>. Для этого в <filename>cuba-remoting-spring.xml</filename> базового проекта <structname>cuba</structname> определяется бин <literal>servicesExporter</literal> типа <code>RemoteServicesBeanCreator</code>, который получает из основного контейнера все классы сервисов и экспортирует их. В дополнение к обычным аннотированным сервисам контейнер удаленного доступа экспортирует некоторые специфические бины, такие как <code>LoginService</code>.</para>
      <para>Кроме того, <filename>cuba-remoting-spring.xml</filename> определяет базовый пакет, начиная с которого производится поиск аннотированных классов контроллеров <application>Spring MVC</application>, используемых для загрузки-выгрузки файлов.</para>
      <para>В прикладном проекте определять файл типа <filename>remoting-spring.xml</filename> необходимо только в том случае, если создаются специфические контроллеры <application>Spring MVC</application>. Сервисы прикладного проекта в любом случае будут импортированы стандартным бином <literal>servicesExporter</literal>, определенным в базовом проекте <structname>cuba</structname>.</para>
    </section>
    <section id="screens.xml">
      <title>screens.xml</title>
      <para>Файлы данного типа используются в <link linkend="app_tiers">блоках</link> <structname>Web Client</structname> и <structname>Desktop Client</structname>, реализующих <link linkend="gui_framework">универсальный пользовательский интерфейс</link>, для регистрации <link linkend="screen_xml">XML-дескрипторов</link> экранов.</para>
      <para>Схема XML доступна по адресу <ulink url="http://schemas.haulmont.com/cuba/5.2/screens.xsd">http://schemas.haulmont.com/cuba/5.2/screens.xsd</ulink></para>
      <para>Набор файлов <filename>screens.xml</filename>, включая определенные в <link linkend="base_projects">базовых проектах</link>, задается в свойстве приложения <property>
          <link linkend="cuba.windowConfig">cuba.windowConfig</link>
        </property>. </para>
      <para>Рассмотрим структуру файла.</para>
      <para><sgmltag>screen-config</sgmltag> - корневой элемент</para>
      <para>Элементы <sgmltag>screen-config</sgmltag>:<itemizedlist>
          <listitem>
            <para><sgmltag>screen</sgmltag> - описатель экрана</para>
            <para>Атрибуты <sgmltag>screen</sgmltag>:<itemizedlist>
                <listitem>
                  <para><sgmltag>id</sgmltag> - идентификатор экрана, по которому он доступен в программном коде (например, в методах <code>IFrame.openWindow()</code> и т.п.) и в <filename>
                      <link linkend="menu.xml">menu.xml</link>
                    </filename>.</para>
                </listitem>
                <listitem>
                  <para><sgmltag>template</sgmltag> - путь к файлу <link linkend="screen_xml">XML-дескриптора</link> экрана. Загрузка производится по правилам интерфейса <code>
                      <link linkend="resources">Resources</link>
                    </code>.</para>
                </listitem>
                <listitem>
                  <para><sgmltag>class</sgmltag> - если атрибут <sgmltag>template</sgmltag> не указан, в данном атрибуте нужно указать имя класса, реализующего либо <code>Callable</code>, либо <code>Runnable</code>. </para>
                  <para>В случае <code>Callable</code> метод <code>call()</code> должен возвращать экземпляр созданного <code>Window</code>, который будет возвращен вызывающему коду как результат <code>WindowManager.openWindow()</code>. Класс может содержать конструктор с параметрами для передачи ему строковых значений, заданных вложенным элементом <sgmltag>param</sgmltag> (см. ниже). </para>
                </listitem>
                <listitem>
                  <para><sgmltag>multipleOpen</sgmltag> - опциональный атрибут, задающий возможность многократного открытия экрана. Если равен <literal>false</literal> или не задан, и в главном окне уже открыт экран с данным идентификатором, то вместо открытия нового экземпляра экрана отобразится имеющийся. Значение <literal>true</literal> позволяет открывать произвольное количество одинаковых экранов.</para>
                </listitem>
              </itemizedlist></para>
            <para>Элементы <sgmltag>screen</sgmltag>:<itemizedlist>
                <listitem>
                  <para><sgmltag>param</sgmltag> - задает параметр экрана, передаваемый в мэп метода <code>init()</code> <link linkend="screen_controller">контроллера</link>. Параметры, передаваемые из вызывающего кода в методы <code>openWindow()</code>, переопределяют одноименные параметры, заданные в <filename>screens.xml</filename>.</para>
                  <para>Атрибуты <sgmltag>param</sgmltag>:<itemizedlist>
                      <listitem>
                        <para><sgmltag>name</sgmltag> - имя параметра</para>
                      </listitem>
                      <listitem>
                        <para><sgmltag>value</sgmltag> - значение параметра. Строки <literal>true</literal> и <literal>false</literal> автоматически преобразуются в значения типа <code>Boolean</code>.</para>
                      </listitem>
                    </itemizedlist></para>
                </listitem>
              </itemizedlist></para>
          </listitem>
          <listitem>
            <para><sgmltag>include</sgmltag> - включение другого файла типа <filename>screens.xml</filename></para>
            <para><para>Атрибуты <sgmltag>include</sgmltag>:<itemizedlist>
                  <listitem>
                    <para><sgmltag>file</sgmltag> - путь к файлу по правилам интерфейса <code>
                        <link linkend="resources">Resources</link>
                      </code></para>
                  </listitem>
                </itemizedlist></para></para>
          </listitem>
        </itemizedlist></para>
      <para>Пример файла <filename>screens.xml</filename>:<programlisting language="xml">&lt;screen-config xmlns=&quot;http://schemas.haulmont.com/cuba/5.2/screens.xsd&quot;&gt;

    &lt;screen id=&quot;sales$Customer.lookup&quot; template=&quot;/com/sample/sales/gui/customer/customer-browse.xml&quot;/&gt;
    &lt;screen id=&quot;sales$Customer.edit&quot; template=&quot;/com/sample/sales/gui/customer/customer-edit.xml&quot;/&gt;

    &lt;screen id=&quot;sales$Order.lookup&quot; template=&quot;/com/sample/sales/gui/order/order-browse.xml&quot;/&gt;
    &lt;screen id=&quot;sales$Order.edit&quot; template=&quot;/com/sample/sales/gui/order/order-edit.xml&quot;/&gt;

&lt;/screen-config&gt;</programlisting></para>
    </section>
    <section id="spring.xml">
      <title>spring.xml</title>
      <para>Файлы данного типа определяют конфигурацию основного контейнера <application>Spring Framework</application> для каждого <link linkend="app_tiers">блока приложения</link>. </para>
      <para>Набор файлов <filename>spring.xml</filename>, включая определенные в <link linkend="base_projects">базовых проектах</link>, задается в свойстве приложения <property>
          <link linkend="cuba.springContextConfig">cuba.springContextConfig</link>
        </property>. Последовательность перечисления файлов важна, так как каждый последующий файл может переопределять конфигурацию бинов, заданную в предыдущих файлах.</para>
      <para>Основная часть конфигурирования контейнера возложена на аннотации бинов (такие как <code>@ManagedBean</code>, <code>@Servic</code>e, <code>@Inject</code> и др.), поэтому обязательной частью <filename>spring.xml</filename> в прикладном проекте является только элемент <sgmltag>context:component-scan</sgmltag>, в котором задается базовый пакет Java, с которого начинается поиск аннотированных классов. Например:<programlisting language="xml">&lt;context:component-scan base-package=&quot;com.sample.sales&quot;/&gt;</programlisting></para>
      <para>Остальное содержимое зависит от того, для какого блока приложения конфигурируется контейнер: например, для <structname>Middleware</structname> это регистрация <link linkend="jmx_beans">JMX-бинов</link>, для блоков клиентского уровня - <link linkend="service_import">импорт сервисов</link>.</para>
    </section>
    <section id="views.xml">
      <title>views.xml</title>
      <para>Файлы данного типа используются для описания представлений, см. <xref linkend="views"/></para>
      <para>Схема XML доступна по адресу <ulink url="http://schemas.haulmont.com/cuba/5.2/view.xsd">http://schemas.haulmont.com/cuba/5.2/view.xsd</ulink></para>
      <para><sgmltag>views</sgmltag> - корневой элемент</para>
      <para>Элементы <sgmltag>views</sgmltag>:<itemizedlist>
          <listitem>
            <para><sgmltag>view</sgmltag> - описатель <code>View</code></para>
            <para>Атрибуты <sgmltag>view</sgmltag>:<itemizedlist>
                <listitem>
                  <para><sgmltag>class</sgmltag> - класс сущности</para>
                </listitem>
                <listitem>
                  <para><sgmltag>name</sgmltag> - имя представления, должно быть уникальным в пределах сущности</para>
                </listitem>
                <listitem>
                  <para><sgmltag>systemProperties</sgmltag> - признак включения системных атрибутов сущности (входящих в состав <link linkend="entity_base_classes">базовых интерфейсов</link> персистентных сущностей <code>BaseEntity</code> и  <code>Updatable</code>). Необязательный атрибут, по умолчанию <literal>false</literal>.</para>
                </listitem>
                <listitem>
                  <para><sgmltag>overwrite</sgmltag> - признак того, что данный описатель должен переопределить представление с таким же классом и именем, уже развернутое в репозитории. Необязательный атрибут, по умолчанию <literal>false</literal>.</para>
                </listitem>
                <listitem>
                  <para><sgmltag>extends</sgmltag> - указывает имя представления той же сущности, от которого нужно унаследовать атрибуты. Порядок следования описателей в файле при этом не важен. Например, при указании <literal>extends=&quot;_local&quot;</literal> в текущее представление будут включены все <link linkend="local_attribute">локальные атрибуты</link> сущности. Необязательный атрибут.</para>
                </listitem>
              </itemizedlist></para>
            <para>Элементы <sgmltag>view</sgmltag>:<itemizedlist>
                <listitem>
                  <para><sgmltag>property</sgmltag> - описатель <code>ViewProperty</code></para>
                  <para>Атрибуты <sgmltag>property</sgmltag>:<itemizedlist>
                      <listitem>
                        <para><sgmltag>name</sgmltag> - имя атрибута сущности</para>
                      </listitem>
                      <listitem>
                        <para><sgmltag>view</sgmltag> - для ссылочного атрибута указывает имя представления, с которым должна загружаться ассоциированная сущность. Порядок следования описателей в файле при этом не важен.</para>
                      </listitem>
                      <listitem>
                        <para><sgmltag>lazy</sgmltag> - для ссылочных атрибутов признак того, что данный атрибут нужно не  включать в Fetch Plan, а загружать отдельным SQL запросом, инициированным обращением к атрибуту. Необязательный атрибут, по умолчанию <literal>false</literal>.</para>
                        <para>Рекомендуется использовать <sgmltag>lazy</sgmltag> для атрибутов-коллекций, если таких атрибутов больше одного для данного графа представлений. Т.е. устанавливайте  <literal>lazy = &quot;true&quot;</literal> для всех коллекций, кроме одной.</para>
                      </listitem>
                    </itemizedlist></para>
                  <para>Элементы <sgmltag>property</sgmltag>:<itemizedlist>
                      <listitem>
                        <para><sgmltag>property</sgmltag> - описатель атрибута связанной сущности. Таким способом можно определить неименованное представление для связанной сущности прямо внутри  текущего описателя (inline). </para>
                      </listitem>
                    </itemizedlist></para>
                </listitem>
              </itemizedlist></para>
          </listitem>
          <listitem>
            <para><sgmltag>include</sgmltag> - включение другого файла типа views.xml</para>
            <para>Атрибуты <sgmltag>include</sgmltag>:<itemizedlist>
                <listitem>
                  <para><sgmltag>file</sgmltag> - путь к файлу по правилам интерфейса <code>
                      <link linkend="resources">Resources</link>
                    </code></para>
                </listitem>
              </itemizedlist></para>
          </listitem>
        </itemizedlist></para>
      <para>Пример:<programlisting language="xml">&lt;views xmlns=&quot;http://schemas.haulmont.com/cuba/5.2/view.xsd&quot;&gt;

    &lt;view class=&quot;com.sample.sales.entity.Order&quot;
          name=&quot;orderWithCustomer&quot;
          extends=&quot;_local&quot;&gt;
        &lt;property name=&quot;customer&quot; view=&quot;_minimal&quot;/&gt;
    &lt;/view&gt;

    &lt;view class=&quot;com.sample.sales.entity.Item&quot;
          name=&quot;itemsInOrder&quot;&gt;
        &lt;property name=&quot;quantity&quot;/&gt;
        &lt;property name=&quot;product&quot; view=&quot;_minimal&quot;/&gt;
    &lt;/view&gt;

    &lt;view class=&quot;com.sample.sales.entity.Order&quot;
          name=&quot;orderWithCustomerDefinedInline&quot;
          extends=&quot;_local&quot;&gt;
        &lt;property name=&quot;customer&quot;&gt;
            &lt;property name=&quot;name&quot;/&gt;
            &lt;property name=&quot;email&quot;/&gt;
        &lt;/property&gt;
    &lt;/view&gt;

&lt;/views&gt;</programlisting></para>
      <para>См. также свойство приложения <property>
          <link linkend="cuba.viewsConfig">cuba.viewsConfig</link>
        </property></para>
    </section>
    <section id="web.xml">
      <title>web.xml</title>
      <para>Файл <filename>web.xml</filename> является стандартным дескриптором веб-приложения <application>Java EE</application>, и должен быть создан для блоков <structname>Middleware</structname>, <structname>Web Client</structname> и <structname>Web Portal</structname>.</para>
      <para>В проекте приложения файлы <filename>web.xml</filename> располагаются в каталогах <filename>web/WEB-INF</filename> соответствующих <link linkend="app_modules">модулей</link>.</para>
      <para>Рассмотрим содержимое <filename>web.xml</filename> блока <structname>Middleware</structname> (модуль <structname>core</structname> проекта):<programlisting language="xml">&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;
           xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
           xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee
           http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;
           version=&quot;2.5&quot;&gt;

    &lt;!-- Application properties config files --&gt;
    &lt;context-param&gt;
        &lt;param-name&gt;appPropertiesConfig&lt;/param-name&gt;
        &lt;param-value&gt;
            classpath:cuba-app.properties
            classpath:app.properties
            file:${catalina.home}/conf/app-core/local.app.properties
        &lt;/param-value&gt;
    &lt;/context-param&gt;

    &lt;listener&gt;
        &lt;listener-class&gt;com.haulmont.cuba.core.sys.AppContextLoader&lt;/listener-class&gt;
    &lt;/listener&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;remoting&lt;/servlet-name&gt;
        &lt;servlet-class&gt;com.haulmont.cuba.core.sys.remoting.RemotingServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;remoting&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/remoting/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;restapi&lt;/servlet-name&gt;
        &lt;servlet-class&gt;com.haulmont.cuba.core.sys.restapi.RestApiServlet&lt;/servlet-class&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;restapi&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/api/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
&lt;/web-app&gt;</programlisting></para>
      <para>В элементах <sgmltag>context-param</sgmltag> задаются инициализирующие параметры объекта <code>ServletContext</code> данного веб-приложения. Здесь определен параметр <literal>appPropertiesConfig</literal>, значением которого является список <link linkend="app_properties_files">файлов свойств приложения</link>.</para>
      <para>В элементе <sgmltag>listener</sgmltag> задается класс слушателя, реализующего интерфейс <code>ServletContextListener</code>. В блоке <structname>Middleware</structname> CUBA-приложения в качестве слушателя должен использоваться класс <code>AppContextLoader</code>, выполняющий инициализацию <code>
          <link linkend="appContext">AppContext</link>
        </code>.</para>
      <para>Далее следуют определения сервлетов, среди которых обязательным для <structname>Middleware</structname> является класс <code>RemotingServlet</code>, связанный с контейнером удаленного доступа (см. <xref linkend="remoting-spring.xml"/>). Данный сервлет отображен на URL <literal>/remoting/*</literal>.</para>
      <para>Рассмотрим содержимое <filename>web.xml</filename> блока <structname>Web Client</structname> (модуль <structname>web</structname> проекта):<programlisting language="xml">&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;
           xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
           xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee
           http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;
           version=&quot;2.5&quot;&gt;

    &lt;context-param&gt;
        &lt;description&gt;Vaadin production mode&lt;/description&gt;
        &lt;param-name&gt;productionMode&lt;/param-name&gt;
        &lt;param-value&gt;false&lt;/param-value&gt;
    &lt;/context-param&gt;

    &lt;context-param&gt;
        &lt;param-name&gt;appPropertiesConfig&lt;/param-name&gt;
        &lt;param-value&gt;
            classpath:cuba-web-app.properties
            classpath:web-app.properties
            file:${catalina.home}/conf/app/local.app.properties
        &lt;/param-value&gt;
    &lt;/context-param&gt;

    &lt;listener&gt;
        &lt;listener-class&gt;com.haulmont.cuba.web.sys.WebAppContextLoader&lt;/listener-class&gt;
    &lt;/listener&gt;

    &lt;servlet&gt;
        &lt;servlet-name&gt;app_servlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;com.haulmont.cuba.web.sys.CubaApplicationServlet&lt;/servlet-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;application&lt;/param-name&gt;
            &lt;param-value&gt;com.haulmont.sales.web.App&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;widgetset&lt;/param-name&gt;
            &lt;param-value&gt;com.haulmont.cuba.web.toolkit.ui.WidgetSet&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;UI&lt;/param-name&gt;
            &lt;param-value&gt;com.haulmont.cuba.web.AppUI&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;UIProvider&lt;/param-name&gt;
            &lt;param-value&gt;com.haulmont.cuba.web.sys.CubaUIProvider&lt;/param-value&gt;
        &lt;/init-param&gt;
    &lt;/servlet&gt;

    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;app_servlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

    &lt;filter&gt;
        &lt;filter-name&gt;cuba_filter&lt;/filter-name&gt;
        &lt;filter-class&gt;com.haulmont.cuba.web.sys.CubaHttpFilter&lt;/filter-class&gt;
    &lt;/filter&gt;

    &lt;filter-mapping&gt;
        &lt;filter-name&gt;cuba_filter&lt;/filter-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/filter-mapping&gt;

&lt;/web-app&gt;</programlisting></para>
      <para>В данном файле определены два параметра: <literal>appPropertiesConfig</literal>, значением которого является список <link linkend="app_properties_files">файлов свойств приложения</link>, и <literal>productionMode</literal>, отключающий режим отладки фреймворка <application>Vaadin</application>.</para>
      <para>В качестве <code>ServletContextListener</code> в блоке <structname>Web Client</structname> используется класс <code>WebAppContextLoader</code>.</para>
      <para>Далее определяется сервлет <code>CubaApplicationServlet</code>, входящий в состав основанной на фреймворке <application>Vaadin</application> реализации <link linkend="gui_framework">универсального пользовательского интерфейса</link>. Сервлет имеет несколько параметров, в том числе:<itemizedlist>
          <listitem>
            <para><literal>application</literal> - задает специфический для проекта класс клиентского приложения, который должен быть наследником <code>com.haulmont.cuba.web.App</code></para>
          </listitem>
          <listitem>
            <para><literal>widgetset</literal> - задает набор <application>GWT</application> компонентов, используемых на стороне веб-браузера</para>
          </listitem>
        </itemizedlist></para>
      <para>После определения сервлетов  подключается фильтр <code>CubaHttpFilter</code>, необходимый для  функционирования блока <structname>Web Client</structname>.</para>
    </section>
  </appendix>
  <appendix id="app_properties_reference">
    <title>Свойства приложения</title>
    <para>В данном приложении в алфавитном порядке описаны доступные <link linkend="app_properties">свойства приложения</link>.</para>
    <variablelist>
      <varlistentry id="cuba.allowQueryFromSelected">
        <term>cuba.allowQueryFromSelected</term>
        <listitem>
          <para>Разрешает <link linkend="gui_Filter">универсальному фильтру</link> использовать режим последовательного наложения фильтров. См. также <xref linkend="query_from_selected"/></para>
          <para>Значение по умолчанию: <code>true</code></para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется в блоках <structname>Web Client</structname> и <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.allowSetNotLoadedAttributes">
        <term>cuba.allowSetNotLoadedAttributes</term>
        <listitem>
          <para>Разрешает вызывать setter для незагруженных атрибутов <link linkend="entity_states">Detached</link> сущностей. Подробнее см. <xref linkend="views"/></para>
          <para>Значение по умолчанию: <code>false</code></para>
          <para>Используется во всех блоках приложения.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.automaticDatabaseUpdate">
        <term>cuba.automaticDatabaseUpdate</term>
        <listitem>
          <para>Включает режим <link linkend="db_update_server">выполнения скриптов БД сервером</link> на старте приложения.</para>
          <para>Значение по умолчанию: <code>false</code></para>
          <para>Интерфейс: <code>ServerConfig</code></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.availableLocales">
        <term>cuba.availableLocales</term>
        <listitem>
          <para id="property_available_locales">Список поддерживаемых языков интерфейса. </para>
          <para id="property_available_locales_1">Формат свойства: <literal>{название_языка1}|{код_языка_1};{название_языка2}|{код_языка_2};</literal>... Пример: <programlisting>cuba.availableLocales=French|fr;English|en</programlisting></para>
          <para><code>{название_языка}</code> −  это название, которое будет отображаться в списках доступных языков. Например, в окне входа в систему, в экране редактирования пользователя. </para>
          <para><code>{код_языка}</code> − соответствует коду, возвращаемому методом <code>Locale.getLanguage()</code>. Используется как суффикс для формирования имен <link linkend="message_packs">файлов пакетов сообщений</link>. Например, <filename>messages_fr.properties.</filename></para>
          <para>Следует иметь в виду, что язык, который указан первым в списке языков  свойства <property>cuba.availableLocales</property>, будет отображаться первым в списке доступных языков в том случае, если среди языков данного свойства не будет найден текущий язык операционной системы пользователя. Если же язык операционной системы присутствует в списке доступных, то отображаться  первым будет он. </para>
          <para>Значение по умолчанию: <literal>English|en;Russian|ru;French|fr</literal></para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.backgroundWorker.maxActiveTasksCount">
        <term>cuba.backgroundWorker.maxActiveTasksCount</term>
        <listitem>
          <para>Максимальное количество активных  <link linkend="background_tasks">фоновых задач</link>.</para>
          <para>Значение по умолчанию: <literal>100</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.backgroundWorker.maxClientLatencySeconds">
        <term>cuba.backgroundWorker.maxClientLatencySeconds</term>
        <listitem>
          <para>Задержка в секундах, которая добавляется к таймауту   <link linkend="background_tasks">фоновой задачи</link>, прежде чем она будет прервана механизмом <code>WatchDog</code>. Отражает возможные сетевые задержки при опросе статуса задачи.</para>
          <para>Значение по умолчанию: <literal>60</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.backgroundWorker.uiCheckInterval">
        <term>cuba.backgroundWorker.uiCheckInterval</term>
        <listitem>
          <para>Период опроса состояния <link linkend="background_tasks">фоновых задач</link>.</para>
          <para>Значение по умолчанию: <literal>2000</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.client.maxUploadSizeMb">
        <term>cuba.client.maxUploadSizeMb</term>
        <listitem>
          <para>Максимальный размер файла в мегабайтах, который может быть загружен с помощью компонентов <link linkend="gui_FileUploadField">FileUploadField</link> и <link linkend="gui_FileMultiUploadField">FileMultiUploadField</link>.</para>
          <para>Значение по умолчанию: <literal>20</literal></para>
          <para>Интерфейс: <code>ClientConfig</code></para>
          <para>Используется в блоках   <structname>Web Client</structname> и <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.cluster.enabled">
        <term>cuba.cluster.enabled</term>
        <listitem>
          <para>Включает взаимодействие серверов Middleware в кластере. Подробнее см. <xref linkend="cluster_mw_server"/>.</para>
          <para>Значение по умолчанию: <literal>false</literal></para>
          <para>Используется в блоке   <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.confDir">
        <term>cuba.confDir</term>
        <listitem>
          <para>Конфигурационный параметр, задающий расположение <link linkend="conf_dir">каталога конфигурации</link> данного <link linkend="app_tiers">блока приложения</link>.</para>
          <para>Значение по умолчанию для блоков <structname>Middleware</structname>, <structname>Web Client</structname>, <structname>Web Portal</structname>: <literal>${catalina.home}/conf/${<link linkend="cuba.webContextName">cuba.webContextName</link>}</literal>, что в случае стандартного развертывания в <application>Tomcat</application> означает расположение внутри каталога <filename>tomcat/conf</filename> в подкаталоге с именем текущего веб-приложения, например, <filename>tomcat/conf/app-core</filename>.</para>
          <para>Значение по умолчанию для блока <structname>Desktop Client</structname>: <literal>${<link linkend="cuba.desktop.home">cuba.desktop.home</link>}/conf</literal>. </para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.connectionUrlList">
        <term>cuba.connectionUrlList</term>
        <listitem>
          <para>Задает список URL для подключения <link linkend="app_tiers">клиентских блоков</link> к серверам <structname>Middleware</structname>. </para>
          <para>Значением свойства должен быть один или несколько разделенных запятой URL вида <code>http[s]://host[:port]/app-core</code>, где <code>host</code> - имя сервера, <code>port</code> - порт сервера, <code>app-core</code> - имя веб-приложения, реализующего блок <structname>Middleware</structname>. Например:<programlisting>cuba.connectionUrlList=http://localhost:8080/app-core</programlisting></para>
          <para>В случае использования кластера серверов <structname>Middleware</structname>, для обеспечения отказоустойчивости и балансировки нагрузки необходимо перечислить их адреса через запятую:<programlisting>cuba.connectionUrlList=http://server1:8080/app-core,http://server2:8080/app-core</programlisting></para>
          <para>При этом порядок серверов в данном списке определяет приоритет, в котором клиент будет пытаться направлять запросы. Например в данном случае клиент сначала попытается вызвать <code>server1</code>, если он недоступен - то <code>server2</code>. Если запрос к <code>server2</code> завершился успешно, данный клиент ставит <code>server2</code> первым в своем списке и продолжает работать с ним. После перезапуска клиента список восстанавливается в первоначальное значение. Для обеспечения равномерного распределения клиентов между серверами используется свойство <link linkend="cuba.randomServerPriority">cuba.randomServerPriority</link>.</para>
          <para>См. также свойство <link linkend="cuba.useLocalServiceInvocation">cuba.useLocalServiceInvocation</link>.</para>
          <para>Интерфейс: <code>ClientConfig</code></para>
          <para>Используется в <link linkend="app_tiers">блоках</link> <structname>Web Client</structname>, <structname>Web Portal</structname>, <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.creditsConfig">
        <term>cuba.creditsConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задает набор файлов <filename>credits.xml</filename>, содержащих <link linkend="credits">информацию об используемом программном обеспечении</link>. </para>
          <para>Значением свойства должен быть список имен файлов, разделенный пробелами. Файлы загружаются по правилам интерфейса <code>
              <link linkend="resources">Resources</link>
            </code>.</para>
          <para>Используется в блоках <structname>Web Client</structname> и <structname>Desktop Client</structname>.</para>
          <para>Пример:<programlisting>cuba.creditsConfig=cuba-credits.xml reports-credits.xml credits.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.dataSourceJndiName">
        <term>cuba.dataSourceJndiName</term>
        <listitem>
          <para>Задает JNDI имя источника данных <code>javax.sql.DataSource</code>, через который производится обращение к базе данных приложения.</para>
          <para>Значение по умолчанию: <literal>java:comp/env/jdbc/CubaDS</literal></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.dataDir">
        <term>cuba.dataDir</term>
        <listitem>
          <para>Конфигурационный параметр, задающий расположение <link linkend="work_dir">рабочего каталога</link>  данного <link linkend="app_tiers">блока приложения</link>.</para>
          <para>Значение по умолчанию для блоков <structname>Middleware</structname>, <structname>Web Client</structname>, <structname>Web Portal</structname>: <literal>${catalina.home}/work/${<link linkend="cuba.webContextName">cuba.webContextName</link>}</literal>, что в случае стандартного развертывания в <application>Tomcat</application> означает расположение внутри каталога <filename>tomcat/work</filename> в подкаталоге с именем текущего веб-приложения, например, <filename>tomcat/work/app-core</filename>.</para>
          <para>Значение по умолчанию для блока <structname>Desktop Client</structname>: <literal>${<link linkend="cuba.desktop.home">cuba.desktop.home</link>}/work</literal>. </para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.dbDir">
        <term>cuba.dbDir</term>
        <listitem>
          <para>Конфигурационный параметр, задающий расположение <link linkend="db_dir">каталога скриптов базы данных</link>.</para>
          <para>Значение по умолчанию: <literal>${catalina.home}/webapps/${cuba.webContextName}/WEB-INF/db</literal>, что означает расположение в подкаталоге <filename>WEB-INF/db</filename> каталога текущего веб-приложения <application>Tomcat</application>.</para>
          <para>Интерфейс: <code>ServerConfig</code></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.dbmsType">
        <term>cuba.dbmsType</term>
        <listitem>
          <para>Задает тип используемой базы данных. Совместно с <link linkend="cuba.dbmsVersion">cuba.dbmsVersion</link> влияет на выбор имплементаций интерфейсов интеграции с СУБД и на поиск скриптов создания и обновления БД.</para>
          <para>Подробнее см. <xref linkend="dbms_types"/></para>
          <para>Значение по умолчанию: <literal>hsql</literal></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.dbmsVersion">
        <term>cuba.dbmsVersion</term>
        <listitem>
          <para>Необязательное свойство, задающее версию используемой базы данных. Совместно с <link linkend="cuba.dbmsType">cuba.dbmsType</link> влияет на выбор имплементаций интерфейсов интеграции с СУБД и на поиск скриптов создания и обновления БД.</para>
          <para>Подробнее см. <xref linkend="dbms_types"/></para>
          <para>Значение по умолчанию: <literal>отсутствует</literal></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.defaultQueryTimeoutSec">
        <term>cuba.defaultQueryTimeoutSec</term>
        <listitem>
          <para>Задает <link linkend="transaction_timeout">таймаут транзакции</link> по умолчанию.</para>
          <para>Значение по умолчанию: <literal>0</literal>, означает, что таймаут отсутствует.</para>
          <para>Интерфейс: <code>ServerConfig</code></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>cuba.desktop.useServerTime</term>
        <listitem>
          <para>Включает корректировку времени, выдаваемого интерфейсом <code>
              <link linkend="timeSource">TimeSource</link>
            </code> блока <structname>DesktopClient</structname> - оно становится примерно равным времени <structname>Middleware</structname>, к которому подключен данный клиент.</para>
          <para>Значение по умолчанию: <literal>true</literal></para>
          <para>Интерфейс: <code>DesktopConfig</code></para>
          <para>Используется в блоке <structname>DesktopClient</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>cuba.desktop.useServerTimeZone</term>
        <listitem>
          <para>Устанавливает в JVM блока <structname>DesktopClient</structname> timezone  <structname>Middleware</structname>, к которому подключен данный клиент.</para>
          <para>Значение по умолчанию: <literal>true</literal></para>
          <para>Интерфейс: <code>DesktopConfig</code></para>
          <para>Используется в блоке <structname>DesktopClient</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.disableOrmXmlGeneration">
        <term>cuba.disableOrmXmlGeneration</term>
        <listitem>
          <para>Запрещает автоматическую генерацию файла <filename>orm.xml</filename> для <link linkend="extension">расширенных</link> сущностей. Дает возможность вручную создать такой файл и зарегистрировать в параметре <literal>openjpa.MetaDataFactory</literal> файла <filename>
              <link linkend="persistence.xml">persistence.xml</link>
            </filename>.</para>
          <para>Значение по умолчанию: <literal>false</literal>, означает что <filename>orm.xml</filename> будет создан автоматически при наличии расширенных сущностей.</para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.dispatcherSpringContextConfig">
        <term>cuba.dispatcherSpringContextConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задает набор файлов <filename>
              <link linkend="dispatcher-spring.xml">dispatcher-spring.xml</link>
            </filename> в клиентских  блоках.  </para>
          <para>Значением свойства должен быть список имен файлов, разделенный пробелами. Файлы загружаются по правилам интерфейса <code>
              <link linkend="resources">Resources</link>
            </code>.</para>
          <para>Используется в блоках <structname>Web Client</structname>, <structname>Web Portal</structname>.</para>
          <para>Пример:<programlisting>cuba.dispatcherSpringContextConfig=cuba-portal-dispatcher-spring.xml portal-dispatcher-spring.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.download.directories">
        <term>cuba.download.directories</term>
        <listitem>
          <para>Задает список каталогов, из которых можно загружать с <structname>Middleware</structname> файлы через <code>com.haulmont.cuba.core.controllers.FileDownloadController</code>. Загрузка файлов используется в частности механизмом отображения журналов сервера, доступным через экран <guimenu> Администрирование</guimenu> -&gt; <guimenu>Журнал сервера</guimenu> веб-клиента.</para>
          <para>Список задается  через &quot;;&quot;.</para>
          <para>Значение по умолчанию: <literal>${cuba.tempDir};${cuba.logDir}</literal>, означает что файлы можно загружать из <link linkend="temp_dir">временного каталога</link> и <link linkend="log_dir">каталога логов</link>.</para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.groovyEvaluatorImport_1">
        <term>cuba.email.*</term>
        <listitem>
          <para>Параметры отправки email, подробно описаны в <xref linkend="email_sending_properties"/></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.fileStorageDir">
        <term>cuba.fileStorageDir</term>
        <listitem>
          <para>Задает корни структуры каталогов файлового хранилища. Подробнее см. <xref linkend="file_storage_impl"/></para>
          <para>Значение по умолчанию: <literal>null</literal></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.gui.genericFilterChecking">
        <term>cuba.gui.genericFilterChecking</term>
        <listitem>
          <para>Оказывает влияние на поведение компонента <link linkend="gui_Filter">Filter</link>. </para>
          <para>При установке в <code>false</code> отменяется проверка, в результате которой пользователь не может применить  фильтр, не введя ни одного параметра. </para>
          <para>Значение по умолчанию:  <literal>true</literal></para>
          <para>Интерфейс: <code>ClientConfig</code></para>
          <para>Используется в блоках <structname>Web Client</structname> и <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.gui.genericFilterManualApplyRequired">
        <term>cuba.gui.genericFilterManualApplyRequired</term>
        <listitem>
          <para>Оказывает влияние на поведение компонента <link linkend="gui_Filter">Filter</link>. </para>
          <para>При установке в <code>true</code> экраны, содержащие фильтры, не будут автоматически загружать ссответствующие источники данных до тех пор, пока пользователь не нажмет кнопку <guibutton>Применить</guibutton> фильтра. </para>
          <para>При открытии экрана списка с помощью папки приложения или папки поиска значение <property>cuba.gui.genericFilterManualApplyRequired</property> не учитывается, то есть в этом случае фильтр будет применяться. Фильтр не применится, если значение атрибута <code>applyDefault</code> у папки явно установлено в <literal>false</literal>.</para>
          <para>Значение по умолчанию: <literal>false</literal> </para>
          <para>Интерфейс: <code>ClientConfig</code></para>
          <para>Используется в блоках <structname>Web Client</structname> и <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.gui.genericFilterTreeConditionSelect">
        <term>cuba.gui.genericFilterTreeConditionSelect</term>
        <listitem>
          <para>Оказывает влияние на поведение компонента <link linkend="gui_Filter">Filter</link>. </para>
          <para>При установке в <code>false</code> позволяет вместо древовидной структуры выбора условий отображать  плоский выпадающий список.</para>
          <para>Значение по умолчанию:  <literal>true</literal></para>
          <para>Интерфейс: <code>ClientConfig</code></para>
          <para>Используется в блоках <structname>Web Client</structname> и <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.gui.layoutAnalyzerEnabled">
        <term>cuba.gui.layoutAnalyzerEnabled</term>
        <listitem>
          <para>Позволяет отключить команду анализа компоновки экрана <guibutton>Analyze layout</guibutton>, доступную в контекстном меню вкладок главного окна и в заголовках модальных окон. </para>
          <para>Значение по умолчанию:  <literal>true</literal></para>
          <para>Интерфейс: <code>ClientConfig</code></para>
          <para>Используется в блоках <structname>Web Client</structname> и <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.groovyEvaluationPoolMaxIdle">
        <term>cuba.groovyEvaluationPoolMaxIdle</term>
        <listitem>
          <para>Задает максимальное число неиспользуемых скомпилированных выражений Groovy в пуле при выполнении метода  <code>Scripting.evaluateGroovy()</code>. Данный параметр рекомендуется увеличивать  при потребности в интенсивном исполнении выражений Groovy, например, вследствие большого количества <link linkend="application_folder">папок приложения</link>. </para>
          <para>Значение по умолчанию: 8</para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.groovyEvaluatorImport">
        <term>cuba.groovyEvaluatorImport</term>
        <listitem>
          <para>Задает список классов, импортируемых всеми выполняемыми через <code>
              <link linkend="scripting">Scripting</link>
            </code> выражениями на Groovy. </para>
          <para>Имена классов в списке разделяются запятой или точкой с запятой.</para>
          <para>Значение по умолчанию: <code>com.haulmont.cuba.core.global.PersistenceHelper</code></para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
          <para>Пример:<programlisting>cuba.groovyEvaluatorImport=com.haulmont.cuba.core.global.PersistenceHelper,com.abc.sales.CommonUtils</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.gui.useSaveConfirmation">
        <term>cuba.gui.useSaveConfirmation</term>
        <listitem>
          <para>Определяет форму диалога, возникающего при попытке закрытия <link linkend="screens">экрана</link>, имеющего несохраненные изменения в источниках данных.</para>
          <para>Значение <literal>true</literal> задает форму с тремя вариантами выбора: сохранить изменения, не сохранять, либо не закрывать экран.</para>
          <para>Значение <literal>false</literal> задает форму с двумя вариантами: закрыть экран не сохраняя изменений, либо не закрывать экран.</para>
          <para>Значение по умолчанию: <code>true</code></para>
          <para>Интерфейс: <code>ClientConfig</code></para>
          <para>Используется в блоках <structname>Web Client</structname> и   <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.httpSessionExpirationTimeoutSec">
        <term>cuba.httpSessionExpirationTimeoutSec</term>
        <listitem>
          <para>Задает  таймаут бездействия HTTP-сессии
 в секундах.</para>
          <para>Значение по умолчанию: <literal>1800</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке <structname>Web Client</structname>.</para>
          <tip>
            <para>Рекомендуется выставлять параметры <link linkend="cuba.userSessionExpirationTimeoutSec">
                <property>cuba.userSessionExpirationTimeoutSec</property>
              </link> и  <property>cuba.httpSessionExpirationTimeoutSec</property>  в одинаковое значение.</para>
          </tip>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.inMemoryDistinct">
        <term>cuba.inMemoryDistinct</term>
        <listitem>
          <para>Включает режим фильтрации дубликатов записей в памяти, вместо <literal>select distinct</literal> на уровне базы данных. Используется в <link linkend="dataService">
              <code>DataWorker</code>
            </link>. </para>
          <para>Значение по умолчанию: <code>false</code></para>
          <para>Интерфейс: <code>ServerConfig</code></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.jmxUserLogin">
        <term>cuba.jmxUserLogin</term>
        <listitem>
          <para>Логин пользователя, под которым выполняется вход в систему при  <link linkend="system_authentication">системной аутентификации</link>. </para>
          <para>Значение по умолчанию: <literal>admin</literal></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.licensePath">
        <term>cuba.licensePath</term>
        <listitem>
          <para>Путь  к файлу лицензии на использование платформы CUBA. Файл загружается по правилам интерфейса <code>
              <link linkend="resources">Resources</link>
            </code>. </para>
          <para>Значение по умолчанию: <literal>/cuba.license</literal></para>
          <para>Интерфейс: <code>ServerConfig</code></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.localeSelectVisible">
        <term>cuba.localeSelectVisible</term>
        <listitem>
          <para>Включает или отключает возможность пользователя выбирать язык
интерфейса при входе в систему. </para>
          <para>Если <literal>cuba.localeSelectVisible=false</literal>, то локаль пользовательской сессии выбирается следующим образом:<itemizedlist>
              <listitem>
                <para>если для данного экземпляра сущности <code>User</code> установлен атрибут <code>language</code>, то устанавливается локаль для этого языка;</para>
              </listitem>
              <listitem>
                <para>если язык операционной системы пользователя присутствует в списке доступных (заданных свойством <property>
                    <link linkend="cuba.availableLocales">cuba.availableLocales</link>
                  </property>), то выбирается он;</para>
              </listitem>
              <listitem>
                <para>в противном случае выбирается язык, заданный первым в свойстве <property>
                    <link linkend="cuba.availableLocales">cuba.availableLocales</link>
                  </property>.</para>
              </listitem>
            </itemizedlist></para>
          <para>Значение по умолчанию: <literal>true</literal></para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.logDir">
        <term>cuba.logDir</term>
        <listitem>
          <para>Конфигурационный параметр, задающий расположение <link linkend="log_dir">каталога журналов</link> данного <link linkend="app_tiers">блока приложения</link>.</para>
          <para>Значение по умолчанию для блоков <structname>Middleware</structname>, <structname>Web Client</structname>, <structname>Web Portal</structname>: <literal>${catalina.home}/logs</literal>, что в случае стандартного развертывания в <application>Tomcat</application> означает  каталог <filename>tomcat/logs</filename>.</para>
          <para>Значение по умолчанию для блока <structname>Desktop Client</structname>: <literal>${<link linkend="cuba.desktop.home">cuba.desktop.home</link>}/logs</literal>. </para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.mainMessagePack">
        <term>cuba.mainMessagePack</term>
        <listitem>
          <para>Задает <link linkend="main_message_pack">главный пакет сообщений</link> данного блока приложения. </para>
          <para>Значением свойства может быть либо один пакет, либо список пакетов, разделенный пробелами. </para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
          <para>Пример:<programlisting>cuba.mainMessagePack=com.haulmont.cuba.web com.sample.sales.web</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.menuConfig">
        <term>cuba.menuConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задает набор файлов <filename>
              <link linkend="menu.xml">menu.xml</link>
            </filename>. </para>
          <para>Значением свойства должен быть список имен файлов, разделенный пробелами. Файлы загружаются по правилам интерфейса <code>
              <link linkend="resources">Resources</link>
            </code>.</para>
          <para>Используется в блоках <structname>Web Client</structname> и <structname>Desktop Client</structname>.</para>
          <para>Пример:<programlisting>cuba.menuConfig=cuba-web-menu.xml web-menu.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.metadataConfig">
        <term>cuba.metadataConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задает набор файлов <filename>
              <link linkend="metadata.xml">metadata.xml</link>
            </filename>. </para>
          <para>Значением свойства должен быть список имен файлов, разделенный пробелами. Файлы загружаются по правилам интерфейса <code>
              <link linkend="resources">Resources</link>
            </code>.</para>
          <para>Используется в блоках <structname>Middleware, <structname>Web Client</structname> и <structname>Desktop Client</structname></structname>.</para>
          <para>Пример:<programlisting>cuba.metadataConfig=cuba-metadata.xml metadata.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.passwordEncryptionModule">
        <term>cuba.passwordEncryptionModule</term>
        <listitem>
          <para>Задает имя бина, используемого для хэширования паролей пользователей.</para>
          <para>Значение по умолчанию: <literal>cuba_Sha1EncryptionModule</literal></para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>cuba.passwordPolicyEnabled</term>
        <listitem>
          <para>Определяет, нужно ли применять политику проверки пароля. Если свойство имеет значение <literal>true</literal>, то все новые задаваемые пользователями пароли будут проверяться в соответствии со свойством <property>
              <link linkend="cuba.passwordPolicyRegExp">cuba.passwordPolicyRegExp</link>
            </property>.</para>
          <para>Значение по умолчанию: <literal>false</literal></para>
          <para>Интерфейс: <code>ClientConfig</code></para>
          <para>Используется в блоках клиентского уровня: <structname>Web Client</structname>, <structname>Web Portal</structname>, <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.passwordPolicyRegExp">
        <term>cuba.passwordPolicyRegExp</term>
        <listitem>
          <para>В данном свойстве задается регулярное выражение, которое используется в политике проверки пароля.</para>
          <para>Значение по умолчанию:</para>
          <para><prompt>((?=.*\\d)(?=.*\\p{javaLowerCase}) (?=.*\\p{javaUpperCase}).{6,20})</prompt></para>
          <para>Это означает, что в пароль должен содержать от 6 до 20 символов, в нем можно использоваться цифры, символы и буквы латинского алфавита. При этом обязательно в пароле должна  быть хотя бы одна цифра, одна буква в нижнем регистре и одна буква в верхнем регистре. Более подробная информация о синтаксисе регулярных выражений можно найти на сайтах: <ulink url="http://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B3%D1%83%D0%BB%D1%8F%D1%80%D0%BD%D1%8B%D0%B5_%D0%B2%D1%8B%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F">http://ru.wikipedia.org/wiki/Регулярные_выражения</ulink> и <ulink url="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html</ulink></para>
          <para>Интерфейс: <code>ClientConfig</code></para>
          <para>Используется в блоках клиентского уровня: <structname>Web Client</structname>, <structname>Web Portal</structname>, <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.permissionConfig">
        <term>cuba.permissionConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задает набор файлов <filename>
              <link linkend="permissions.xml">permissions.xml</link>
            </filename>. </para>
          <para>Используется в блоках <structname>Web Client</structname> и <structname>Desktop Client</structname>.</para>
          <para>Пример:<programlisting>cuba.permissionConfig=cuba-web-permissions.xml web-permissions.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.persistenceConfig">
        <term>cuba.persistenceConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задает набор файлов <filename>
              <link linkend="persistence.xml">persistence.xml</link>
            </filename>. </para>
          <para>Значением свойства должен быть список имен файлов, разделенный пробелами. Файлы загружаются по правилам интерфейса <code>
              <link linkend="resources">Resources</link>
            </code>.</para>
          <para>Используется в  блоках <structname>Middleware, <structname>Web Client</structname> и <structname>Desktop Client</structname></structname>.</para>
          <para>Пример:<programlisting>cuba.persistenceConfig=cuba-persistence.xml persistence.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.portal.anonymousUserLogin">
        <term>cuba.portal.anonymousUserLogin</term>
        <listitem>
          <para>Логин пользователя системы, который используется для создания анонимной пользовательской сессии в блоке <structname>Web Portal</structname>. </para>
          <para>Пользователь с таким логином должен быть создан в подсистеме безопасности, и ему должны быть назначены соответствующие права. Пароль пользователя игнорируется, так как анонимная сессия портала создается методом <code>
              <link linkend="login">loginTrusted()</link>
            </code> с передачей пароля, указанного в свойстве <property>
              <link linkend="cuba.trustedClientPassword">cuba.trustedClientPassword</link>
            </property>.</para>
          <para>Интерфейс:  <code>PortalConfig</code></para>
          <para>Используется в блоке <structname>Web Portal</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.randomServerPriority">
        <term>cuba.randomServerPriority</term>
        <listitem>
          <para>Задает режим случайного выбора сервера <structname>Middleware</structname> в кластере для обеспечения равномерного распределения клиентов между серверами.  </para>
          <para>См. также свойство <link linkend="cuba.connectionUrlList">cuba.connectionUrlList</link>.</para>
          <para>Значение по умолчанию: <code>false</code></para>
          <para>Используется в <link linkend="app_tiers">блоках</link> <structname>Web Client</structname>, <structname>Web Portal</structname>, <structname>Desktop Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.remotingSpringContextConfig">
        <term>cuba.remotingSpringContextConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задает набор файлов <filename>
              <link linkend="remoting-spring.xml">remoting-spring.xml</link>
            </filename> в  блоке <structname>Middleware</structname>.  </para>
          <para>Значением свойства должен быть список имен файлов, разделенный пробелами. Файлы загружаются по правилам интерфейса <code>
              <link linkend="resources">Resources</link>
            </code>.</para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
          <para>Пример:<programlisting>cuba.remotingSpringContextConfig=cuba-remoting-spring.xml remoting-spring.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.rest.productionMode">
        <term>cuba.rest.productionMode</term>
        <listitem>
          <para>Включает режим экспуатации <link linkend="rest_api">REST API</link>, при котором текст исключительных ситуаций не возвращается клиенту.  </para>
          <para>Интерфейс:  <code>RestConfig</code></para>
          <para>Используется в блоке <structname>Web Portal</structname>.</para>
          <para>Значение по умолчанию: <literal>false</literal></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.restApiUrl">
        <term>cuba.restApiUrl</term>
        <listitem>
          <para>URL, по которому доступен <link linkend="rest_api">REST API</link> приложения.  </para>
          <para>Интерфейс:  <code>GlobalConfig</code></para>
          <para>Может использоваться во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
          <para>Значение по умолчанию: <literal>http://localhost:8080/app-portal/api</literal></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.schedulingActive">
        <term>cuba.schedulingActive</term>
        <listitem>
          <para>Включает и выключает механизм выполнения <link linkend="scheduled_tasks_cuba">назначенных заданий</link> CUBA.  </para>
          <para>Значение по умолчанию: <literal>false</literal></para>
          <para>Интерфейс:  <code>ServerConfig</code></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.springContextConfig">
        <term>cuba.springContextConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задает набор файлов <filename>
              <link linkend="spring.xml">spring.xml</link>
            </filename> в каждом стандартном блоке приложения.  </para>
          <para>Значением свойства должен быть список имен файлов, разделенный пробелами. Файлы загружаются по правилам интерфейса <code>
              <link linkend="resources">Resources</link>
            </code>.</para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
          <para>Пример:<programlisting>cuba.springContextConfig=cuba-spring.xml spring.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.supportEmail">
        <term>cuba.supportEmail</term>
        <listitem>
          <para>Задает email, на который отправляются отчеты об исключениях из окна стандартного обработчика, и сообщения пользователей из экрана <guimenu>Help</guimenu> -&gt; <guimenu>Feedback</guimenu>. </para>
          <para>Если данное свойство установлено в пустую строку, кнопка <guibutton>Report</guibutton> в окне обработчика исключений не показывается. </para>
          <para>Для успешной отсылки email необходимо настроить параметры, описанные в разделе  <xref linkend="email_sending_properties"/></para>
          <para>Интерфейс:  <code>WebConfig</code></para>
          <para>Используется в блоке <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.tempDir">
        <term>cuba.tempDir</term>
        <listitem>
          <para>Конфигурационный параметр, задающий расположение <link linkend="temp_dir">временного каталога</link>  данного <link linkend="app_tiers">блока приложения</link>.</para>
          <para>Значение по умолчанию для блоков <structname>Middleware</structname>, <structname>Web Client</structname>, <structname>Web Portal</structname>: <literal>${catalina.home}/temp/${<link linkend="cuba.webContextName">cuba.webContextName</link>}</literal>, что в случае стандартного развертывания в <application>Tomcat</application> означает расположение внутри каталога <filename>tomcat/temp</filename> в подкаталоге с именем текущего веб-приложения, например, <filename>tomcat/temp/app-core</filename>.</para>
          <para>Значение по умолчанию для блока <structname>Desktop Client</structname>: <literal>${<link linkend="cuba.desktop.home">cuba.desktop.home</link>}/temp</literal>. </para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.triggerFilesCheck">
        <term>cuba.triggerFilesCheck</term>
        <listitem>
          <para>Позволяет отключить обработку триггер-файлов вызова бинов.</para>
          <para>Триггер-файл представляет собой файл, помещаемый в подкаталог <filename>triggers</filename> <link linkend="temp_dir">временного каталога</link> данного блока приложения. Имя триггер-файла состоит из двух частей, разделенных точкой. Первая часть соответствует имени <link linkend="managed_beans">бина</link>, вторая - имени вызываемого метода бина, например <code>cuba_Messages.clearCache</code>. Обработчик триггер-файлов следит за их появлением, вызывает соответствующие методы и удаляет файлы.</para>
          <para>В платформе вызов обработчика задан в файле <filename>cuba-web-spring.xml</filename>, то есть по умолчанию обработка триггер-файлов производится для блока Web Client. На уровне проекта можно аналогично запустить обработку для других модулей, <link linkend="scheduled_tasks">периодически вызывая</link> метод process() бина cuba_TriggerFilesProcessor.</para>
          <para>См. также свойство <link linkend="cuba.triggerFilesCheckInterval">cuba.triggerFilesCheckInterval</link>.</para>
          <para>Значение по умолчанию: <literal>true</literal></para>
          <para>Используется в блоках, для которых настроена обработка, по умолчанию - <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.triggerFilesCheckInterval">
        <term>cuba.triggerFilesCheckInterval</term>
        <listitem>
          <para>Устанавливает период в миллисекундах  обработки триггер-файлов вызова бинов, заданный в файле <filename>cuba-web-spring.xml</filename>.</para>
          <para>См. также свойство <link linkend="cuba.triggerFilesCheck">cuba.triggerFilesCheck</link>.</para>
          <para>Значение по умолчанию: <literal>5000</literal></para>
          <para>Используется в блоке <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.trustedClientPassword">
        <term>cuba.trustedClientPassword</term>
        <listitem>
          <para>Пароль, используемый методом <code>LoginService.loginTrusted()</code>. Средний слой может аутентифицировать пользователей, подключающихся через доверенный клиентский <link linkend="app_tiers">блок</link>, без проверки пользовательского пароля. </para>
          <para>Это свойство используется в случае, если пароли пользователей не хранятся в БД, и реальную аутентификацию выполняет сам клиентский блок, например,  путем интеграции с <application>Active Directory</application>.</para>
          <para>Интерфейсы:  <code>ServerConfig</code>, <code>WebConfig</code></para>
          <para>Используется в блоках: <structname>Middleware</structname>, <structname>Web Client</structname>, <structname>Web Portal</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.trustedClientPermittedIpMask">
        <term>cuba.trustedClientPermittedIpMask</term>
        <listitem>
          <para>Маска IP адресов, с которых возможен вызов метода <code>LoginService.loginTrusted()</code>, в формате регулярного выражения.</para>
          <para>Значение по умолчанию: <literal>127\.0\.0\.1</literal></para>
          <para>Интерфейсы:  <code>ServerConfig</code>, <code>WebConfig</code></para>
          <para>Используется в блоках: <structname>Middleware</structname>, <structname>Web Client</structname>, <structname>Web Portal</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.uniqueConstraintViolationPattern">
        <term>cuba.uniqueConstraintViolationPattern</term>
        <listitem>
          <para>Регулярное выражение, по которому определяется, что данное  исключение произошло по причине нарушения ограничения уникальности в базе данных. Имя индекса, поддерживающего ограничение, должно возвращаться первой или второй группой выражения. Например:<programlisting>ERROR: duplicate key value violates unique constraint &quot;(.+)&quot;</programlisting></para>
          <para>Имя индекса можно использовать для выдачи пользователю локализованного сообщения о том, для какой сущности нарушено ограничение. Для этого в <link linkend="main_message_pack">главном пакете сообщений</link> необходимо задать ключи, соответствующие именам индексов. Например:<programlisting>IDX_SEC_USER_UNIQ_LOGIN = A user with the same login already exists</programlisting></para>
          <para>Данное свойство позволяет настроить реакцию на исключения уникальности в зависимости от используемой версии и локали сервера базы данных.</para>
          <para>Значение по умолчанию: возвращается методом <code>PersistenceManagerService.getUniqueConstraintViolationPattern()</code> для соответствующей СУБД.</para>
          <para>Используется во всех клиентских блоках приложения.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.useCurrentTxForConfigEntityLoad">
        <term>cuba.useCurrentTxForConfigEntityLoad</term>
        <listitem>
          <para>Если значение данного свойства <code>true</code>, то при загрузке экземпляров сущностей через <link linkend="config_interfaces">конфигурационные интерфейсы</link> будет использоваться текущая транзакция (если таковая имеется в данный момент), что может положительно сказаться на производительности. В противном случае  всегда создается и завершается новая транзакция и возвращается detached экземпляр.</para>
          <para>Значение по умолчанию: <literal>false</literal></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.useLocalServiceInvocation">
        <term>cuba.useLocalServiceInvocation</term>
        <listitem>
          <para>При установке данного свойства в <code>true</code> и в случае <link linkend="fast_deployment">быстрого развертывания</link> в Tomcat блоки <structname>Web Client</structname> и <structname>Web Portal</structname> вызывают сервисы <structname>Middleware</structname> в обход сетевого стека, что положительно сказывается на производительности системы. В других вариантах развертывания данное свойство необходимо установить в <code>false</code>.</para>
          <para>Значение по умолчанию: <literal>true</literal></para>
          <para>Используется в <link linkend="app_tiers">блоках</link> <structname>Web Client</structname> и <structname>Web Portal</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.user.fullNamePattern">
        <term>cuba.user.fullNamePattern</term>
        <listitem>
          <para>Задает шаблон формирования полного имени пользователя. </para>
          <para>Значение по умолчанию: <literal>{LL| }{F|. }{M|.}</literal></para>
          <para>Полное имя можно сформировать по  шаблону из имени, отчества и фамилии  пользователя. В шаблоне  используются следующие правила:</para>
          <itemizedlist>
            <listitem>
              <para>Фигурными скобками <literal>{}</literal> разделяются части шаблона между собой</para>
            </listitem>
            <listitem>
              <para>Правила формирования шаблона внутри фигурных скобок: один из следующих символов и далее, без пробела, символ <literal> |</literal>.</para>
              <para><literal>LL</literal> означает фамилию пользователя, написанную в полном варианте (Иванов)</para>
              <para><literal>L</literal> означает фамилию пользователя, написанную в кратком варианте (И)</para>
              <para><literal>FF</literal> означает имя пользователя, написанного в полном варианте (Петр)</para>
              <para><literal>F</literal> означает фамилию пользователя, написанную в кратком варианте (П)</para>
              <para><literal>MM</literal> означает отчество пользователя, написанное в полном варианте (Сергеевич)</para>
              <para><literal>M</literal> означает отчество пользователя, написанное в кратком варианте (С)</para>
            </listitem>
            <listitem>
              <para>После символа <literal>|</literal> могут идти любые символы, в том числе, и пробел.</para>
            </listitem>
          </itemizedlist>
          <para>Используется в блоках Web Client и Desktop Client.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.user.namePattern">
        <term>cuba.user.namePattern</term>
        <listitem>
          <para>Задает шаблон отображения имени экземпляра сущности <code>User</code> (пользователь). Данное имя отображается в том числе в правом верхнем углу главного окна системы.</para>
          <para>Значение по умолчанию: <literal>{1} [{0}]</literal></para>
          <para>Вместо <code>{0}</code> подставляется атрибут <code>login</code>, вместо <code>{1}</code> - атрибут <code>name</code>.</para>
          <para>Используется в блоках Middleware, Web Client, Desktop Client.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.userSessionExpirationTimeoutSec">
        <term>cuba.userSessionExpirationTimeoutSec</term>
        <listitem>
          <para>Задает  таймаут неактивности сессии пользователя
 в секундах.</para>
          <para>Значение по умолчанию: <literal>1800</literal></para>
          <para>Интерфейс: <code>ServerConfig</code></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
          <tip>
            <para>Рекомендуется выставлять параметры <property>cuba.userSessionExpirationTimeoutSec</property> и  <link linkend="cuba.httpSessionExpirationTimeoutSec">
                <property>cuba.httpSessionExpirationTimeoutSec</property>
              </link>  в одинаковое значение.</para>
          </tip>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>cuba.userSessionProviderUrl</term>
        <listitem>
          <para>URL для соединения с <link linkend="app_tiers">блоком</link> <structname>Middleware</structname>, через который выполняется вход пользователей в систему. </para>
          <para>Этот параметр необходимо устанавливать  в дополнительных блоках среднего слоя, которые выполняют запросы клиентов, но не содержат общего кэша пользовательских сессий. Тогда в начале выполнения запроса при отсутствии требуемой сессии в локальном кэше данный блок вызовет метод <code>LoginService.getSession()</code> по указанному URL, и в случае успеха закэширует полученную сессию у себя.</para>
          <para>Интерфейс: <code>ServerConfig</code></para>
          <para>Используется в блоке <structname>Middleware</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.viewsConfig">
        <term>cuba.viewsConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задающий набор файлов <link linkend="views.xml">views.xml</link>, автоматически развертываемых на старте приложения. См. <xref linkend="views"/></para>
          <para>Используется во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
          <para>Пример:<programlisting>cuba.viewsConfig=cuba-views.xml reports-views.xml views.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.springContextConfig_2">
        <term>cuba.webAppUrl</term>
        <listitem>
          <para>URL, по которому доступен <structname>Web Client</structname>  приложения.  </para>
          <para>Используется, в частности, для формирования <link linkend="link_to_screen">ссылок на экраны</link> приложения извне, а также классом <code>ScreenHistorySupport</code>.</para>
          <para>Интерфейс:  <code>GlobalConfig</code></para>
          <para>Может использоваться во всех стандартных <link linkend="app_tiers">блоках</link>.</para>
          <para>Значение по умолчанию: <literal>http://localhost:8080/app</literal></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.windowConfig">
        <term>cuba.windowConfig</term>
        <listitem>
          <para>Конфигурационный параметр, задает набор файлов <filename>
              <link linkend="screens.xml">screens.xml</link>
            </filename>. </para>
          <para>Значением свойства должен быть список имен файлов, разделенный пробелами. Файлы загружаются по правилам интерфейса <code>
              <link linkend="resources">Resources</link>
            </code>.</para>
          <para>Используется в блоках <structname>Web Client</structname> и <structname>Desktop Client</structname>.</para>
          <para>Пример:<programlisting>cuba.windowConfig=cuba-web-screens.xml web-screens.xml</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.appFoldersRefreshPeriodSec">
        <term>cuba.web.appFoldersRefreshPeriodSec</term>
        <listitem>
          <para>Период по умолчанию обновления <link linkend="folders_pane">папок приложения</link>  в секундах.</para>
          <para>Значение по умолчанию: <literal>180</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.appWindowMode">
        <term>cuba.web.appWindowMode</term>
        <listitem>
          <para>Задает начальный режим главного окна: с вкладками или одноэкранный (<code>TABBED</code> или <code>SINGLE</code>). В одноэкранном режиме экран, открываемый в режиме <code>NEW_TAB</code>, отображается не в новой вкладке, а полностью заменяет текущий экран. Это может быть удобно для простых приложений и неопытных пользователей.</para>
          <para>Пользователь впоследствии может задать желаемый режим через экран <guimenu>Help</guimenu> &gt; <guimenu>Settings</guimenu>.</para>
          <para>Значение по умолчанию: <literal>TABBED</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.foldersPaneDefaultWidth">
        <term>cuba.web.foldersPaneDefaultWidth</term>
        <listitem>
          <para>Ширина по умолчанию <link linkend="folders_pane">панели папок</link> в пикселях.</para>
          <para>Значение по умолчанию: <literal>200</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.foldersPaneEnabled">
        <term>cuba.web.foldersPaneEnabled</term>
        <listitem>
          <para>Если <code>false</code>, то функциональность панели папок отключена.</para>
          <para>Значение по умолчанию: <literal>true</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.foldersPaneVisibleByDefault">
        <term>cuba.web.foldersPaneVisibleByDefault</term>
        <listitem>
          <para>Если <code>true</code>, то при первом входе пользователя в систему <link linkend="folders_pane">панель папок</link> будет отображаться в развернутом состоянии, если <code>false</code> - то в свернутом.</para>
          <para>Значение по умолчанию: <literal>false</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.linkHandlerActions">
        <term>cuba.web.linkHandlerActions</term>
        <listitem>
          <para>Определяет список команд, передаваемых в URL, для которых вызывается обработка бином <code>LinkHandler</code>. См. <xref linkend="link_to_screen"/></para>
          <para>Элементы списка отделяются символом <code>|</code>.</para>
          <para>Значение по умолчанию: <literal>open|o</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>cuba.web.loginDialogDefaultUser</term>
        <listitem>
          <para>Задает имя пользователя по умолчанию. Оно будет автоматически подставляться в экране входа в систему, что удобно в процессе разработки приложения. В режиме эксплуатации приложения в данном свойстве необходимо задать  значение <literal> &lt;disabled&gt;</literal>.</para>
          <para>Значение по умолчанию: <literal>admin</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>cuba.web.loginDialogDefaultPassword</term>
        <listitem>
          <para>Задает пароль пользователя по умолчанию. Он будет автоматически подставляться в экране входа в систему, что удобно в процессе разработки приложения. В режиме эксплуатации приложения в данном свойстве необходимо задать  значение <literal> &lt;disabled&gt;</literal>.</para>
          <para>Значение по умолчанию: <literal>admin</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.maxTabCount">
        <term>cuba.web.maxTabCount</term>
        <listitem>
          <para>Задает максимальное количество вкладок с экранами, которые пользователь может открыть в главном окне приложения. Значение <literal>0</literal> снимает ограничение.</para>
          <para>Значение по умолчанию: <literal>7</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.rememberMeEnabled">
        <term>cuba.web.rememberMeEnabled</term>
        <listitem>
          <para>Управляет отображением флажка <guilabel>Remeber Me</guilabel> в стандартном экране входа в систему в веб клиенте.</para>
          <para>Значение по умолчанию: <code>true</code></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.resourcesRoot">
        <term>cuba.web.resourcesRoot</term>
        <listitem>
          <para>Задает расположение каталога, из которого могут быть загружены файлы для вывода на экран компонентом <link linkend="gui_Embedded">Embedded</link>. Например:<programlisting>cuba.web.resourcesRoot=${cuba.confDir}/resources</programlisting></para>
          <para>Значение по умолчанию: <literal>null</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.showFolderIcons">
        <term>cuba.web.showFolderIcons</term>
        <listitem>
          <para>Задает отображение пиктограмм в <link linkend="folders_pane">панели папок</link>. Если включено, то используются следующие файлы каталога темы приложения:<itemizedlist>
              <listitem>
                <para><filename>icons/app-folder-small.png</filename> - для папок приложения</para>
              </listitem>
              <listitem>
                <para><filename>icons/search-folder-small.png</filename> - для папок поиска</para>
              </listitem>
              <listitem>
                <para><filename>icons/set-small.png</filename> - для наборов</para>
              </listitem>
            </itemizedlist></para>
          <para>Значение по умолчанию: <literal>false</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.useLightHeader">
        <term>cuba.web.useLightHeader</term>
        <listitem>
          <para>Включает формирование компактной вехней части окна - лого, строка меню, имя пользователя и кнопка логаута в одну строку. В выключенном состоянии методом <code>AppWindow.createTitleLayout()</code> формируется дополнительная область сверху.</para>
          <para>Значение по умолчанию: <literal>true</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.web.viewFileExtensions">
        <term>cuba.web.viewFileExtensions</term>
        <listitem>
          <para>Задает список расширений файлов, отображаемых в окне браузера при <link linkend="file_download">выгрузке файла</link> через <code>ExportDisplay.show()</code>. Разделителем элементов списка является символ <literal>|</literal>.</para>
          <para>Значение по умолчанию: <literal>htm|html|jpg|png|jpeg|pdf</literal></para>
          <para>Интерфейс: <code>WebConfig</code></para>
          <para>Используется в блоке   <structname>Web Client</structname>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.webContextName">
        <term>cuba.webContextName</term>
        <listitem>
          <para>Конфигурационный параметр, задающий имя контекста веб-приложения. Как правило, эквивалентен имени каталога или WAR-файла, содержащего данный <link linkend="app_tiers">блок приложения</link>.</para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется в блоках<structname> Middleware</structname>, <structname>Web Client</structname>, <structname>Web Portal</structname>.</para>
          <para>Например, для блока <structname>Middleware</structname>, расположенного в каталоге <filename>tomcat/webapps/app-core</filename>, и доступного по URL <filename>http://somehost:8080/app-core</filename> данное свойство должно быть задано следующим образом:<programlisting>cuba.webContextName=app-core</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.webHostName">
        <term>cuba.webHostName</term>
        <listitem>
          <para>Конфигурационный параметр, задающий имя хоста, на котором  запущен данный <link linkend="app_tiers">блок приложения</link>.</para>
          <para>Значение по умолчанию: <literal>localhost</literal></para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется в блоках<structname> Middleware</structname>, <structname>Web Client</structname>, <structname>Web Portal</structname>.</para>
          <para>Например, для блока <structname>Middleware</structname>,  доступного по URL <filename>http://somehost:8080/app-core</filename> данное свойство должно быть задано следующим образом:<programlisting>cuba.webHostName=somehost</programlisting></para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.webPort">
        <term>cuba.webPort</term>
        <listitem>
          <para>Конфигурационный параметр, задающий имя порта, на котором  запущен данный <link linkend="app_tiers">блок приложения</link>.</para>
          <para>Значение по умолчанию: <literal>8080</literal></para>
          <para>Интерфейс: <code>GlobalConfig</code></para>
          <para>Используется в блоках<structname> Middleware</structname>, <structname>Web Client</structname>, <structname>Web Portal</structname>.</para>
          <para>Например, для блока <structname>Middleware</structname>,  доступного по URL <filename>http://somehost:8080/app-core</filename> данное свойство должно быть задано следующим образом:<programlisting>cuba.webPort=8080</programlisting></para>
        </listitem>
      </varlistentry>
    </variablelist>
  </appendix>
  <appendix>
    <title>Системные свойства</title>
    <para>Системные свойства задаются при запуске JVM с помощью аргумента командной строки <literal>-D</literal> и могут быть получены или установлены  методами <code>getProperty()</code>, <code>setProperty()</code> класса <code>System</code>.</para>
    <variablelist>
      <varlistentry id="log4j.configuration">
        <term>log4j.configuration</term>
        <listitem>
          <para>Определяет местонахождение файла конфигурации фреймворка <application>
              <ulink url="http://logging.apache.org/log4j/1.2/manual.html">Apache log4j</ulink>
            </application>.</para>
          <para>Для <link linkend="app_tiers">блоков приложения</link>, работающих на веб-сервере <application>Tomcat</application>, данное системное свойство задается в файлах <filename>tomcat/bin/setenv.bat</filename> и <filename>tomcat/bin/setenv.sh</filename>. По умолчанию оно указывает на конфигурационный файл <filename>tomcat/conf/log4j.xml</filename>.</para>
          <para>Для <structname>Desktop Client</structname>, если данное свойство не задано при запуске JVM, оно задается в коде самого приложения и по умолчанию указывает на файл <filename>cuba-log4j.xml</filename>, расположенный в корне CLASSPATH. Задать другой файл конфигурации можно, переопределив метод <code>getDefaultLog4jConfig()</code> класса <code>com.haulmont.cuba.desktop.App</code>.</para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.desktop.home">
        <term>cuba.desktop.home</term>
        <listitem>
          <para>Для <link linkend="app_tiers">блока</link> <structname>Desktop Client</structname> задает расположение домашнего каталога, в котором по умолчанию находятся каталоги, определяемые свойствами приложения <property>
              <link linkend="cuba.confDir">cuba.confDir</link>
            </property>, <property>
              <link linkend="cuba.logDir">cuba.logDir</link>
            </property>, <property>
              <link linkend="cuba.tempDir">cuba.tempDir</link>
            </property>, <property>
              <link linkend="cuba.dataDir">cuba.dataDir</link>
            </property>.</para>
          <para>Если данное свойство не задано при запуске JVM, то будет использовано значение <filename>${user.home}/.haulmont/cuba</filename>, которое можно изменить в прикладном проекте, переопределив метод <code>getDefaultHomeDir()</code> класса <code>com.haulmont.cuba.desktop.App</code>. </para>
        </listitem>
      </varlistentry>
      <varlistentry id="cuba.unitTestMode">
        <term>cuba.unitTestMode</term>
        <listitem>
          <para>Данное системное свойство устанавливается в значение <code>true</code> в режиме выполнения интеграционных тестов базовым классом <code>CubaTestCase</code>.</para>
          <para>Пример использования:<programlisting language="java">if (!Boolean.valueOf(System.getProperty(&quot;cuba.unitTestMode&quot;)))
    return &quot;Not in test mode&quot;;</programlisting></para>
        </listitem>
      </varlistentry>
    </variablelist>
  </appendix>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="changelog.xml" encoding="UTF-8"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="glossary.xml" encoding="UTF-8"/>
</book>
