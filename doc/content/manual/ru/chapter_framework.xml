<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" []>
<chapter id="chapter_framework" lang="ru">
  <title>Устройство платформы</title>
  <para>В данной главе описываются различные аспекты архитектуры платформы <trademark>CUBA</trademark> и приложений на ее основе.</para>
  <section>
    <title>Структура CUBA-приложения</title>
    <para>На диаграмме ниже приведена структура развернутого приложения, созданного на базе платформы. </para>
    <figure>
      <title>Структура CUBA-приложения</title>
      <mediaobject>
        <imageobject>
          <imagedata contentwidth="80%" align="center" fileref="img/DeploymentStructure.png"/>
        </imageobject>
      </mediaobject>
    </figure>
    <para>В приведенном варианте приложение обеспечивает отсутствие единой точки отказа, балансировку нагрузки и подключение различных типов клиентов. В простейшем случае приложение может быть развернуто на одном сервере, в том числе, содержащем и базу данных. Стрелками изображено направление запросов &quot;от пользователя к данным&quot;.</para>
    <para>Приложение, основанное на платформе, физически состоит из нескольких <firstterm>уровней</firstterm> (tiers):</para>
    <variablelist>
      <varlistentry>
        <term>Middleware</term>
        <listitem>
          <para>Средний слой, содержащий основную бизнес-логику приложения. Представляет собой отдельное веб-приложение под управлением стандартного контейнера <glossterm linkend="glossary_java_web_profile">Java EE Web Profile</glossterm>.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Web Client</term>
        <listitem>
          <para>Основной клиентский уровень, как правило, содержащий полнофункциональный интерфейс для Intranet-пользователей. Представляет собой отдельное веб-приложение под управлением стандартного контейнера <glossterm linkend="glossary_java_web_profile">Java EE Web Profile</glossterm>. Реализация пользовательского интерфейса основана на фреймворке <glossterm linkend="glossary_vaadin">Vaadin</glossterm>.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Web Portal</term>
        <listitem>
          <para>Дополнительный клиентский уровень, содержащий интерфейс для внешних (Internet) пользователей. Может использоваться для интеграции с мобильными устройствами или сторонними приложениями. Представляет собой отдельное веб-приложение под управлением стандартного контейнера <glossterm linkend="glossary_java_web_profile">Java EE Web Profile</glossterm>. Реализация пользовательского интерфейса основана на фреймворке <link linkend="text_spring">Spring</link> MVC.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Desktop Client</term>
        <listitem>
          <para>Дополнительный клиентский уровень, содержащий интерфейс для Intranet-пользователей. Представляет собой десктопное Java-приложение, реализация пользовательского интерфейса основана на фреймворке <glossterm linkend="glossary_swing">Java Swing</glossterm>.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <para><emphasis role="bold">REST API</emphasis> − компонент <link linkend="section_middleware_id">среднего слоя (Middleware)</link>, обеспечивающий интеграцию системы со сторонними приложениями.</para>
    <para>Физически CUBA-приложение всегда состоит как минимум из двух частей:</para>
    <itemizedlist>
      <listitem>
        <para>Веб-приложения <link linkend="section_middleware_id">среднего слоя (Middleware)</link></para>
      </listitem>
      <listitem>
        <para>Веб-приложения веб-клиента (Web Client)</para>
      </listitem>
    </itemizedlist>
    <para>Оба этих веб-приложения  могут быть развернуты на любом веб-сервере <application>Java</application>. По умолчанию используется <application>Apache Tomcat</application>. </para>
    <para>Веб и десктоп клиенты взаимодействуют со средним слоем одинаковым образом посредством протокола <application>HTTP</application>, что позволяет размещать средний слой произвольным образом, в том числе за сетевым экраном. Следует отметить, что при развертывании в простейшем случае среднего слоя и веб-клиента на одном сервере между ними организуется локальное взаимодействие в обход сетевого стека для снижения накладных расходов.</para>
  </section>
  <section>
    <title>Структура проекта</title>
    <para id="text_module_id">Функционально проект приложения содержит зависимости от <firstterm>проектов</firstterm>, входящих в состав платформы. Проект − это структурная единица, содержащая программный код. Каждый проект имеет определенное предназначение. Диаграмма зависимостей проектов платформы изображена на рисунке.</para>
    <figure>
      <title>Диаграмма зависимостей проектов платформы</title>
      <mediaobject>
        <imageobject>
          <imagedata align="center" fileref="img/projectStructure.png"/>
        </imageobject>
      </mediaobject>
    </figure>
    <para>Сплошными линиями изображены обязательные зависимости, пунктирными − опциональные.</para>
    <para>Рассмотрим проекты платформы более подробно.</para>
    <para><emphasis role="bold">Проект cuba</emphasis></para>
    <para>Это базовый проект, обязательная часть любого приложения.  Содержит функциональность для работы с базой данных, набор <link linkend="section_services_id">сервисов (Services)</link> <link linkend="section_middleware_id">среднего слоя (Middleware)</link>, <link linkend="section_gui_framework">фреймворк графического интерфейса пользователя (Generic User Interface Framework)</link>, функциональность управления пользователями и их доступом к данным <footnote>
        <para>Описание функциональности управления пользователями и их доступом к данным содержится в <productname>Руководстве подсистемы безопасности платформы <trademark>CUBA</trademark></productname></para>
      </footnote>. Данный проект может быть собран как полноценное независимое приложение.</para>
    <para><emphasis role="bold">Проект workflow</emphasis></para>
    <para>Опциональный проект для работы с <glossterm linkend="glossary_process_id">бизнес-процессами</glossterm>.</para>
    <para><emphasis role="bold">Проект fts</emphasis></para>
    <para>Опциональный проект  <link linkend="section_fts">полнотекстового поиска</link>.</para>
    <para><emphasis role="bold">Проект charts</emphasis></para>
    <para>Опциональный проект для <link linkend="section_charts">отображения диаграмм</link> в веб-клиенте.</para>
    <para><emphasis role="bold">Проект ccpayments</emphasis></para>
    <para>Опциональный проект для <link linkend="section_ccpayments">приема платежей по картам</link>.</para>
    <para><emphasis role="bold">Проект reports</emphasis></para>
    <para>Опциональный проект подсистемы генерации отчетов<footnote>
        <para>Информация о создании отчетов с помощью платформы находится в <productname>Руководстве по созданию отчетов</productname></para>
      </footnote>.</para>
  </section>
  <section id="section_structure_folders_files">
    <title>Структура и назначение каталогов и файлов проекта</title>
    <para>Рассмотрим структуру классов и других файлов в проекте.</para>
    <para>В корне проекта расположены скрипты сборки <filename>build.gradle</filename>, <filename>settings.gradle</filename> и проектные файлы <application>IntelliJ IDEA</application>.</para>
    <para id="text_module_id">В каталоге <filename>modules</filename> расположены подкаталоги <firstterm id="text_modules">модулей</firstterm> проекта − <structname>global</structname>, <structname>core</structname>, <structname>gui</structname>, <structname>web</structname>. Модуль – это элемент проекта, в котором хранится программный код.</para>
    <itemizedlist>
      <listitem>
        <para><structname>global</structname></para>
      </listitem>
      <listitem>
        <para><structname>core</structname></para>
      </listitem>
      <listitem>
        <para><structname>gui</structname></para>
      </listitem>
      <listitem>
        <para><structname>client</structname></para>
      </listitem>
      <listitem>
        <para><structname>web</structname></para>
      </listitem>
      <listitem>
        <para><structname>web-portal</structname></para>
      </listitem>
      <listitem>
        <para><structname>desktop</structname></para>
      </listitem>
    </itemizedlist>
    <para>Модуль <structname>global</structname> определяет компоненты, доступные как <link linkend="section_middleware_id">среднему слою (Middleware)</link>, так и <link linkend="section_client_id">клиентскому коду</link>.</para>
    <itemizedlist>
      <listitem>
        <para>В пакете <package>com.haulmont.shop.core.app</package> создаются интерфейсы <link linkend="section_services_id">сервисов</link> <link linkend="section_middleware_id"> среднего слоя (Middleware)</link>. </para>
      </listitem>
      <listitem>
        <para>В пакете <package>com.haulmont.shop.core.entity</package> создаются классы <glossterm linkend="glossary_entity">сущностей</glossterm> и <glossterm linkend="glossary_localized_folders_id">файлы локализованных сообщений</glossterm>  <filename>messages.properties</filename> для задания названий сущностей и их атрибутов.</para>
      </listitem>
      <listitem>
        <para>В файле <filename>shop-persistence.xml</filename>  регистрируются новые классы сущностей.</para>
      </listitem>
      <listitem>
        <para>В файле <filename>shop-metadata.xml</filename>  может быть задано <link linkend="section_extending_funct">замещение</link> стандартных сущностей новыми.</para>
      </listitem>
    </itemizedlist>
    <figure>
      <title>Структура каталогов и файлов проекта</title>
      <mediaobject>
        <imageobject>
          <imagedata contentwidth="55%" align="center" fileref="img/ch2_structure.png"/>
        </imageobject>
      </mediaobject>
    </figure>
    <para>Модуль <structname>core</structname> определяет компоненты <link linkend="section_middleware_id">среднего слоя (Middleware)</link> системы.</para>
    <itemizedlist>
      <listitem>
        <para>Каталог <filename>db</filename> содержит sql-скрипты создания и <link linkend="section_database_update">изменения</link> базы данных в подкаталогах <filename>init</filename> и <filename>update</filename> соответственно.</para>
      </listitem>
      <listitem>
        <para>В пакете <package>com.haulmont.shop.core.app</package> создаются классы реализации <link linkend="section_services_id">сервисов (Services)</link><link linkend="section_middleware_id"> среднего слоя (Middleware)</link>, а также другие компоненты бизнес-логики приложения.</para>
      </listitem>
      <listitem>
        <para>Файл <filename>shop-app.properties</filename> содержит <glossterm linkend="glossary_conf_parameter_id">конфигурационные параметры</glossterm> среднего слоя:</para>
        <para><parameter>cuba.springContextConfig</parameter> − определяет набор конфигурационных файлов <link linkend="text_spring">Spring</link>-фреймворка;</para>
        <para><parameter>cuba.persistenceConfig</parameter> − определяет набор конфигурационных файлов <link linkend="text_additionally_ORM">ORM</link>;</para>
        <para><parameter>cuba.viewsConfig</parameter> − задает набор конфигурационных файлов <link linkend="section_views_id">представлений</link>;</para>
      </listitem>
      <listitem>
        <para>В файле <filename>shop-spring.xml</filename> при необходимости можно подменить реализацию стандартных сервисов или других управляемых фреймворком <link linkend="text_additionally_spring">Spring</link> компонентов, а также зарегистрировать создаваемые <glossterm linkend="glossary_jmx_id">JMX</glossterm>-компоненты.</para>
      </listitem>
      <listitem>
        <para>Файл <filename>shop-views.xml</filename> содержит описание <link linkend="section_views_id">представлений</link>. Механизм представлений  обеспечивает извлечение из БД и передачу клиенту графов сущностей, ограниченных в глубину и/или по атрибутам.</para>
      </listitem>
      <listitem>
        <para>Файл <filename>web\META-INF\context.xml</filename> содержит настройки подключения к базе данных.</para>
      </listitem>
      <listitem>
        <para>Файл <filename>web\WEB-INF\web.xml</filename> − это дескриптор веб-приложения <link linkend="section_middleware_id">среднего слоя (Middleware)</link>. Среди прочего содержит список <glossterm linkend="glossary_app_properties_id">конфигурационных файлов</glossterm> <filename>*-app.properties</filename>, используемых данным приложением.</para>
      </listitem>
    </itemizedlist>
    <para>Модуль <structname>gui</structname> определяет компоненты <link linkend="section_gui_framework">графического пользовательского интерфейса</link>. Этот модуль доступен всем типам клиентов. Модуль <structname>gui</structname> содержит универсальные экраны: классы <glossterm linkend="glossary_controller_id">контроллеров</glossterm>, <glossterm linkend="glossary_xml_descriptor_id">XML-дескрипторы</glossterm> экранов, файлы <glossterm linkend="glossary_localized_folders_id">локализованных сообщений</glossterm>.</para>
    <itemizedlist>
      <listitem>
        <para>В пакете <package>com.haulmont.shop.gui.ui</package> создаются экраны приложения.</para>
      </listitem>
      <listitem>
        <para>В файле <filename>shop-screens.xml</filename> регистрируются экраны приложения.</para>
      </listitem>
    </itemizedlist>
    <para>Модуль <structname>web</structname> определяет компоненты веб-клиента. Зависит от модулей <structname>gui</structname> и <structname>global</structname>. Содержит специфические экраны и/или <glossterm>компаньоны</glossterm> и файлы конфигурации.</para>
    <itemizedlist>
      <listitem>
        <para>Класс  <classname>com.haulmont.shop.App.java</classname> определяет главное окно приложения.</para>
      </listitem>
      <listitem>
        <para>Файл <filename>shop-web-app.properties</filename> содержит конфигурационные параметры веб-клиента:</para>
        <para><parameter>cuba.windowConfig</parameter> − в этом свойстве указывается набор файлов конфигурации экранов приложения;</para>
        <para><parameter>cuba.menuConfig</parameter> содержит список файлов, описывающих меню приложения;</para>
        <para><parameter>cuba.appConfig.messagesPack</parameter>  задает список имен <glossterm linkend="glossary_localized_folders_id">пакетов сообщений</glossterm>, формирующих <glossterm linkend="glossary_main_localized_folder_id">главный пакет</glossterm>, используемый главным меню и другими общими компонентами системы;</para>
      </listitem>
      <listitem>
        <para>Файл <filename>shop-web-menu.xml</filename> содержит описание пунктов главного меню приложения.</para>
      </listitem>
      <listitem>
        <para>В файле <filename>shop-web-screens.xml</filename> регистрируются экраны приложения.</para>
      </listitem>
    </itemizedlist>
  </section>
  <section>
    <title>Описание основных gradle tasks</title>
    <para>TODO</para>
  </section>
  <section id="section_middleware_id">
    <title>Архитектура среднего слоя</title>
    <para>На следующем рисунке приведены основные компоненты среднего слоя CUBA-приложения.</para>
    <figure>
      <title>Архитектура среднего слоя</title>
      <mediaobject>
        <imageobject>
          <imagedata align="center" fileref="img/Middleware.png"/>
        </imageobject>
      </mediaobject>
    </figure>
    <para>Компоненты сгруппированы по двум <link linkend="text_modules">модулям</link>: <structname>core</structname> и <structname>global</structname>. В <structname>global</structname> расположены компоненты, доступные как коду <link linkend="section_middleware_id">Middleware</link>, так и <link linkend="section_client_id">клиентскому коду</link>. В <structname>core</structname> расположены компоненты ядра <link linkend="section_middleware_id">Middleware</link>.</para>
    <para>Рассмотрим элементы диаграммы более подробно.</para>
    <para><link linkend="section_services_id">Services</link> – управляемые <glossterm linkend="glossary_conteiner_id">контейнером</glossterm> компоненты, формирующие <glossterm linkend="glossary_app_boundary_id">границу приложения</glossterm> и предоставляющие интерфейс клиентам <link linkend="section_middleware_id">Middleware</link>. Сервисы могут содержать бизнес-логику сами, либо делегировать выполнение <link linkend="section_managed_beans_id">Managed Beans</link>.</para>
    <para><link linkend="section_managed_beans_id">Managed Beans</link> – управляемые <glossterm linkend="glossary_conteiner_id">контейнером</glossterm> компоненты, содержащие бизнес-логику приложения. Вызываются <link linkend="section_services_id">сервисами</link>, другими бинами или через опциональный <glossterm linkend="glossary_jmx_id">JMX</glossterm> интерфейс.</para>
    <para>Entity Classes – классы, моделирующие предметную область приложения.  Представляют собой аннотированные <glossterm linkend="glossary_pojo_id">POJO</glossterm>. Аннотации используются для задания соответствий между столбцами таблицы базы данных и полями объектов с помощью <link linkend="text_additionally_JPA">OpenJPA</link>, а также для формирования метаданных в <link linkend="section_metadata_framework">Metadata Framework</link>.</para>
    <para><emphasis role="bold">Persistence</emphasis> −  центральный интерфейс для доступа к функциональности хранения данных. Позволяет получать ссылки на интерфейсы <classname>EntityManager</classname> и <classname>Transaction</classname>.</para>
    <para><emphasis role="bold">Transaction</emphasis> − интерфейс управления <link linkend="section_transaction_id">транзакциями</link> <link linkend="section_middleware_id">Middleware</link>.</para>
    <para><emphasis role="bold">Entity Manager</emphasis> − интерфейс для работы с данными на уровне <link linkend="section_middleware_id">Middleware</link>. Позволяет извлекать <glossterm linkend="glossary_entity">сущности</glossterm> из базы данных по идентификатору и по запросу, а также сохранять и удалять их.</para>
    <para><link linkend="section_metadata_framework">Metadata Framework</link> позволяет создавать описание предметной области в терминах классов, атрибутов и отношений между классами. Метаданные (модель данных) существенно упрощают создание универсальных механизмов работы с данными. Исходной информацией для построения модели являются аннотированные классы сущностей.</para>
    <para><link linkend="section_infrastructure_interfaces_id">Global Infrastructure Interfaces</link> (интерфейсы инфраструктуры) предоставляют доступ к общей часто используемой функциональности. Реализованы в платформе аналогично <link linkend="section_managed_beans_id">Managed Beans</link>.

Все интерфейсы инфраструктуры имеют соответствующие <firstterm>статические фасады</firstterm> − классы со статическими методами, позволяющие иметь доступ к нужной функциональности из статического контекста (при невозможности использовать <link>dependency injection</link>). Статические фасады имеют имена, заканчивающиеся на <classname>*Provider</classname>.</para>
    <para><link linkend="text_additionally_spring">Spring Framework</link> − основа среднего слоя. Используются следующие возможности <link linkend="text_additionally_spring">Spring</link> Framework: </para>
    <itemizedlist>
      <listitem>
        <para>Инверсия управления (IoC container)</para>
      </listitem>
      <listitem>
        <para>Аспектно-ориентированное программирование (AOP)</para>
      </listitem>
      <listitem>
        <para>Управление транзакциями</para>
      </listitem>
      <listitem>
        <para>Remoting − доступ к сервисам среднего слоя по протоколу HTTP</para>
      </listitem>
      <listitem>
        <para>Реализация веб-сервисов и <link>REST API</link></para>
      </listitem>
    </itemizedlist>
    <para><link linkend="text_additionally_JPA">OpenJPA Framework</link> − реализация <link linkend="text_additionally_ORM">ORM</link> по стандарту JPA. Позволяет работать с таблицами базы данных как с объектами Java и создавать запросы на языке <link>JPQL</link>.</para>
    <section id="section_services_id">
      <title>Сервисы</title>
      <para>Сервисы представляют собой слой  компонентов, формирующих <glossterm linkend="glossary_app_boundary_id">границу приложения</glossterm>. Сервисы определяют множество операций, предоставляемых ими для интерфейсных клиентских слоев кода. Сервисы инкапсулируют бизнес-логику приложения, управляют транзакциями и координируют реакции на действия.</para>
      <para>Основные задачи сервисов:</para>
      <itemizedlist>
        <listitem>
          <para>Обеспечить выполнение каждого метода в отдельной <link linkend="section_transaction_id">транзакции</link>. </para>
        </listitem>
        <listitem>
          <para>Обеспечивать запись исключений в журнал.</para>
        </listitem>
        <listitem>
          <para>Обеспечивать <firstterm>отказоустойчивость</firstterm> (failover) в <link linkend="section_cluster_middleware">кластере</link>  для удаленных клиентов.</para>
        </listitem>
        <listitem>
          <para>В бизнес-методах сервисов могут проверяться права пользователя на доступ к данным</para>
        </listitem>
      </itemizedlist>
      <para>Диаграмма классов, входящих в состав сервиса:</para>
      <figure>
        <title>Диаграмма классов, входящих в состав сервиса</title>
        <mediaobject>
          <imageobject>
            <imagedata contentwidth="80%" align="center" fileref="img/MiddlewareServices.png"/>
          </imageobject>
        </mediaobject>
      </figure>
      <para>Каждый вызов сервиса перехватывается с помощью <link linkend="text_additionally_spring">Spring AOP</link>  и обрамляется вызовом <classname>ServiceInterceptor.aroundInvoke()</classname>.</para>
      <para>Подробная информация о создании сервисов содержится в главе <xref xrefstyle="select: labelnumber title" linkend="section_services_realization"/> </para>
    </section>
    <section id="section_managed_beans_id">
      <title>Управляемые бины</title>
      <para><firstterm>Управляемые бины (Managed Beans)</firstterm> − это программные компоненты, реализующие бизнес-логику приложения и создаваемые в соответствии с принципами <link linkend="text_injection_IoC">Inversion of Control</link>. <glossterm linkend="glossary_conteiner_id">Контейнером</glossterm> для бинов служит <link linkend="text_springFramework">Spring Framework.</link></para>
      <para>Managed Bean представляет собой <firstterm>singleton</firstterm>, то есть всегда используется один экземпляр данного класса. Соответственно, если создаваемый Вами бин содержит изменяемые данные в полях (имеет состояние), то необходимо синхронизировать обращение к таким данным.</para>
      <para>В простейшем случае Managed Bean может быть просто Java-классом, аннотированным как <literal>@ManagedBean</literal>. Однако рекомендуется придерживаться  правил создания бинов, содержащихся в главе <xref xrefstyle="select: labelnumber title" linkend="section_managed_beans_realization"/></para>
    </section>
    <section id="section_MBean_id">
      <title>Мбины</title>
      <para><firstterm>МБин</firstterm> − программный компонент, реализующий бизнес-логику, и имеющий <glossterm linkend="glossary_jmx_id">JMX</glossterm>-интерфейс. Как правило, имеет внутреннее состояние (например, кэш, конфигурационные данные или статистику), к которому нужно обеспечить доступ через JMX.</para>
      <para>МБин является расширенным вариантом <link linkend="section_managed_beans_id">управляемого бина</link>.</para>
      <figure>
        <title/>
        <mediaobject>
          <imageobject>
            <imagedata align="center" fileref="img/MBeans.png"/>
          </imageobject>
        </mediaobject>
      </figure>
      <para>Как видно из диаграммы, МБин имеет два набора методов, разделенных по интерфейсам <interfacename>...MBean</interfacename> и <interfacename>...API</interfacename>. Первый из них служит для управления через JMX, а второй − для вызова из программного кода.</para>
      <para>Вызовы JMX-интерфейса МБина перехватываются специальным классом − <glossterm linkend="glossary_interceptor_id">интерцептором</glossterm> <methodname>MBeanInterceptor.aroundInvoke()</methodname> (с помощью <link linkend="text_springAOP">Spring AOP</link>), который обеспечивает журналирование неперехваченных исключений и установку правильного контекстного <classname>ClassLoader</classname>.</para>
      <para>Информация о том, как создать Мбин, содержится в главе <xref xrefstyle="select: labelnumber title" linkend="section_mbeans_realization"/></para>
    </section>
    <section id="section_infrastructure_interfaces_id">
      <title>Интерфейсы инфраструктуры</title>
      <para>Интерфейсы инфраструктуры обеспечивают доступ к часто используемой функциональности платформы. Некоторые из этих интерфейсов расположены в модуле <structname>global</structname> и могут быть использованы как из <link linkend="section_middleware_id">среднего слоя (Middleware)</link>, так и из любого клиентского кода, другие доступны только коду среднего слоя.</para>
      <para>Интерфейсы инфраструктуры реализуются управляемыми компонентами <link linkend="text_springFramework">Spring</link>, поэтому зависимости от интерфейсов могут быть <glossterm linkend="glossary_injection_id">внедрены</glossterm> в любые другие управляемые компоненты (<link linkend="section_managed_beans_id">управляемые бины (Managed Beans)</link>, <link linkend="section_services_id">сервисы среднего слоя (MiddlewareServices)</link>, <glossterm linkend="glossary_controller_id">контроллеры</glossterm> экранов (Screen Controllers)).</para>
      <para>Все интерфейсы инфраструктуры имеют соответствующие &quot;статические фасады&quot;, которые называются <firstterm>провайдерами</firstterm>, и могут быть использованы в неуправляемых компонентах (<glossterm linkend="glossary_pojo_id">POJO</glossterm>, вспомогательных классах и так далее).</para>
      <para><emphasis role="bold">Глобальные интерфейсы инфраструктуры</emphasis></para>
      <simpara><emphasis role="bold">TimeSource</emphasis>. Обеспечивает получение текущего времени. Применение <classname>new Date()</classname> и т.п. запрещено. Статический фасад − <classname>TimeProvider</classname>.</simpara>
      <simpara><emphasis role="bold">UuidSource</emphasis>. Обеспечивает получение значений <classname>UUID</classname>, в том числе для идентификаторов сущностей. Статический фасад − <classname>UuidProvider</classname>.</simpara>
      <simpara><emphasis role="bold">UserSessionSource</emphasis>. Обеспечивает получение объекта сессии текущего пользователя. Статический фасад − <classname>UserSessionProvider</classname>.</simpara>
      <simpara><emphasis role="bold">Security</emphasis>. Содержит методы проверки прав текущего пользователя. Не имеет соответствующего статического фасада. При необходимости в статическом контексте можно получить через <classname>UserSessionProvider</classname> объект пользовательской сессии и вызвать соответствующие методы у него.</simpara>
      <simpara><emphasis role="bold">Metadata</emphasis>. Обеспечивает доступ к сессии <link linkend="section_metadata_framework">метаданных</link> и ViewRepository. Статический фасад − <classname>MetadataProvider</classname>.</simpara>
      <simpara><emphasis role="bold">Messages</emphasis>. Интерфейс <interface>Messages</interface> обеспечивает получение локализованных строк сообщений. Статический фасад − <classname>MessageProvider</classname>.</simpara>
      <simpara><emphasis role="bold">Configuration</emphasis>. Является фасадом к фреймворку работы с конфигурационными параметрами. Статический фасад − <classname>ConfigProvider</classname>.</simpara>
      <simpara><emphasis role="bold">Resources</emphasis>. Обеспечивает загрузку ресурсов из конфигурационного каталога приложения или из <code>classpath</code>, а также по явно указанному URL.</simpara>
      <simpara><emphasis role="bold">Scripting</emphasis>. Интерфейс <interface>Scripting</interface> обеспечивает возможность динамической компиляции и выполнения прикладного кода на Groovy и Java. Статический фасад − <interface>ScriptingProvider</interface>.</simpara>
      <para><emphasis role="bold">Интерфейсы инфраструктуры среднего слоя</emphasis></para>
      <simpara><emphasis role="bold">Persistence</emphasis>. Обеспечивает доступ к интерфейсам <interface>Transaction</interface>, <interface>EntityManager</interface>, и некоторые сервисные функции, относящиеся к хранению данных. Статический фасад − <classname>PersistenceProvider</classname>.</simpara>
      <section id="section_scripting">
        <title>Scripting</title>
        <para><interfacename>Scripting</interfacename> − глобальный интерфейс инфраструктуры, решающий следующие задачи:</para>
        <itemizedlist>
          <listitem>
            <para>Выполнение выражений и скриптов Groovy</para>
          </listitem>
          <listitem>
            <para>Компиляция и загрузка классов Groovy</para>
          </listitem>
          <listitem>
            <para>Компиляция и загрузка классов Java, поставляемых в исходниках в каталоге конфигурации приложения conf</para>
          </listitem>
          <listitem>
            <para>Загрузка ресурсов из каталога конфигурации приложения conf или из classpath.</para>
          </listitem>
        </itemizedlist>
        <para>Общий принцип действия таков: если запрашиваемый класс или ресурс имеется в каталоге conf, будет использован он, в противном случае будет произведен поиск по данному пути в classpath. Это дает возможность в production или в процессе разработки динамически подменять и дополнять приложение нужными классами и ресурсами.</para>
        <para><emphasis role="bold">Выполнение выражений (evaluate)</emphasis></para>
        <para><emphasis role="bold">Выполнение скриптов</emphasis><itemizedlist>
            <listitem>
              <para>При инициализации приложения могут быть заданы классы для импорта, автоматически добавляемые всем выражениям.</para>
            </listitem>
            <listitem>
              <para>Скомпилированные выражения сохраняются в кэше, что значительно ускоряет повторное выполнение.</para>
            </listitem>
          </itemizedlist></para>
        <para>Запуск скриптов выполняется методом runGroovyScript(). Имя скрипта должно содержать путь с корнем в conf (каталог конфигурации приложения).</para>
      </section>
    </section>
    <section id="section_orm">
      <title>ORM</title>
      <para>ORM (англ. <firstterm>Object-relational mapping</firstterm>, рус. <firstterm>Объектно-реляционное отображение</firstterm>) − технология программирования, которая связывает базы данных с концепциями объектно-ориентированных языков программирования, создавая «виртуальную объектную базу данных» (<ulink url="http://ru.wikipedia.org/wiki/ORM">http://ru.wikipedia.org/wiki/ORM</ulink>). </para>
      <variablelist>
        <varlistentry>
          <term>Преимущества</term>
          <listitem>
            <itemizedlist>
              <listitem>
                <para>Позволяет работать с  данными реляционной СУБД, манипулируя простыми объектами Java (<glossterm linkend="glossary_pojo_id">POJO</glossterm>)</para>
              </listitem>
              <listitem>
                <para>Упрощает программирование, избавляя от рутины написания тривиальных SQL-запросов</para>
              </listitem>
              <listitem>
                <para>Упрощает программирование, позволяя извлекать и сохранять целые графы объектов одной командой</para>
              </listitem>
              <listitem>
                <para>Обеспечивает легкое портирование приложения на различные СУБД</para>
              </listitem>
              <listitem>
                <para>Использует лаконичный язык запросов <glossterm linkend="glossary_jpql">JPQL</glossterm></para>
              </listitem>
              <listitem>
                <para>Оптимизирует количество выполняемых SQL-запросов на команды insert и update</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Недостатки</term>
          <listitem>
            <itemizedlist>
              <listitem>
                <para>Требует понимания особенностей работы с ORM</para>
              </listitem>
              <listitem>
                <para>Не позволяет напрямую оптимизировать SQL или использовать особенности СУБД, что приводит к снижению производительности</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Реализация</term>
          <listitem>
            <itemizedlist>
              <listitem>
                <para>JPA – Java Persistence API</para>
              </listitem>
              <listitem>
                <para><link linkend="text_openJPA">OpenJPA</link> – фреймворк, реализующий JPA.  На данный момент в платформе используется версия 2.x.</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </varlistentry>
      </variablelist>
      <variablelist>
        <title>ORM – основные понятия</title>
        <varlistentry>
          <term>Entity</term>
          <listitem>
            <para><glossterm linkend="glossary_annotation">Аннотированный</glossterm> <glossterm linkend="glossary_pojo_id">POJO</glossterm>. Обычно соответствует таблице СУБД.</para>
          </listitem>
        </varlistentry>
        <varlistentry id="text_entityManager">
          <term>EntityManager</term>
          <listitem>
            <para>Интерфейс для управления <glossterm linkend="glossary_entity">сущностями</glossterm>.
Его можно получить с помощью   вызова метода  <classname>PersistenceProvider.getEntityManager()</classname>.
Экземпляр <classname>EntityManager</classname> всегда привязан к одной <link linkend="section_transaction_id">транзакции</link>. Более того, все вызовы <classname>PersistenceProvider.getEntityManager()</classname> в рамках одной транзакции возвращают один и тот же экземпляр <classname>EntityManager</classname>. После завершения транзакции обращения к данному экземпляру невозможны.
Экземпляр <classname>EntityManager</classname> содержит в себе &quot;персистентный контекст&quot; – набор экземпляров сущностей, загруженных из БД или только что созданных. Персистентный контекст является кэшем данных в рамках данной транзакции.
<classname>EntityManager</classname> автоматически сбрасывает в БД все изменения, сделанные в своем персистентном контексте, в момент коммита транзакции, либо явным вызовом метода  <classname>flush()</classname>.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Enhancing</term>
          <listitem>
            <para>Модификация байт-кода классов сущностей для обеспечения возможности работы ORM.
Производится в момент сборки проекта.</para>
          </listitem>
        </varlistentry>
      </variablelist>
      <variablelist>
        <title>ORM – жизненный цикл сущности</title>
        <varlistentry>
          <term>New</term>
          <listitem>
            <para>Только что созданный экземпляр, например: <classname>Car car = new Car()</classname>;
может быть передан в <methodname>EntityManager.persist()</methodname> для сохранения в БД. При этом переходит в состояние <firstterm>Managed</firstterm></para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Managed</term>
          <listitem>
            <para>Загруженный из БД или новый, переданный в <methodname>EntityManager.persist()</methodname>, экземпляр;
принадлежит некоторому экземпляру <classname>EntityManager</classname>, другими словами, находится в его персистентном контексте;
любые изменения  экземпляра в состоянии <firstterm>Managed</firstterm> будут сохранены в БД в случае коммита транзакции, к которой принадлежит данный <classname>EntityManager</classname></para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Detached</term>
          <listitem>
            <para>Экземпляр, загруженный из БД и отсоединенный от своего персистентного контекста (вследствие закрытия транзакции или сериализации);
изменения, вносимые в <firstterm>Detached</firstterm> экземпляр, запоминаются в самом этом экземпляре (с помощью полей, добавленных с помощью Enhancing);
изменения в <firstterm>Detached</firstterm> экземпляре будут сохранены в БД, только если он будет снова переведен в состояние <firstterm>Managed</firstterm> путем передачи в метод <methodname>EntityManager.merge()</methodname>; <methodname>EntityManager.merge()</methodname> выполняет следующее – загружает из БД экземпляр с тем же идентификатором, переносит в него состояние переданного <firstterm>Detached</firstterm> экземпляра и возвращает загруженный <firstterm>Managed</firstterm> экземпляр. Далее надо работать именно с возвращенным <firstterm>Managed</firstterm> экземпляром!</para>
          </listitem>
        </varlistentry>
      </variablelist>
      <itemizedlist>
        <title>ORM – загрузка по требованию</title>
        <listitem>
          <para>Позволяет загружать связанные сущности по требованию, т.е. только в момент первого обращения к их свойствам</para>
        </listitem>
        <listitem>
          <para>Работает только для экземпляра в состоянии <firstterm>Managed</firstterm>, то есть внутри транзакции, загрузившей данный экземпляр</para>
        </listitem>
        <listitem>
          <para>Загрузка по требованию (lazy loading)  в сумме порождает больше запросов к БД, чем <glossterm linkend="glossary_eagerFetching">энергичная загрузка (Eager Fetching)</glossterm>, однако нагрузка при этом растянута во времени</para>
          <itemizedlist>
            <listitem>
              <para>Например, при извлечении списка N экземпляров сущности A, содержащих ссылку на экземпляр сущности B, в случае загрузки по требованию будет выполнено N+1 запросов к БД.</para>
            </listitem>
            <listitem>
              <para>Для минимизации времени отклика и снижения нагрузки необходимо стремиться к меньшему количеству обращений к БД. Для этого  в платформе  используется механизм <glossterm linkend="glossary_view_ru_id">представлений</glossterm>, с помощью которого в вышеописанном случае ORM сформирует один  запрос к БД с объединением таблиц.</para>
            </listitem>
            <listitem>
              <para>Если A содержит коллекцию B, в случае энергичной загрузки  ORM сформирует SQL запрос, возвращающий произведение строк A и B. </para>
            </listitem>
            <listitem>
              <para>Иногда загрузка по требованию с точки зрения производительности предпочтительнее, чем энергичная загрузка. Например, когда работает асинхронный процесс, выполняющий некоторую бизнес-логику, общее время выполнения некритично и желательно распределить во времени  нагрузку на БД.</para>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>
    </section>
    <section id="section_metadata_framework">
      <title>Metadata Framework</title>
      <para>Metadata Framework позволяет создавать описание предметной области в терминах метаданных.</para>
      <figure>
        <title>Структура метаданных</title>
        <mediaobject>
          <imageobject>
            <imagedata align="center" fileref="img/Metadata Framework.png"/>
          </imageobject>
        </mediaobject>
      </figure>
      <itemizedlist>
        <title>Назначение метаданных</title>
        <listitem>
          <para>Предоставляют удобный интерфейс для получения информации о <glossterm linkend="glossary_entity">сущностях</glossterm>, атрибутах и отношениях между сущностями; для навигации по ссылкам</para>
        </listitem>
        <listitem>
          <para>Служат более удобной в использовании и более функциональной альтернативой <application>Java Reflection</application></para>
        </listitem>
        <listitem>
          <para>Регламентируют допустимые типы данных и отношений между сущностями</para>
        </listitem>
        <listitem>
          <para>Позволяют создавать универсальные механизмы работы с данными</para>
        </listitem>
      </itemizedlist>
      <para>Основными объектами метаданных являются <classname>MetaClass</classname> и <classname>MetaProperty</classname>.</para>
      <variablelist>
        <varlistentry>
          <term>MetaClass</term>
          <listitem>
            <para><classname>MetaClass</classname> описывает класс сущности. Он имеет уникальное имя и методы для получения списка атрибутов, а также классов предков и наследников.</para>
            <para><classname>MetaClass</classname> всегда ассоциирован с Java-классом, которого он представляет.</para>
            <itemizedlist>
              <listitem>
                <para><property>name</property> – имя, по соглашению первой частью имени до знака <code>$</code> является <code>namespace</code>, например, <classname>sec$User</classname></para>
              </listitem>
              <listitem>
                <para><property>properties</property> – список объектов <classname>MetaProperty</classname>, описывающих атрибуты объекта</para>
              </listitem>
              <listitem>
                <para><property>javaClass</property> – класс сущности, которой соответствует данный <classname>MetaClass</classname></para>
              </listitem>
              <listitem>
                <para><property>annotations</property> – коллекция аннотаций. <glossterm linkend="glossary_annotation">Аннотация</glossterm> представляет собой произвольный именованный объект, который добавляется в <classname>MetaClass</classname> на этапе развертывания метаданных. Например, с помощью аннотаций в метаданных хранится длина строковых полей.</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>MetaProperty</term>
          <listitem>
            <para><classname>MetaProperty</classname> описывает атрибут сущности. Атрибут принадлежит мета-классу, который может быть получен методом <methodname>getDomain()</methodname>.</para>
            <para>Атрибут может быть следующих типов (метод <methodname>getType()</methodname>):</para>
            <itemizedlist>
              <listitem>
                <para>простой тип: <type>DATATYPE</type></para>
              </listitem>
              <listitem>
                <para>перечисление: <type>ENUM</type></para>
              </listitem>
              <listitem>
                <para>ссылочный тип двух видов:</para>
                <itemizedlist>
                  <listitem>
                    <para><type>ASSOCIATION</type> − простая ссылка на другой объект. Например, отношение инвойса и контрагента − ассоциация.</para>
                  </listitem>
                  <listitem>
                    <para><type>AGGREGATION</type> − ссылка на объект, который не имеет самостоятельного значения. <type>AGGREGATION</type> можно считать &quot;более тесным&quot; отношением, чем <type>ASSOCIATION</type>. Например, отношение инвойса и строки спецификации этого инвойса − <type>AGGREGATION</type>, т.к. строка спецификации не имеет смысла без самого инвойса.</para>
                  </listitem>
                </itemizedlist>
              </listitem>
            </itemizedlist>
            <para>Вид ссылочного атрибута <type>ASSOCIATION</type> или <type>AGGREGATION</type> влияет на режим редактирования сущности: в первом случае коммит связанной сущности происходит независимо, а во втором − связанная сущность коммитится в БД только вместе с основной сущностью.</para>
            <itemizedlist>
              <listitem>
                <para>name – имя свойства, соответствует имени атрибута сущности</para>
              </listitem>
              <listitem>
                <para>domain – MetaClass, которому принадлежит данное свойство</para>
              </listitem>
              <listitem>
                <para>type – тип свойства: DATATYPE, ENUM, ASSOCIATION, AGGREGATION</para>
              </listitem>
              <listitem>
                <para>range – интерфейс к свойствам MetaProperty</para>
              </listitem>
              <listitem>
                <para>mandatory – true если атрибут сущности должен быть не null</para>
              </listitem>
              <listitem>
                <para>readOnly – true если атрибут нельзя изменять</para>
              </listitem>
              <listitem>
                <para>inverse – ссылка на обратную сторону ассоциации между сущностями</para>
              </listitem>
              <listitem>
                <para>annotatedElement – Field или Method, соответствующие данному атрибуту сущности</para>
              </listitem>
              <listitem>
                <para>javaType – java-класс атрибута сущности</para>
              </listitem>
              <listitem>
                <para>declaringClass – java-класс, декларирующий данный атрибут (содержащий данный annotatedElement)</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>Range</term>
          <listitem>
            <itemizedlist>
              <listitem>
                <para>isDatatype – true если MetaProperty.type == DATATYPE</para>
              </listitem>
              <listitem>
                <para>isEnum – true если MetaProperty.type == DATATYPE</para>
              </listitem>
              <listitem>
                <para>isClass – true если MetaProperty.type == ASSOCIATION or AGGREGATION</para>
              </listitem>
              <listitem>
                <para>ordered – true если свойство представляет собой упорядоченную коллекцию (List)</para>
              </listitem>
              <listitem>
                <para>cardinality – вид отношения, если свойство isClass: ONE_TO_ONE, MANY_TO_ONE, ONE_TO_MANY, MANY_TO_MANY</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>
    <section id="section_views_id">
      <title>Представления</title>
      <para>Механизм представлений обеспечивает извлечение из БД и передачу клиенту графов сущностей, ограниченных в глубину и/или по атрибутам.</para>
      <para>Представление всегда должно быть задано при запросе данных у <glossterm linkend="glossary_middleware_id">middleware</glossterm>. Получив выборку данных по представлению, клиентский код может быть уверен, что все запрошенные атрибуты и связанные сущности получены, и их можно использовать без опаски получить <errorname role="italic">NullPointerException</errorname> или исключение типа <errorname role="italic">LazyInitializationException</errorname>. Представление решает и обратную задачу − ненужные атрибуты не извлекаются из БД, что снижает нагрузку в случае &quot;широких&quot; сущностей (содержащих большое число атрибутов).</para>
      <para>Для каждой сущности по умолчанию доступны два типа представления с именами <filename>_local</filename> и <filename>_minimal</filename></para>
      <itemizedlist>
        <listitem>
          <para><filename>_local</filename> определяет все локальные атрибуты сущности (т.е. все, кроме ссылок на другие сущности);</para>
        </listitem>
        <listitem>
          <para><filename>_minimal</filename> определяет атрибуты, входящие в <varname>InstanceName</varname>. Если <varname>InstanceName</varname> не задано, данное представление определяет только системные атрибуты (<varname>id</varname>, <varname>createTs</varname> и пр.).</para>
        </listitem>
      </itemizedlist>
      <para>Представления нужно определять в файле <filename>ext-views.xml</filename> модуля <structname>core</structname>.</para>
      <warning>
        <title>Внимание</title>
        <para>Имя представления должно быть уникально в пределах сущности. При этом рекомендуется давать более  &quot;описательные&quot; имена. Например, не &quot;browse&quot;, а &quot;nameOfEntityBrowse&quot;. Это упрощает поиск XML-описателей представлений по имени. </para>
      </warning>
      <para>Пример представления для сущности <classname>User</classname>, которое должно выбирать все простые поля и ссылку на группу:</para>
      <programlisting>&lt;view entity=&quot;sec$User&quot; name=&quot;user.browse&quot; extends=&quot;_local&quot;&gt;
     &lt;property name=&quot;group&quot; view=&quot;_local&quot;/&gt;
&lt;/view&gt;</programlisting>
    </section>
    <section id="section_transaction_id">
      <title>Транзакции</title>
      <para>Транзакция Middleware напрямую отображается на транзакцию БД.</para>
      <para>Управление транзакциями производится только  на уровне сервисов или ниже.
</para>
      <para>Любой клиент, вызывая методы сервиса, должен понимать, что каждый метод будет выполняться в отдельной транзакции.
Используется только ручное (не декларативное) управление транзакциями.</para>
      <para>Управление транзакциями является частью бизнес-логики.
При использовании ORM изменения в БД производятся при коммите транзакции, который в случае декларативного управления происходит за рамками прикладного кода (в интерцепторах контейнера), что крайне неудобно при отладке приложения.</para>
      <para>При использовании ORM доменные объекты ведут себя принципиально по-разному внутри и вне транзакции</para>
      <para>Рекомендации по управлению транзакциями содержатся в главе <xref xrefstyle="select: labelnumber title" linkend="section_transactions_realization"/></para>
    </section>
    <section id="section_cluster_middleware">
      <title id="section_cluster_middleware">Кластер среднего слоя</title>
      <para>TODO</para>
      <section>
        <title>Совместимость кластера</title>
      </section>
    </section>
  </section>
  <section id="section_client_id">
    <title>Архитектура клиента</title>
    <figure>
      <title/>
      <mediaobject>
        <imageobject>
          <imagedata align="center" fileref="img/ClientStructure.png"/>
        </imageobject>
      </mediaobject>
    </figure>
    <para>TODO</para>
  </section>
  <section>
    <title>Свойства приложения</title>
    <para wordsize="20"><emphasis role="bold">Основные понятия</emphasis></para>
    <para>Свойства приложения − именованные данные различных типов, определяющие всевозможные аспекты конфигурации и функционирования приложения.</para>
    <para>По назначению свойства приложения можно классифицировать следующим образом:</para>
    <itemizedlist>
      <listitem>
        <para>Конфигурационные параметры: определяют наборы конфигурационных файлов и некоторые параметры пользовательского интерфейса. Например: <parameter>cuba.springContextConfig</parameter>, <parameter>cuba.web.useLightHeader</parameter>.</para>
      </listitem>
      <listitem>
        <para>Параметры развертывания: различные URL для соединения <glossterm linkend="glossary_app_tiers">уровней</glossterm> приложения, тип используемой БД, настройки подсистемы безопасности и т.д. Например: <parameter>cuba.connectionUrl</parameter>, <parameter>cuba.dbmsType,</parameter> <parameter>cuba.userSessionExpirationTimeoutSec</parameter>.</para>
      </listitem>
      <listitem>
        <para>Параметры времени выполнения: активность аудита, параметры отсылки email и т.д. Например, <parameter>cuba.security.EntityLog.enabled</parameter>, <parameter>cuba.email.smtpHost</parameter>.</para>
      </listitem>
    </itemizedlist>
    <para><emphasis role="bold">Работа со свойствами приложения</emphasis></para>
    <formalpara>
      <title>Программный доступ к свойствам</title>
      <para>Основной способ доступа к свойствам приложения из программного кода − использование Java-интерфейсов механизма <glossterm linkend="glossary_conf_parameter_id">Configuration Parameters</glossterm>. Кроме того, все свойства конфигурации и развертывания доступны через методы класса <classname>com.haulmont.cuba.core.sys.AppContext</classname>.</para>
    </formalpara>
    <formalpara>
      <title>Принадлежность уровням</title>
      <para>Как правило, некоторое свойство принадлежит только одному или нескольким <glossterm linkend="glossary_app_tiers">уровням приложения</glossterm>. Например, <parameter>cuba.persistenceConfig</parameter> имеет смысл только для <glossterm linkend="text_middleware_id">Middleware</glossterm>,  <parameter>cuba.web.useLightHeader</parameter> − только для <glossterm linkend="glossary_app_tiers">Web Client</glossterm>, а <parameter>cuba.springContextConfig </parameter>− для всех уровней. </para>
      <para>Принадлежность к уровню означает, что если Вы хотите задать значение некоторому свойству, это необходимо сделать на всех уровнях, которым данное свойство принадлежит (смотрите <link linkend="glossary_saving_properties">Хранение значений свойств</link>).</para>
      <para>Принадлежность можно выяснить следующими способами:<itemizedlist>
          <listitem>
            <para>Из документации</para>
          </listitem>
          <listitem>
            <para>Проследив использование свойства в коде приложения</para>
          </listitem>
          <listitem>
            <para>Если к свойству есть доступ через Java-интерфейс, то по принадлежности интерфейса модулю проекта. Ниже приведено соответствие модуля объявления интерфейса и принадлежности свойства <glossterm linkend="glossary_app_tiers">уровням приложения</glossterm>:</para>
            <itemizedlist>
              <listitem>
                <para><structname>global</structname> − свойство принадлежит всем <glossterm linkend="glossary_app_tiers">уровням</glossterm></para>
              </listitem>
              <listitem>
                <para><structname>core</structname> − <glossterm>Middleware</glossterm></para>
              </listitem>
              <listitem>
                <para><structname>client</structname> − <glossterm linkend="text_webclient_id">Web Client</glossterm>, <glossterm linkend="text_portal_id">Web Portal</glossterm>, <glossterm linkend="text_desktop_id">Desktop Client</glossterm></para>
              </listitem>
              <listitem>
                <para><structname>web</structname> − <glossterm linkend="text_webclient_id">Web Client</glossterm></para>
              </listitem>
              <listitem>
                <para><structname>web-portal</structname> − <glossterm linkend="text_portal_id">Web Portal</glossterm></para>
              </listitem>
              <listitem>
                <para><structname>desktop</structname> − <glossterm linkend="text_desktop_id">Desktop Client</glossterm></para>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist></para>
    </formalpara>
    <formalpara>
      <title>JMX-интерфейс</title>
      <para>Некоторые <glossterm linkend="glossary_app_tiers">уровни приложения</glossterm> определяют JMX-интерфейсы для доступа к свойствам приложения. В частности, на уровне <glossterm linkend="text_middleware_id">Middleware</glossterm> имеется JMX-интерфейс <classname>ConfigStorageMBean</classname> с именем <classname>app-core.cuba:service=ConfigStorage</classname>, а на уровне <glossterm linkend="text_webclient_id">Web Client</glossterm> − <classname>ConfigurationMBean</classname> с именем <classname>app.cuba:service=Configuration</classname>. Методы этих интерфейсов работают по отдельности со свойствами конфигурации и развертывания (<parameter>*AppProperties</parameter>) и со свойствами времени выполнения (<parameter>*DbProperties</parameter>). Это обусловлено различием механизмов <link linkend="glossary_saving_properties">хранения</link> этих категорий свойств.</para>
    </formalpara>
    <para id="glossary_saving_properties_1"><emphasis role="bold">Хранение значений свойств</emphasis></para>
    <formalpara id="text_properties_files_1">
      <title>Файлы свойств</title>
      <para>Свойства, определяющие конфигурацию и параметры развертывания, задаются в специальных файлах свойств, имеющих имя вида <filename>*-app.properties</filename>. Каждый <glossterm linkend="glossary_app_tiers">уровень приложения</glossterm> имеет набор таких файлов, включающий в себя файлы из базовых проектов платформы и файл текущего приложения. Набор файлов свойств различен для разных уровней приложения и определяется следующим образом:</para>
    </formalpara>
    <itemizedlist>
      <listitem>
        <para>Для уровней, являющихся веб-приложениями (<glossterm linkend="text_middleware_id">Middleware</glossterm>, <glossterm linkend="text_webclient_id">Web Client</glossterm>, <glossterm linkend="text_portal_id">Web Portal</glossterm>) набор файлов свойств задается в <filename>web.xml</filename> в параметре <parameter>appPropertiesConfig</parameter>.</para>
      </listitem>
      <listitem>
        <para>Для уровня <glossterm linkend="text_desktop_id">Desktop Client</glossterm> основной способ задания набора файлов свойств − переопределение в приложении метода <methodname>getDefaultAppPropertiesConfig</methodname> в классе-наследнике <classname>com.haulmont.cuba.desktop.App</classname>.</para>
      </listitem>
    </itemizedlist>
    <para>Например, набор файлов свойств уровня <glossterm linkend="text_middleware_id">Middleware</glossterm> проекта <application>shop</application> − <filename>web.xml</filename> − выглядит следующим образом:</para>
    <programlisting>classpath:cuba-app.properties
classpath:shop-app.properties
file:${catalina.home}/conf/app-core/local.app.properties</programlisting>
    <para>Здесь префикс <classname>classpath:</classname> означает, что данный файл нужно искать в Java classpath, префикс <classname>file:</classname> − в файловой системе. Возможно использование системных свойств Java, в данном случае это <classname>catalina.home</classname> − путь к корню <application>Tomcat</application>.</para>
    <para>Порядок перечисления файлов важен, так как значения, указанные в каждом последующем файле заменяют значения одноименных свойств, заданные в предыдущих файлах. Этим достигается переопределение свойств платформы в конкретном приложении.</para>
    <para id="glossary_local_properties_1">Последний файл в приведенном наборе − <filename>local.app.properties</filename>. Подробнее об этом файле можно узнать в определении <link linkend="glossary_local_properties">Local Application Properties</link>.</para>
    <para id="glossary_local_properties_2"><emphasis role="bold">Синтаксис</emphasis></para>
    <para><warning>
        <para>Обратите внимание на синтаксис ключей и значений в *.properties файлах.</para>
        <itemizedlist>
          <listitem>
            <para>Ключ состоит из латинских букв и цифр, разделенных точкой</para>
          </listitem>
          <listitem>
            <para>Значение пишется после знака равно (=)</para>
          </listitem>
          <listitem>
            <para>Значение <emphasis role="bold">никогда</emphasis> не берется к кавычки &quot;&quot; или &apos;&apos;</para>
          </listitem>
          <listitem>
            <para>Файловые пути записываются либо в UNIX виде (/opt/haulmont/), либо в Windows виде (c:\\haulmont\\)</para>
          </listitem>
          <listitem>
            <para>Для различных спецсимволов используются коды (\n \t \r). \  является зарезервированным символом, для вставки в значение экранируется сам собой (\\).
Подробнее: <ulink url="http://docs.oracle.com/javase/tutorial/java/data/characters.html">http://docs.oracle.com/javase/tutorial/java/data/characters.html</ulink></para>
          </listitem>
          <listitem>
            <para>В значениях могут присутствовать спецсимволы (пробелы, табуляции).     Внимательно проверяйте значения, скопированные в файл из других программ</para>
          </listitem>
        </itemizedlist>
      </warning></para>
    <formalpara>
      <title>Таблица базы данных</title>
      <para>Параметры времени выполнения хранятся в БД в таблице <database>SYS_CONFIG</database>. Хранящиеся в БД свойства кэшируются на уровне <glossterm linkend="text_middleware_id">Middleware</glossterm>. Очистить кэш можно через JMX-интерфейсы <classname>app-core.cuba:service=ConfigStorage</classname> методом <methodname>clearCache</methodname> или <classname>app-core.cuba:service=CachingFacade</classname> методом <methodname>clearConfigStorageCache</methodname>.</para>
    </formalpara>
    <para><emphasis role="bold">Значения по умолчанию</emphasis></para>
    <para>Если обращение к свойству производится через Java-интерфейс механизма <glossterm linkend="glossary_conf_parameter_id">Configuration Parameters</glossterm> и если значение свойства не задано в месте его хранения (файлы <filename>*-app.properties</filename> или БД), то будет возвращено значение по умолчанию, если оно задано в аннотации соответствующего метода Java-интерфейса.</para>
    <para>Подробное описание свойств подсистемы безопасности содержится в <link linkend="appendix_security_properties">Приложении А</link>.</para>
  </section>
  <section id="section_gui_framework">
    <title>Графический интерфейс пользователя</title>
    <section>
      <title>Библиотека визуальных компонентов</title>
      <para><link linkend="section_gui_components">Компоненты</link></para>
      <para><link linkend="section_gui_layouts">Контейнеры</link></para>
      <section id="section_gui_components">
        <title>Компоненты</title>
        <figure>
          <title>Диаграмма компонентов</title>
          <mediaobject>
            <imageobject>
              <imagedata align="center" fileref="img/Components_new.png"/>
            </imageobject>
          </mediaobject>
        </figure>
        <para><classname>Component</classname> − предок всех визуальных компонентов. Он содержит базовые атрибуты, позволяющие идентифицировать компонент и располагать его на экране.</para>
        <informaltable frame="topbot" pgwide="0">
          <tgroup cols="2" colsep="1">
            <colspec colnum="1" colname="c0" colwidth="1*"/>
            <colspec colnum="2" colname="c1" colwidth="3*"/>
            <tbody>
              <row>
                <entry>
                  <link linkend="section_button">Button</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/Button.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry align="justify">
                  <link linkend="section_popupButton">PopupButton</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/PopupButton.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_linkButton">LinkButton</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/LinkButton.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_label">Label</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/gui_label.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_textField">TextField</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/gui_textField.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_gui_textArea">TextArea</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/gui_textArea.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_dateField">DateField</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/gui_dateField.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_timeField">TimeField</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/gui_timeField1.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_checkBox">CheckBox</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/CheckBox.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_pickerField">PickerField</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/PickerField.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_gui_optionsGroup">OptionsGroup</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/OptionsGroup.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_lookupField">LookupField</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/LookupField.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_lookupPickerField">LookupPickerField</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/LookupPickerField.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_twinColumn">TwinColumn</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/TwinColumn.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_upload">FileUploadField</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/Upload.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_gui_table">Table</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/gui_table.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_gui_treetable">TreeTable</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/gui_treeTable.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_gui_groupTable">GroupTable</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/GroupTable.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_gui_tree">Tree</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/Tree.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_gui_fieldGroup">FieldGroup</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/gui_fieldGroup.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
              <row>
                <entry>
                  <link linkend="section_gui_tokenList">TokenList</link>
                </entry>
                <entry>
                  <mediaobject>
                    <imageobject>
                      <imagedata fileref="img/gui_tokenList.png"/>
                    </imageobject>
                  </mediaobject>
                </entry>
              </row>
            </tbody>
          </tgroup>
        </informaltable>
        <section id="section_label">
          <title>Label</title>
          <para>Надпись (<classname>Label</classname>) − текстовый компонент, отображающий  статический текст либо значение атрибута <glossterm linkend="glossary_entity">сущности</glossterm>.</para>
          <para>XML-имя компонента: <classname>label</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_label_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса компонента <classname>Label</classname>: для веб-приложений  и для десктоп-приложений. </para>
          <figure>
            <title>Типы надписей</title>
            <mediaobject>
              <imageobject>
                <imagedata contentwidth="40%" align="center" fileref="img/gui_labelTypes.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Для того чтобы создать компонент надписи, создайте в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> следующий код:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/label/label.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибут <property id="attr_value">value</property> предназначен для отображения текста надписи. Обычно значение атрибута задается с помощью ключа <glossterm linkend="glossary_localized_folders_id">пакета сообщений</glossterm>.</para>
          <para>Текст, содержащийся в атрибуте <property>value</property>, будет перенесен на следующую строку, если по длине он превысит значение атрибута <link linkend="attr_width">width</link>. Поэтому если Вам нужно использовать многострочную надпись, укажите требуемое значение атрибута <link linkend="attr_width">width</link> (применимо только для веб-приложений). Если текст надписи слишком длинный, и значение атрибута <link linkend="attr_width">width</link> неопределено, то текст будет урезан.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata contentwidth="30%" align="center" fileref="img/gui_label_truncated.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>В компоненте надписи есть возможность отображать значение атрибута сущности. Для этого используются атрибуты <link linkend="attr_datasource">datasource</link> и <link linkend="attr_property">property</link>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/label/labelWithDatasource.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибуты <classname>label</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row>
                  <entry align="left">
                    <link linkend="attr_align">align</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_property">property</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_value">value</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>label</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry align="left">
                    <link linkend="element_formatter">formatter</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_button">
          <title>Button</title>
          <para>Кнопка (<classname>Button</classname>) −  компонент,  обеспечивающий  выполнение некоторых действий при нажатии на нее пользователем.</para>
          <para>XML-имя компонента: <classname>button</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_Button_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Классы кнопок существуют как для веб-приложений, так и для десктоп-приложений.</para>
          <para>Кнопка может содержать  текст или пиктограмму (или и то и другое). На рисунке ниже отражены разные виды кнопок.</para>
          <figure>
            <title>Типы кнопок</title>
            <mediaobject>
              <imageobject>
                <imagedata contentwidth="50%" align="center" fileref="img/gui_buttonTypes.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Для создания кнопки с текстом достаточно написать в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> следующий код: </para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/button/textButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Для создания кнопки с пиктограммой:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/button/iconButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибут <link linkend="attr_icon">icon</link> указывает на местоположение пиктограммы. Подробную информацию о том, где следует располагать файлы пиктограмм, Вы можете прочитать в <xref linkend="section_gui_themes_creation"/></para>
          <para>Для создания кнопки с пользовательским стилем необходимо указать атрибут <property>stylename</property>, а также задать стиль компонента в файле CSS.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/button/userButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Определение стиля:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/button/cssButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Подробную информацию о том, как создавать пользовательский стиль, Вы можете прочитать в <xref linkend="section_gui_themes_creation"/></para>
          <para>Основная функция кнопки −  выполнить некоторое действие при нажатии на нее. Определить метод <glossterm linkend="glossary_controller_id">контроллера</glossterm>, который будет вызываться при нажатии на кнопку, можно с помощью атрибута <property id="attr_invoke">invoke</property>. Значением атрубута должно быть    имя  метода контроллера, вызываемого в ответ на событие нажатия кнопки. Метод должен:</para>
          <itemizedlist>
            <listitem>
              <para>Быть <classname>public</classname></para>
            </listitem>
            <listitem>
              <para>Возвращать <classname>void</classname></para>
            </listitem>
            <listitem>
              <para>Не иметь аргументов или иметь один аргумент типа <classname>Component</classname>. Если метод имеет аргумент <classname>Component</classname>, то при вызове в него будет передан экземпляр вызвавшей кнопки.</para>
            </listitem>
          </itemizedlist>
          <para>В качестве примера показано описание кнопки, вызывающей метод <methodname>lockButton:</methodname></para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/button/invokeButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>В <glossterm linkend="glossary_controller_id">контроллере</glossterm> экрана необходимо определить метод <methodname>lockButton</methodname>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/button/methodButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибут <property>invoke</property> игнорируется, если для кнопки задан атрибут <property>action</property>. Атрибут <property id="attr_action">action</property> содержит имя <link linkend="section_gui_action">Action</link>, соответствующего данной кнопке.</para>
          <para>Пример кнопки с атрибутом <property>action</property>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/button/actionButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para><link linkend="section_gui_action">Action</link> для кнопки можно создавать программно, в <glossterm linkend="glossary_controller_id">контроллере</glossterm> экрана.</para>
          <para>В качестве примера создадим кнопку, имеющую в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> только атрибут <link linkend="attr_id">id</link>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/button/withoutActionButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>В контроллере  в методе <methodname>init()</methodname> экрана определим действие и название для кнопки.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/button/withoutActionButtonContr.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибуты <classname>button</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row>
                  <entry align="left">
                    <link linkend="attr_action">action</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_align">align</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_icon">icon</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_invoke">invoke</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_popupButton">
          <title>PopupButton</title>
          <para>Кнопка с выпадающим списком действий.</para>
          <para>XML-имя компонента: <classname>popupButton</classname>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_popupButton_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса кнопок: для веб-приложений  и для десктоп-приложений.</para>
          <para>Кнопка с выпадающим списоком действий может содержать  текст или пиктограмму (или и то и другое). На рисунке ниже отражены разные виды кнопок.</para>
          <figure>
            <title>Типы кнопок</title>
            <mediaobject>
              <imageobject>
                <imagedata contentwidth="50%" align="center" fileref="img/gui_popupButtonTypes.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Для создания кнопки с текстом достаточно написать в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> следующий код: </para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/popupButton/textPopupButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Для создания кнопки с пиктограммой:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/popupButton/iconPopupButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Кнопка <classname>popupButton</classname> содержит выпадающий список действий,  которые задаются в элементе <link linkend="section_gui_action">actions</link>.</para>
          <figure>
            <title>Кнопка с выпадающим списком действий</title>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/PopupButton.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>popupButton</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row>
                  <entry align="left">
                    <link linkend="attr_align">align</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_icon">icon</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_caption">caption</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>popupButton</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry align="left">
                    <link linkend="section_gui_action">actions</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_linkButton">
          <title>LinkButton</title>
          <para>Кнопка-ссылка (<classname>LinkButton</classname>) − кнопка, выглядящая как гиперссылка.</para>
          <para>XML-имя компонента: <classname>linkButton</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata contentwidth="70%" align="center" fileref="img/gui_linkButton_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса кнопок-ссылок: для веб-приложений  и для десктоп-приложений.</para>
          <para>Кнопка-ссылка  может содержать  текст или пиктограмму (или и то и другое). На рисунке ниже отражены разные виды кнопок.</para>
          <figure>
            <title>Типы кнопок-ссылок</title>
            <mediaobject>
              <imageobject>
                <imagedata contentwidth="40%" align="center" fileref="img/gui_linkButtonTypes.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Для создания кнопки с текстом достаточно написать в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> следующий код: </para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/linkButton/textLinkButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Для создания кнопки с пиктограммой:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/linkButton/iconLinkButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Для кнопки-ссылки, также как и для обычной кнопки (<link linkend="section_button">Button</link>), можно в атрибуте <link linkend="attr_invoke">invoke</link> задать метод <glossterm linkend="glossary_controller_id">контроллера</glossterm>, который будет вызываться при нажатии на нее.</para>
          <para>В качестве примера показано описание кнопки, вызывающей метод <methodname>saveActionTest:</methodname></para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/linkButton/invokeLinkButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>В <glossterm linkend="glossary_controller_id">контроллере</glossterm> экрана необходимо определить метод <methodname>saveActionTest</methodname>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/linkButton/methodLinkButton.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибуты <classname>linkButton</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row>
                  <entry align="left">
                    <link linkend="attr_action">action</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_align">align</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_icon">icon</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_invoke">invoke</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_textField">
          <title>TextField</title>
          <para>Поле для редактирования текста.</para>
          <para>XML-имя компонента: <sgmltag>textField</sgmltag></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_textField_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Классы текстовых полей существуют как для веб-приложений, так  и для десктоп-приложений.</para>
          <para>Текстовое поле служит для обеспечения возможности получить текстовую информацию от пользователя, а также для отображения атрибутов <glossterm linkend="glossary_entity">сущности</glossterm>.</para>
          <para>Для создания простого текстового поля достаточно в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> написать следующий код:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textField.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>На рисунке ниже показан вид простого текстового поля.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_textField.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Для создания текстового поля, связанного с данными, необходимо использовать атрибуты <link linkend="attr_datasource">datasource</link> и <link linkend="attr_property">property</link>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textFieldDatasource.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_textField_data.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Если поле не связано с источником данных (то есть не указан источник данных и название атрибута), можно связать текстовое поле  с типом данных с помощью атрибута <property id="attr_datatype_1">datatype</property>. Атрибут используется  для форматирования значения поля. Значением атрибута <property>datatype</property> является имя типа данных из списка:</para>
          <itemizedlist>
            <listitem>
              <para><property>boolean</property></para>
            </listitem>
            <listitem>
              <para><property>byte array</property></para>
            </listitem>
            <listitem>
              <para><property>date</property></para>
            </listitem>
            <listitem>
              <para><property>decimal</property></para>
            </listitem>
            <listitem>
              <para><property>double</property></para>
            </listitem>
            <listitem>
              <para><property>int</property></para>
            </listitem>
            <listitem>
              <para><property>long</property></para>
            </listitem>
            <listitem>
              <para><property>string</property></para>
            </listitem>
            <listitem>
              <para><property>uuid</property></para>
            </listitem>
          </itemizedlist>
          <para>В качестве примера рассмотрим текстовое поле, связянное с типом данных <type>Integer</type>. </para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textFieldInt.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>При переходе из  текстового поля, в котором введено  значение, не  являющееся типом данных <type>Integer</type>, приложение выдаст сообщение об ошибке и очистит текстовое поле.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_textField_int.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Текстовому полю можно задавать количество строк и столбцов текста с помощью атрибутов <property id="attr_cols">cols</property> и <property id="attr_rows">rows</property>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textFieldColsRows.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_textFieldColsRows.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Вы можете связять текстовое поле с типом данных с помощью атрибута <property id="attr_datatype">datatype</property>. Атрибут используется  для форматирования значения поля в том случае, если поле не связано с данными (то есть не указан источник данных и название атрибута). Значением атрибута <property>datatype</property> является имя типа данных из списка:</para>
          <para>Для текстового компонента можно ограничить максимальную длину вводимого текста с помощью атрибута <property id="attr_maxLength">maxLength</property>. Значение атрибута устанавливается по умолчанию на основании длины строкового атрибута <glossterm linkend="glossary_entity">сущности</glossterm>, если этот параметр указан в <glossterm linkend="glossary_annotation">аннотации</glossterm> сущности. Значение &quot;-1&quot; означает отсутствие ограничения.</para>
          <para>Ниже показан пример, ограничивающий длину вводимого текста в 10 символов.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textFieldMaxLength.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Для компонента <classname>TextField</classname> существует атрибут <property id="attr_resizable">resizable</property>. При задании атрибуту значения <property>true</property> и установке количества строк, больших одной, у пользователя появляется возможность  изменять размеры компонента.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textFieldResizable.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_textField_resizable.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Для отсечения лишних пробелов в начале и конце значения используется атрибут <property id="attr_trim">trim</property>. По умолчанию значение атрибута равно <property>true</property>. Пробелы отсекаются в момент получения значения поля с помощью метода доступа.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textFieldTrim.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>В <glossterm linkend="glossary_controller_id">контроллере</glossterm> экрана определяем метод, который будет вызываться при нажатии на <link linkend="section_button">кнопку</link>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textFieldTrimContr.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибут <property id="attr_secret">secret</property> позволяет преобразовать текстовое поле в  поле, которое не показывает символы, введенные пользователем. Вместо этого поле отображает эхо-символы, отличные от введенных. </para>
          <para>Текстовое поле с атрибутом <property>secret=&quot;true&quot;</property>  скрывает введенные данные только в визуальном представлении. При получении значения поля с помощью метода доступа это значение представляется в текстовой форме.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textFieldSecret.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>В <glossterm linkend="glossary_controller_id">контроллере</glossterm> экрана определяем метод, который будет вызываться при нажатии на <link linkend="section_button">кнопку</link>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/textField/textFieldSecretContr.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_textField_secret.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>textField</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_editable">editable</link>
                  </entry><entry align="left">
                    <link linkend="attr_property">property</link>
                  </entry><entry>
                    <link linkend="attr_secret">secret</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_cols">cols</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_resizable">resizable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_required">required</link>
                  </entry>
                  <entry>
                    <link linkend="attr_trim">trim</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datatype">datatype</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry>
                    <link linkend="attr_maxLength">maxLength</link>
                  </entry>
                  <entry>
                    <link linkend="attr_rows">rows</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>textField</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry align="left">
                    <link linkend="element_formatter">formatter</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="element_validator">validator</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_gui_textArea">
          <title>TextArea</title>
          <para>Текстовая область (<classname>TextArea</classname>) − многострочное текстовое поле для редактирования текста. Содержит элементы управления для форматирования текста.</para>
          <para>XML-имя компонента: <sgmltag>textArea</sgmltag></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata contentwidth="60%" align="center" fileref="img/gui_textArea_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Класс текстовой области существует только для веб-приложений.</para>
          <para>К тексту, вводимому в компоненте <classname>TextArea</classname>, можно применять средства для форматирования: изменять начертание шрифта, его размер, гарнитуру − с помощью элементов управления, расположенных в верхней части компонента.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_textAreaInfo.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>textArea</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_editable">editable</link>
                  </entry><entry align="left">
                    <link linkend="attr_property">property</link>
                  </entry><entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_cols">cols</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_required">required</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_rows">rows</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>textArea</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry align="left">
                    <link linkend="element_formatter">formatter</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="element_validator">validator</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_dateField">
          <title>DateField</title>
          <para>Поле для отображения или ввода даты и времени. В самом простом варианте представляет собой поле для отображения даты, справа от него находится кнопка с выпадающим календарем, правее находится поле для ввода времени.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_dateFieldSimple.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Дата и время по умолчанию отображаются в формате, соответствующем выбранной локали.</para>
          <para>XML-имя компонента: <sgmltag>dateField</sgmltag>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_dateField_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса полей для ввода даты и времени: для веб-приложений  и для десктоп-приложений.</para>
          <para>Для создания простого поля для ввода даты необходимо определить его в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> следующим образом:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/dateField/dateField.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Возможно изменить формат представления даты и времени с помощью атрибута  <property id="attr_dateFormat">dateFormat</property> по правилам  SimpleDateFormat (<ulink url="http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html">http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html</ulink>). Значением атрибута может быть либо строка формата, либо ключ в <glossterm linkend="glossary_app_folders_id">пакете сообщений</glossterm> (если строка начинается с msg://)</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/dateField/dateFieldFormat.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_dateField_format.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>В большинстве бизнес-приложений нет необходимости отображать милисекунды или даже время.  Точность представления даты или времени контролируется атрибутом <property id="attr_resolution">resolution</property>.  Значение атрибута должно соответствовать перечислению <classname>DateField.Resolution</classname> − <type>MSEC</type>, <type>SEC</type>, <type>MIN</type>, <type>HOUR</type>, <type>DAY</type>, <type>MONTH</type>, <type>YEAR</type>. По умолчанию точность определяется по <glossterm linkend="glossary_annotation">аннотации</glossterm> <classname>javax.persistence.Temporal</classname> соответствующего атрибута <glossterm linkend="glossary_entity">сущности</glossterm>.</para>
          <para>Если <property>resolution=&quot;DAY&quot;</property> и не указан атрибут <property>dateFormat</property>, то в качестве формата будет взят формат, указанный в <glossterm linkend="glossary_main_localized_folder_id">главном пакете сообщений</glossterm> с ключом <property>dateFormat</property>.</para>
          <para>Если <property>resolution=&quot;MIN&quot;</property> и не указан атрибут <property>dateFormat</property>, то в качестве формата будет взят формат, указанный в <glossterm linkend="glossary_main_localized_folder_id">главном пакете сообщений</glossterm> с ключом <property>dateTimeFormat</property>.</para>
          <para>Ниже показано определения поля для ввода даты с точностью до месяца.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/dateField/dateFieldResolution.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_dateField_resolution.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>dateField</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_editable">editable</link>
                  </entry><entry align="left">
                    <link linkend="attr_property">property</link>
                  </entry><entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_required">required</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_dateFormat">dateFormat</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_resolution">resolution</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>dateField</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry>
                    <link linkend="element_validator">validator</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_timeField">
          <title>TimeField</title>
          <para>Поле для отображения или ввода времени. В самом простом варианте представляет собой поле для отображения или ввода времени в часах и минутах.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_timeField.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>timeField</classname>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_timeField_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса полей для ввода времени: для веб-приложений (класс <classname>WebTimeField</classname>) и для десктоп-приложений (класс <classname>DesktopTimeField</classname>). Оба этих класса реализуют интерфейс <interfacename>TimeField</interfacename>, который, в свою очередь, наследуется от интерфейса  <interfacename>Field</interfacename>. Класс <classname>WebTimeField</classname> наследуется от абстрактного класса <classname>WebAbstractField</classname>, класс <classname>DesktopTimeField</classname> наследуется от абстрактного класса <classname>DesktopAbstractField</classname>. Класс <classname>WebTimeField</classname> реализует интерфейс <link linkend="section_interface_wrapper">Component.Wrapper.</link></para>
          <para>Для создания простого  поля для ввода времени необходимо определить его в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> следующим образом:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/timeField/timeField.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Атрибут <link linkend="attr_id">id</link> является обязательным для компонента  <classname>TimeField</classname>.</para>
          </warning>
          <para>С помощью установки атрибута <property id="attr_showSeconds">showSeconds</property> в значение <classname>true</classname> можно настроить отображение секунд.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/timeField/timeFieldSec.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_timeFieldSec.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>timeField</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry><entry align="left">
                    <link linkend="attr_required">required</link>
                  </entry><entry>
                    <link linkend="attr_visible">visible</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_showSeconds">showSeconds</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_editable">editable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_property">property</link>
                  </entry>
                  <entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>timeField</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry>
                    <link linkend="element_validator">validator</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_gui_fieldGroup">
          <title>FieldGroup</title>
          <para>Группа полей (<classname>FieldGroup</classname>) генерализует представление атрибутов одного или более <glossterm linkend="glossary_datasource_id">источника данных</glossterm>. Представление поля зависит от типа соответствующего атрибута. Для отображения сущностей может использоваться как <link linkend="section_lookupField">LookupField</link>, так и <link linkend="section_gui_pickerField">PickerField</link>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_fieldGroup.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>fieldGroup</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_FieldGroup_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса групп полей: для веб-приложений (класс <classname>WebFieldGroup</classname>) и для десктоп-приложений (класс <classname>DesktopFieldGroup</classname>). Оба этих класса реализуют интерфейс <interfacename>FieldGroup</interfacename>, который, в свою очередь, наследуется от интерфейсов  <link linkend="section_interface_component">Component</link>, <link linkend="section_interface_belongToFrame">Component.BelongToFrame</link>, <link linkend="section_interface_hasCaption">Component.HasCaption</link>, <interfacename>Component.HasBorder</interfacename>,
        <interfacename>Component.Editable</interfacename>, <interfacename>Component.Collapsable</interfacename>, <interfacename>Component.HasSettings</interfacename>, <interfacename>Component.Validatable</interfacename>. Класс <classname>WebFieldGroup</classname> наследуется от абстрактного класса <classname>WebAbstractComponent</classname>, класс <classname>DesktopFieldGroup</classname> наследуется от абстрактного класса <classname>DesktopAbstractComponent</classname> и реализует интерфейс <interfacename>AutoExpanding.</interfacename></para>
          <para>Ниже представлено описание группы полей в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> экрана:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/fieldGroup/fieldGroup.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para><glossterm linkend="glossary_datasource_id">Источник данных</glossterm> (атрибут <link linkend="attr_datasource" id="attr_fG_datasource">datasource</link>) можно задать как для всего компонента целиком, так и для каждого поля в отдельности. Если для компонента <classname>fieldGroup</classname> атрибут не задан, то атрибут <property>datasource</property> должен быть задан для каждого <link linkend="attr_field">поля</link> в отдельности, либо представление полей должно задаваться разработчиком.</para>
          <para>При установке  атрибута <property id="attr_collapsable">collapsable</property>   в значение <classname>true</classname> компонент может сворачивать свое содержимое.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_fieldGroup_collapsable.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para id="attr_captionAlignment"><property>captionAlignment</property> − необязательный атрибут, задает позицию отображения заголовков полей. Может принимать два значения: <classname>LEFT</classname>, <classname>TOP</classname>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_FieldGroup_captionAlignment.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Компонент <classname>fieldGroup</classname> состоит из списков <link linkend="attr_field">полей</link>, сгруппированных в элементе <property id="attr_fG_column">column</property>. </para>
          <itemizedlist>
            <listitem>
              <para>С помощью атрибута <property id="attr_fG_width">width</property> задается ширину всех полей (без учета заголовка) в колонке. Это значение может быть перекрыто в каждом отдельном поле.</para>
            </listitem>
            <listitem>
              <para>Атрибут <property id="attr_fG_flex">flex</property> определяет  соотношение ширин колонок.</para>
            </listitem>
          </itemizedlist>
          <para>Элементами <link linkend="attr_fG_column">column</link> служат поля (<property>field</property>).</para>
          <para id="attr_field"><property>field</property> − элемент, содержащий описание выводимого поля. Может содержать описание формата выводимого значения (<link linkend="element_formatter">formatter</link>) и описание валидаторов, применяемых к соответствующему полю (<link linkend="element_validator">validator</link>). Рассмотрим более подробно некоторые атрибуты элемента <property>field</property>. </para>
          <itemizedlist>
            <listitem>
              <para><link linkend="attr_id" id="attr_field_id">id</link> − обязательный атрибут, идетификатор поля. Имеет физический смысл: в случае, если задан <glossterm linkend="glossary_datasource_id">источник данных</glossterm>, то идентификатором поля должно быть имя атрибута, иначе − просто идентификатор поля.</para>
            </listitem>
            <listitem>
              <para><link linkend="attr_caption" id="attr_field_caption">caption</link> − необязательный атрибут, содержащий заголовок поля.</para>
            </listitem>
            <listitem>
              <para><link linkend="attr_visible" id="attr_field_visible">visible</link> − необязательный атрибут, отвечает за сокрытие поля.</para>
            </listitem>
            <listitem>
              <para><link linkend="attr_optionsDatasource" id="attr_field_optionsDatasource">optionsDatasource</link> − необязательный атрибут, определяющий список возможных значений поля.</para>
            </listitem>
            <listitem>
              <para><link linkend="attr_datasource" id="attr_field_datasource">datasource</link> − необязательный атрибут, содержит имя <glossterm linkend="glossary_datasource_id">источника данных</glossterm> для конкретного поля.</para>
            </listitem>
            <listitem>
              <para>Есть возможность самостоятельно задать представление поля с помощью атрибута <property id="attr_custom">custom</property>. Значение атрибута в этом случае должно быть равно  <classname>true</classname>. Представление пользовательского поля необходимо определить в контроллере экрана. Компонент представления должен реализовывать интерфес <interfacename>Field</interfacename>. Ниже представлен пример представления пользовательского поля:</para>
              <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/fieldGroup/fieldGroupCustom.txt" encoding="UTF-8" parse="text"/></programlisting>
            </listitem>
            <listitem>
              <para><link linkend="attr_width" id="attr_field_width">width</link> − небязательный атрибут, содержит ширину поля (без учета заголовка)</para>
            </listitem>
            <listitem>
              <para>Если значение атрибута <property id="attr_field_rows">rows</property> больше 1, то в ячейке будет компонент <link linkend="section_gui_textArea">TextArea</link>.</para>
            </listitem>
          </itemizedlist>
          <para>Атрибуты <classname>fieldGroup</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">border</entry>editable<entry align="left">
                    <link linkend="attr_fG_datasource">datasource</link>
                  </entry><entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry><entry/></row>
                <row>
                  <entry>
                    <link linkend="attr_caption">caption</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_editable">editable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_captionAlignment">captionAlignment</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_collapsable">collapsable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>fieldGroup</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry>
                    <link linkend="element_fG_field">field</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="element_fG_column">column</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
          <para>Атрибуты <link linkend="attr_field" id="element_fG_field">field</link>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_field_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_dateFormat">dateFormat</link>
                  </entry><entry align="left">
                    <link linkend="attr_field_id">id</link>
                  </entry><entry>
                    <link linkend="attr_field_rows">rows</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry>
                    <link linkend="attr_maxLength">maxLength</link>
                  </entry>
                  <entry>
                    <link linkend="attr_showSeconds">showSeconds</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_clickAction">clickAction</link>
                  </entry>
                  <entry align="left">descriptionProperty</entry>
                  <entry>
                    <link linkend="attr_field_optionsDatasource">optionsDatasource</link>
                  </entry>
                  <entry>
                    <link linkend="attr_field_visible">visible</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_cols">cols</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_editable">editable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_required">required</link>
                  </entry>
                  <entry>
                    <link linkend="attr_field_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_custom">custom</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_field_datasource">datasource</link>
                  </entry>
                  <entry align="left">field</entry>
                  <entry>
                    <link linkend="attr_resolution">resolution</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Атрибуты <link linkend="attr_fG_column" id="element_fG_column">column</link>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_fG_flex">flex</link>
                  </entry>editable</row>
                <row>
                  <entry>
                    <link linkend="attr_fG_width">width</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_checkBox">
          <title>CheckBox</title>
          <para>Флажок (<classname>CheckBox</classname>) − компонент, имеющий два состояния: выбран, не выбран. Флажки используются
там, где нужно предоставить пользователю возможность что-то включить или
выключить.</para>
          <para>XML-имя компонента: <classname>checkBox</classname>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_checkBox_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса флажков: для веб-приложений (класс <classname>WebCheckBox</classname>) и для десктоп-приложений (класс <classname>DesktopCheckBox</classname>). Оба этих класса реализуют интерфейс <interfacename>CheckBox</interfacename>, который, в свою очередь, наследуется от интерфейса  <interfacename>Field</interfacename>. Класс <classname>WebCheckBox</classname> наследуется от абстрактного класса <classname>WebAbstractField</classname>, класс <classname>DesktopTextField</classname> наследуется от абстрактного класса <classname>DesktopAbstractField</classname>. Класс <classname>WebCheckBox</classname> реализует интерфейс <link linkend="section_interface_wrapper">Component.Wrapper.</link></para>
          <para>Для создания флажка достаточно в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> написать следующий код:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/checkBox/checkBox.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Атрибут <link linkend="attr_id">id</link> является обязательным для компонента  <classname>CheckBox</classname>.</para>
          </warning>
          <para>Сброс или установка флажка изменяет его состояние. Состояние − это свойство типа <type>Boolean</type>, может быть получено с помощью метода  <methodname>getValue()</methodname> и установлено с помощью метода <methodname>setValue()</methodname>. </para>
          <para>При каждом изменении состояния флажка генерируется событие элемента, которое может быть обработано с помощью <classname>ValueListener</classname>.</para>
          <para>Ниже приведен код <glossterm linkend="glossary_controller_id">контроллера</glossterm>, демонстрирующий работу с флажком. При установке флажка на экране возникает сообщение <quote>Позволить создание нового документа</quote>, при сбросе флажка − <quote>Не позволять создание нового документа</quote>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/checkBox/checkBoxContr.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_checkBoxListener.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>checkBox</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_align">align</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_editable">editable</link>
                  </entry><entry align="left">
                    <link linkend="attr_property">property</link>
                  </entry><entry/></row>
                <row>
                  <entry>
                    <link linkend="attr_caption">caption</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>checkBox</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry>
                    <link linkend="element_validator">validator</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_gui_pickerField">
          <title>PickerField</title>
          <para>Поле ввода с дополнительными кнопками действий (<classname>PickerField</classname>) позволяет отображать экземпляр <glossterm linkend="glossary_entity">сущности</glossterm> в текстовом поле и выполнять действия нажатием на кнопки справа.</para>
          <para>XML-имя компонента: <classname>pickerField</classname>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_pickerField_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса полей ввода с дополнительными кнопками действий: для веб-приложений (класс <classname>WebPickerField</classname>) и для десктоп-приложений (класс <classname>DesktopPickerField</classname>). Оба этих класса реализуют интерфейс <interfacename>PickerField</interfacename>, который, в свою очередь, наследуется от интерфейса  <interfacename>Field</interfacename> и от <link linkend="section_interface_actionsHolder">Component.ActionsHolder</link>. Класс <classname>WebPickerField</classname> наследуется от абстрактного класса <classname>WebAbstractField</classname>, класс <classname>DesktopPickerField</classname> наследуется от абстрактного класса <classname>DesktopAbstractField</classname>. Класс <classname>WebPickerField</classname> реализует интерфейс <link linkend="section_interface_wrapper">Component.Wrapper.</link></para>
          <para>Для того чтобы создать компонент <classname>PickerField</classname>, создайте в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> следующий код:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/pickerField/pickerFieldMetaClass.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Атрибут <link linkend="attr_id">id</link> является обязательным для компонента  <classname>PickerField</classname>.</para>
          </warning>
          <para>Атрибут <property id="attr_metaclass">metaClass</property> задает тип <glossterm linkend="glossary_entity">сущности</glossterm>, экземпляр которой будет выбираться с помощью действия поиска (<classname>lookup</classname>). Для заданной сущности должен быть определен экран <classname>Название_сущности.lookup</classname> либо в атрибуте <property id="attr_lookupScreen">lookupScreen</property> указан идентификатор экрана, который нужно открыть для выбора экземпляра сущности.</para>
          <para>Определить компонент можно также следующим образом:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/pickerField/pickerFieldProperty.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Для правильной работы компонента <classname>PickerField</classname> необходима установка атрибута <link linkend="attr_metaclass">metaClass</link> либо одновременная установка атрибутов <link linkend="attr_datasource">datasource</link> и <link linkend="attr_property">property</link>.</para>
          </warning>
          <caution>
            <title>Подсказка</title>
            <para>Если при объявлении компонента никаких <link linkend="section_gui_action">действий</link> не задано, загрузчик XML определит для него действия <classname>lookup</classname> и <classname>clear</classname>. </para>
          </caution>
          <para>Поэтому если требуются все стандартные действия, их нужно определить с помощью элемента <property id="attr_actions_picker">actions</property>. <property>actions</property> − необязательный элемент, определяющий набор действий (<link linkend="section_gui_action">action</link>) (кнопок справа). В элементе <link linkend="section_gui_action">action</link> можно описывать как стандартные действия, так и произвольные.</para>
          <para>Стандартные действия определяются перечислением <classname>PickerField.ActionType</classname>: <classname>lookup</classname>, <classname>clear</classname>, <classname>open</classname>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/pickerField/pickerFieldStandartActions.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_pickerFieldActionsSt.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Ниже показано описание <classname>PickerField</classname>, имеющего проивольные действия.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/pickerField/pickerFieldUserActions.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Действия необходимо определить в <glossterm linkend="glossary_controller_id">контроллере</glossterm> экрана:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/pickerField/pickerFieldUserActionsContr.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_pickerField_custom.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Для компонента определены горячие клавиши. Для стандартных действий:</para>
          <itemizedlist>
            <listitem>
              <para><classname>Lookup</classname> − <keycombo>
                  <keycap>CTRL</keycap>
                  <keycap>ALT</keycap>
                  <keycap>L</keycap>
                </keycombo></para>
            </listitem>
            <listitem>
              <para><classname>Open</classname> − <keycombo>
                  <keycap>CTRL</keycap>
                  <keycap>ALT</keycap>
                  <keycap>O</keycap>
                </keycombo></para>
            </listitem>
            <listitem>
              <para><classname>Clear</classname> − <keycombo>
                  <keycap>CTRL</keycap>
                  <keycap>ALT</keycap>
                  <keycap>C</keycap>
                </keycombo></para>
            </listitem>
          </itemizedlist>
          <para>Чтобы добавить пользовательскую горячую клавишу, необходимо чтобы класс <link linkend="section_gui_action">действия</link> реализовывал интерфейс <interfacename>com.haulmont.cuba.gui.components.ShortcutAction</interfacename></para>
          <para>Также поддерживается вызов действий сочетанием <keycombo>
              <keycap>CTRL</keycap>
              <keycap>ALT</keycap>
              <keycap>1</keycap>
            </keycombo>, <keycombo>
              <keycap>CTRL</keycap>
              <keycap>ALT</keycap>
              <keycap>2</keycap>
            </keycombo> и так далее.</para>
          <para>Сочетания клавиш можно переназначить в ClientConfig</para>
          <itemizedlist>
            <listitem>
              <para><parameter>cuba.gui.pickerShortcut.modifiers</parameter> − Модификаторы для вызова <link linkend="section_gui_action">действий</link> по порядковому номеру</para>
            </listitem>
            <listitem>
              <para><parameter>cuba.gui.pickerShortcut.lookup</parameter> − Lookup Action</para>
            </listitem>
            <listitem>
              <para><parameter>cuba.gui.pickerShortcut.open</parameter> − Open Action</para>
            </listitem>
            <listitem>
              <para><parameter>cuba.gui.pickerShortcut.clear</parameter> − Clear Action</para>
            </listitem>
          </itemizedlist>
          <para>Атрибуты <classname>PickerField</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry><entry align="left">
                    <link linkend="attr_property">property</link>
                  </entry><entry>
                    <link linkend="attr_width">width</link>
                  </entry></row>
                <row><entry>
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry><entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>required<entry>
                    <link linkend="attr_required">required</link>
                  </entry><entry/></row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_lookupScreen">lookupScreen</link>
                  </entry>
                  <entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_editable">editable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_metaclass">metaClass</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_gui_optionsGroup">
          <title>OptionsGroup</title>
          <para>Компонент, который обеспечивает выбор из альтернатив, используя группу переключателей для выбора единственного значения из списка или используя группу флажков для выбора нескольких значений из списка.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_optionsGroup.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>optionsGroup</classname>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_OptionsGroup_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса групп опций: для веб-приложений (класс <classname>WebOptionsGroup</classname>) и для десктоп-приложений (класс <classname>DesktopOptionsGroup</classname>). Оба этих класса реализуют интерфейс <interfacename>OptionsGroup</interfacename>, который, в свою очередь, наследуется от интерфейса  <interfacename>OptionsField</interfacename>. Класс <classname>WebOptionsGroup</classname> наследуется от класса <classname>WebAbstractOptionsField</classname>, класс <classname>DesktopOptionsGroup</classname> наследуется от класса <classname>DesktopAbstractOptionsField</classname>. Класс <classname>WebOptionsGroup</classname> реализует интерфейс <link linkend="section_interface_wrapper">Component.Wrapper.</link></para>
          <para>Для создания группы переключателей или группы флажков необходимо задать описание в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/optionsGroup/optionsGroup.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибут <property id="attr_orientation">orientation</property> задает расположение элементов группы. По умолчанию элементы располагаются по вертикали. Значение <classname>&quot;horizontal&quot;</classname> служит для горизонтального расположения.</para>
          <para>Для задания режима выбора значений служит атрибут <property id="attr_multiselect">multiselect</property>. Если <classname>&quot;multiselect=false&quot;</classname>, то компонент будет представлен как группа переключателей, иначе − как группа флажков. По умолчанию значение атрибута равно <classname>false</classname>.</para>
          <para>Ниже представлен код компонента, для которого заданы <glossterm linkend="glossary_datasource_id">источник данных</glossterm> с помощью атрибута <link linkend="attr_datasource">datasource</link> и имя поля <glossterm linkend="glossary_entity">сущности</glossterm> с помощью атрибута <link linkend="attr_property">property</link>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/optionsGroup/optionsGroupDatasource.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибуты <classname>optionsGroup</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry><entry align="left">
                    <link linkend="attr_orientation">orientation</link>
                  </entry><entry>
                    <link linkend="attr_visible">visible</link>
                  </entry></row>
                <row><entry>
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry><entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>required<entry>
                    <link linkend="attr_property">property</link>
                  </entry><entry>
                    <link linkend="attr_width">width</link>
                  </entry></row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_required">required</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_multiselect">multiselect</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_editable">editable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_optionsDatasource">optionsDatasource</link>
                  </entry>
                  <entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>optionsGroup</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry align="left">
                    <link linkend="element_validator">validator</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_lookupField">
          <title>LookupField</title>
          <para>Компонент, реализующий раскрывающийся список. Раскрывающийся список  служит для выбора одного из множества
доступных вариантов. В составе такого списка присутствует активизирующая его кнопка и поле редактирования. Раскрывающийся список реализует фильтрацию значений в реальном времени (по мере ввода значения пользователем) и постраничный вывод доступных значений.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_lookupField.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <parameter>lookupField</parameter>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_LookupField_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса раскрывающегося списка: для веб-приложений (класс <classname>WebLookupField</classname>) и для десктоп-приложений (класс <classname>DesktopLookupField</classname>). Оба этих класса реализуют интерфейс <interfacename>LookupField</interfacename>, который, в свою очередь, наследуется от интерфейса  <interfacename>OptionsField</interfacename>. Класс <classname>WebLookupField</classname> наследуется от класса <classname>WebAbstractOptionsField</classname>, класс <classname>DesktopLookupField</classname> наследуется от класса <classname>DesktopAbstractOptionsField</classname>. Класс <classname>WebLookupField</classname> реализует интерфейс <link linkend="section_interface_wrapper">Component.Wrapper.</link></para>
          <para>Ниже представлено описание раскрывающегося списка, значения которого заданы с помощью установки <glossterm linkend="glossary_datasource_id">источника данных</glossterm> и имени атрибута <glossterm linkend="glossary_entity">сущности</glossterm>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/lookupField/lookupField.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>С помощью атрибута <property id="attr_filterMode">filterMode</property> можно задать тип фильтрации значений:</para>
          <itemizedlist>
            <listitem>
              <para><classname>NO</classname> − нет фильтрации</para>
            </listitem>
            <listitem>
              <para><classname>STARTS_WITH</classname> − по началу фразы</para>
            </listitem>
            <listitem>
              <para><classname>CONTAINS</classname> − по любому вхождению</para>
            </listitem>
          </itemizedlist>
          <para>Атрибуты <classname>lookupField</classname>: </para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry><entry align="left">
                    <link linkend="attr_optionsDatasource">optionsDatasource</link>
                  </entry><entry>
                    <link linkend="attr_visible">visible</link>
                  </entry></row>
                <row><entry>
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry><entry align="left">
                    <link linkend="attr_filterMode">filterMode</link>
                  </entry>required<entry>
                    <link linkend="attr_property">property</link>
                  </entry><entry>
                    <link linkend="attr_width">width</link>
                  </entry></row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_required">required</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_editable">editable</link>
                  </entry>
                  <entry>nullName</entry>
                  <entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>lookupField</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry align="left">
                    <link linkend="element_validator">validator</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_lookupPickerField">
          <title>LookupPickerField</title>
          <para>Раскрывающийся список с расширенной функциональностью (<classname>LookupPickerField</classname>) позволяет отображать экземпляр сущности в текстовом поле, выбирать экземпляр в раскрывающемся списке и выполнять действия нажатием на кнопки справа.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_lookupPickerField.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <parameter>lookupPickerField</parameter>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_LookupPickerField_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса раскрывающегося списка c расширенной  функциональностью: для веб-приложений (класс <classname>WebLookupPickerField</classname>) и для десктоп-приложений (класс <classname>DesktopLookupPickerField</classname>). Оба этих класса реализуют интерфейс <interfacename>LookupPickerField</interfacename>, который, в свою очередь, наследуется от интерфейсов  <link linkend="section_lookupField">LookupField</link> и <link linkend="section_gui_pickerField">PickerField</link>. Класс <classname>WebLookupPickerField</classname> наследуется от класса <classname>WebLookupField</classname>, класс <classname>DesktopLookupPickerField</classname> наследуется от класса <classname>DesktopLookupField</classname>. </para>
          <para>Ниже представлено описание раскрывающегося списка с расширенной функциональностью.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/lookupPickerField/lookupPickerField.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибуты <classname>lookupPickerField</classname>: </para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry><entry align="left">nullName</entry><entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry></row>
                <row><entry>
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry><entry align="left">
                    <link linkend="attr_filterMode">filterMode</link>
                  </entry>required<entry>
                    <link linkend="attr_optionsDatasource">optionsDatasource</link>
                  </entry><entry>
                    <link linkend="attr_visible">visible</link>
                  </entry></row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_property">property</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_required">required</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_editable">editable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_metaclass">metaClass</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>lookupField</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry align="left">
                    <link linkend="element_validator">validator</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_action">actions</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
        </section>
        <section id="section_twinColumn">
          <title>TwinColumn</title>
          <para>Сдвоенный список (<classname>TwinColumn</classname>)  представляет собой компонент множественного выбора, имеющий  два находящихся рядом списка: доступных и выбранных опций. В левом списке содержатся доступные невыбранные значения, в правом списке содержатся выбранные значения. Пользователь может выбрать значения из левого списка и нажать на кнопку <inlinemediaobject>
              <imageobject>
                <imagedata fileref="img/gui_teinColumnRight.png"/>
              </imageobject>
            </inlinemediaobject>, переместив их таким образом в правый список. Значения могут быть отменены для выбора путем выделения их в правом списке и нажатия на кнопку <inlinemediaobject>
              <imageobject>
                <imagedata fileref="img/gui_teinColumnLeft.png"/>
              </imageobject>
            </inlinemediaobject>. Для каждого значения можно задать уникальный стиль отображения и пиктограмму.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata fileref="img/gui_teinColumn.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>twinColumn</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_TwinColumn_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Класс сдвоенного списка существует только для веб-приложений (класс <classname>WebTwinColumn</classname>). Класс реализует интерфейс <interfacename>TwinColumn</interfacename>, который, в свою очередь, наследуется от интерфейса  <interfacename>OptionsField</interfacename>, и интерфейс <link linkend="section_interface_wrapper">Component.Wrapper.</link>. Класс <classname>WebTwinColumn</classname> наследуется от класса <classname>WebAbstractOptionsField</classname>.</para>
          <para>Ниже представлено описание сдвоенного списка в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/twinColumn/twinColumnOptDs.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>В данном примере используется атрибут <property id="attr_columns_twin">columns</property> для задания количества колонок текста в списке и атрибут <property id="attr_rows_twin">rows</property> для задания количества строк текста в списке.</para>
          <para>Атрибуты <classname>twinColumn</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_editable">editable</link>
                  </entry><entry align="left">
                    <link linkend="attr_optionsDatasource">optionsDatasource</link>
                  </entry><entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry></row>
                <row><entry>
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry><entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>required<entry>
                    <link linkend="attr_property">property</link>
                  </entry><entry>
                    <link linkend="attr_visible">visible</link>
                  </entry></row>
                <row>
                  <entry align="left">
                    <link linkend="attr_columns_twin">columns</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_required">required</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry>nullName</entry>
                  <entry>
                    <link linkend="attr_rows">rows</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>twinColumn</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry align="left">
                    <link linkend="element_validator">validator</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
          <para>Для задания внешнего вида опций нужно реализовать интерфейс <interfacename>com.haulmont.cuba.gui.components.StyleProvider</interfacename> как показано в следующем примере:</para>
          <programlisting>TwinColumn twinColumn = getComponent(&quot;groups&quot;);
        twinColumn.setStyleProvider(new TwinColumn.StyleProvider() {
            public String getStyleName(Entity item, Object property, boolean selected) {
                if (((Group) item).getName().equals(&quot;Company&quot;)) {
                    return &quot;companyStyle&quot;;
                } else {
                    return null;
                }
            }

            public String getItemIcon(Entity item, boolean selected) {
                if (((Group) item).getName().equals(&quot;Company&quot;)) {
                    return &quot;theme:icons/company.png&quot;;
                } else {
                    return null;
                }
            }
        });</programlisting>
        </section>
        <section id="section_gui_tokenList">
          <title>TokenList</title>
          <para>Список маркеров (<classname>TokenList</classname>) представляет собой компонент, имеющий упрощенный вариант отображения и формирования списка <glossterm linkend="glossary_entity">сущностей</glossterm>.</para>
          <para>Для выбора значений используется компонент, подобный <link linkend="section_lookupPickerField">LookupPickerField</link> </para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_tokenList.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>tokenList</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_TokenList_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса списка маркеров: для веб-приложений (класс <classname>WebTokenList</classname>) и для десктоп-приложений (класс <classname>DesktopTokenList</classname>). Оба этих класса реализуют интерфейс <interfacename>TokenList</interfacename>, который, в свою очередь, наследуется от интерфейсов  <interfacename>Field</interfacename>, <link linkend="section_interface_belongToFrame">Component.BelongToFrame</link>,
        <link linkend="section_interface_hasCaption">Component.HasCaption</link>, <interfacename>Component.Editable</interfacename>. Класс <classname>WebTokenList</classname> наследуется от класса <classname>WebAbstractField</classname>, класс <classname>DesktopTokenList</classname> наследуется от класса <classname>DesktopAbstractField</classname>.</para>
          <para>Для создания списка маркеров необходимо задать описание в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/tokenList/tokenList.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Атрибут <link linkend="attr_datasource">datasource</link> является обязательным для компонента  <classname>TokenList</classname>.</para>
          </warning>
          <para>С помощью атрибута <property id="attr_position">position</property> можно задавать позиционирование раскрывающегося списка. Атрибут может принимать два  значения:</para>
          <itemizedlist>
            <listitem>
              <para><classname>TOP</classname></para>
            </listitem>
            <listitem>
              <para><classname>BOTTOM</classname></para>
            </listitem>
          </itemizedlist>
          <figure>
            <title>Список маркеров со значением атрибута position=&quot;BOTTOM&quot;</title>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_tokenListBottom.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибут <property id="attr_inline">inline</property> задает отображение списка выбранных значений: вертикально или горизонтально. Значение <classname>true</classname> соответствует горизонтальному расположению, значение <classname>false</classname> − вертикальному.</para>
          <figure>
            <title>Список маркеров с горизонтальным расположением выбранных значений</title>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_tokenListInline.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Установка атрибута <property id="attr_simple">simple</property> в значение <classname>true</classname> позволяет сворачивать компонент, оставляя только кнопку добавления. При нажатии на кнопку добавления сразу показывается экран списка экземляров <glossterm linkend="glossary_entity">сущности</glossterm>, для которой задан <glossterm linkend="glossary_datasource_id">источник данных</glossterm>.</para>
          <figure>
            <title>Список маркеров со значением атрибута simple=&quot;true&quot;</title>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_tokenListSimple.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Элемент <classname>tokenList</classname> должен содержать следующие элементы:</para>
          <itemizedlist>
            <listitem>
              <para id="element_lookup"><property>lookup</property> − описатель компонента выбора значений.</para>
              <para>Атрибут <property id="attr_lookup">lookup</property> задает вид списка.</para>
              <figure>
                <title/>
                <mediaobject>
                  <imageobject>
                    <imagedata align="center" fileref="img/gui_tokenListLookup.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
              <para>Атрибут <property id="attr_lookupScreen">lookupScreen</property>  задает идентификатор экрана для выбора значений в режиме <link linkend="attr_lookup">lookup</link>.</para>
              <para>С помощью атрибута <property id="attr_openType">openType</property> можно задать способ открытия окна списка экземпляров сущности:</para>
              <itemizedlist>
                <listitem>
                  <para><classname>NEW_TAB</classname> − открытие экрана в новой вкладке</para>
                </listitem>
                <listitem>
                  <para><classname>DIALOG</classname> − открытие экрана в диалоговом окне</para>
                </listitem>
                <listitem>
                  <para><classname>NEW_WINDOW</classname> − открытие экрана в новом окне</para>
                </listitem>
                <listitem>
                  <para><classname>THIS_TAB</classname> − открытие экрана в текущей вкладке</para>
                </listitem>
              </itemizedlist>
            </listitem>
            <listitem>
              <para id="element_button"><property>button</property> − описатель кнопки добавления значений</para>
            </listitem>
          </itemizedlist>
          <para>Ниже расположен пример <glossterm linkend="glossary_controller_id">контроллера</glossterm>, в котором задаются обработчики добавления нового значения и удаления значения:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/tokenList/tokenListContr.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибуты <classname>tokenList</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_editable">editable</link>
                  </entry><entry align="left">
                    <link linkend="attr_inline">inline</link>
                  </entry><entry>
                    <link linkend="attr_visible">visible</link>
                  </entry></row>
                <row><entry>
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry><entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>required<entry>
                    <link linkend="attr_position">position</link>
                  </entry><entry>
                    <link linkend="attr_width">width</link>
                  </entry></row>
                <row>
                  <entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_simple">simple</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>tokenList</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry align="left">
                    <link linkend="element_tL_lookup">lookup</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="element_tL_button">button</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
          <para>Атрибуты <link linkend="element_lookup" id="element_tL_lookup">lookup</link>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_lookupScreen">lookupScreen</link>
                  </entry><entry align="left">
                    <link linkend="attr_optionsDatasource">optionsDatasource</link>
                  </entry><entry/></row>
                <row><entry>
                    <link linkend="attr_filterMode">filterMode</link>
                  </entry><entry align="left">multiselect</entry>required<entry/><entry/></row>
                <row>
                  <entry align="left">
                    <link linkend="attr_lookup">lookup</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_openType">openType</link>
                  </entry>
                  <entry/>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Атрибуты <link linkend="element_button" id="element_tL_button">button</link>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable</row>
                <row><entry>
                    <link linkend="attr_icon">icon</link>
                  </entry>required</row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_gui_table">
          <title>Table</title>
          <para>Таблица (<classname>Table</classname>)  дает возможность выводить двухмерную информацию, расположенную в виде строк и столбцов, настраивать и сортировать данные, управлять заголовками таблицы и ее выделенными элементами.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/Table.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>table</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_Table_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса простых таблиц: для веб-приложений (класс <classname>WebTable</classname>) и для десктоп-приложений (класс <classname>DesktopTable</classname>). Класс <classname>WebTable</classname> наследуется от абстрактного класса <classname>WebAbstractTable</classname>, класс <classname>DesktopTable</classname> наследуется от абстрактного класса <classname>DesktopAbstractTable</classname>. Оба абстрактных класса реализуют интерфейс <interfacename>Table</interfacename>, который, в свою очередь, наследуется от интерфейсов  <interfacename>ListComponent</interfacename>, <interfacename>Component.Editable</interfacename>, <interfacename>Component.HasSettings</interfacename>,
        <interfacename>Component.HasButtonsPanel</interfacename>, <interfacename>Component.HasPresentations</interfacename>.</para>
          <para>Для того чтобы создать простую таблицу, необходимо в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> задать <glossterm linkend="glossary_datasource_id">источник данных</glossterm> и определить описание таблицы:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/table/table.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Обязательными для таблицы являются элементы <link linkend="element_table_columns">columns</link> и  <link linkend="element_table_rows">rows</link>, а также атрибут <link linkend="attr_id">id</link>.</para>
          </warning>
          <para>Атрибут <property id="attr_presentations">presentations</property> управляет механизмом <link linkend="section_gui_presentation">представлений</link>.Значение по умолчанию равно <classname>false</classname>. Когда значение атрибута равно <classname>true</classname>, то в верхнем правом углу таблицы появляется значок <inlinemediaobject>
              <imageobject>
                <imagedata fileref="img/gui_presentation.png"/>
              </imageobject>
            </inlinemediaobject>.</para>
          <para>Атрибут <property id="attr_sortable">sortable</property> разрешает или запрещает сортировку в таблице. По умолчанию имеет значение <classname>true</classname>. Если сортировка разрешена, то при нажатии на название колонки справа от названия появляется значок <inlinemediaobject>
              <imageobject>
                <imagedata fileref="img/gui_sortable_down.png"/>
              </imageobject>
            </inlinemediaobject>/<inlinemediaobject>
              <imageobject>
                <imagedata fileref="img/gui_sortable_up.png"/>
              </imageobject>
            </inlinemediaobject>.</para>
          <para>Существует возможность использования для колонок функций <link linkend="section_gui_aggregation">агрегирования</link> без модификации <glossterm linkend="glossary_datasource_id">источника данных</glossterm> с помощью атрибута <property id="attr_aggregatable">aggregatable</property>. По умолчанию атрибут  имеет значение <classname>false</classname>.</para>
          <para>Атрибут <property id="attr_showTotalAggregation">showTotalAggregation</property> разрешает или запрещает отображение строки итоговой агрегации в таблице. По умолчанию имеет значение <classname>true</classname>.</para>
          <para>Можно задать множественное выделение строк в таблице с помощью присваивания атрибуту <property id="attr_table_multiselect">multiselect</property>  значения <classname>true</classname>. По умолчанию значение атрибута равно <classname>false</classname>.</para>
          <para>С помощью элемента <property id="element_table_actions">actions</property> возможно определять набор действий (<link linkend="section_gui_action">action</link>). Кроме описания произвольного действия возможно использование стандартных действий, определяемых перечислением <classname>ListActionType</classname>: <classname>create</classname>, <classname>edit</classname>, <classname>remove</classname>, <classname>refresh</classname>, <classname>add</classname>, <classname>exclude</classname>, <classname>excel</classname>.</para>
          <para><property id="attr_rowsCount">rowsCount</property> − необязательный элемент, создающий для таблицы компонент <classname>RowsCount</classname>, который позволяет загружать в таблицу данные постранично.</para>
          <para>Элемент <property id="element_table_rows">rows</property> является обязательным. В этом элементе необходимо объявить используемый <glossterm linkend="glossary_datasource_id">источник данных</glossterm>.</para>
          <para>Атрибут <property id="attr_headerMode">headerMode</property> элемента <property>rows</property> задает вариант отображения заголовков рядов:</para>
          <itemizedlist>
            <listitem>
              <para><classname>NONE</classname> − нет заголовков</para>
            </listitem>
            <listitem>
              <para><classname>ICON</classname> − пиктограмма</para>
            </listitem>
          </itemizedlist>
          <para>Следующим обязательным элементом для таблицы является элемент <property id="element_table_columns">columns</property>. Он определяет набор колонок (column) таблицы.</para>
          <para><property id="element_table_columns_column_1">column</property>  − элемент, задающий опции для колонки таблицы. Может содержать следующие атрибуты:</para>
          <itemizedlist>
            <listitem>
              <para><property id="attr_table_column_id">id</property> − обязательный атрибут, содержит название атрибута <glossterm linkend="glossary_entity">сущности</glossterm>, выводимого в колонке.</para>
            </listitem>
            <listitem>
              <para><property id="attr_table_column_collapsed">collapsed</property> − необязательный атрибут, скрывает/показывает колонку. По умолчанию имеет значение <classname>false</classname>.</para>
            </listitem>
            <listitem>
              <para><property id="attr_table_column_caption">caption</property> − необязательный атрибут, содержит заголовок колонки.</para>
            </listitem>
            <listitem>
              <para><property id="attr_table_column_width">width</property> − необязательный атрибут, отвечает за изначальную ширину колонки.</para>
            </listitem>
            <listitem>
              <para><property id="attr_table_column_calculatable">calculatable</property> − необязательный атрибут, используется только в редактируемой таблице. Буквально означает, что значения в данной колонке являются вычислимыми и зависят от значений других колонок.</para>
            </listitem>
            <listitem>
              <para><link linkend="attr_editable" id="attr_table_column_editable">editable</link> − необязательный атрибут, разрешает/запрещает редактирование данного атрибута в редактируемой таблице.</para>
            </listitem>
          </itemizedlist>
          <para>Для таблицы можно задать стиль отображения ячеек таблицы. Для этого в <glossterm linkend="glossary_controller_id">контроллере</glossterm> экрана нужно задать для талицы <classname>StyleProvider</classname> реализовав интерфейс <interfacename>com.haulmont.cuba.gui.components.StyleProvider.</interfacename></para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/table/tableStyle.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Далее нужно определить в теме приложения стили для строк и столбцов:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/table/tableStylecss.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_table_Style.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>В таблице существует возможность задавать собственное представление данных в колонке. Для этого необходимо использовать метод <methodname>Table.addGeneratedColumn</methodname>. В методе нужно создать CUBA-компонент с использованием класса <classname>ComponentsFactory</classname>. Пример:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/table/tableGeneratedColumn.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_tableGenerated.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>table</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_aggregatable">aggregatable</link>
                  </entry>editable<entry align="left">margin</entry><entry align="left">
                    <link linkend="attr_sortable">sortable</link>
                  </entry><entry/></row>
                <row>
                  <entry>
                    <link linkend="attr_editable">editable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_table_multiselect">multiselect</link>
                  </entry>
                  <entry>
                    <link linkend="attr_stylename">styleName</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_presentations">presentations</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_showTotalAggregation">showTotalAggregation</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>table</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left">
              <colspec colname="c1"/>
              <tbody>
                <row>
                  <entry>
                    <link linkend="element_table_actions">actions</link>
                  </entry>
                </row>
                <row>buttonsPanel<entry>
                    <link linkend="section_buttonsPanel">buttonsPanel</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_rowsCount">rowsCount</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="element_t_columns">columns</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="element_t_rows">rows</link>
                  </entry>
                </row>
              </tbody>
            </tgroup>
          </informaltable>
          <para>Атрибуты элемента <link linkend="element_table_columns" id="element_t_columns">columns</link> <link linkend="element_table_columns_column_1">column</link>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="section_gui_aggregation">aggregation</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_clickAction">clickAction</link>
                  </entry><entry align="left">
                    <link linkend="attr_table_column_id">id</link>
                  </entry><entry>
                    <link linkend="attr_resolution">resolution</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_table_column_calculatable">calculatable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_table_column_collapsed">collapsed</link>
                  </entry>
                  <entry>
                    <link linkend="attr_optionsDatasource">optionsDatasource</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_table_column_caption">caption</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_dateFormat">dateFormat</link>
                  </entry>
                  <entry>
                    <link linkend="attr_required">required</link>
                  </entry>
                  <entry>
                    <link linkend="attr_table_column_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_table_column_editable">editable</link>
                  </entry>
                  <entry>
                    <link linkend="attr_requiredMessage">requiredMessage</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Атрибуты <link linkend="element_table_rows" id="element_t_rows">rows</link>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_datasource">datasource</link>
                  </entry>editable</row>
                <row>
                  <entry>
                    <link linkend="attr_headerMode">headerMode</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_gui_treetable">
          <title>TreeTable</title>
          <para>Таблица с иерархией  (<classname>TreeTable</classname>)   − таблица, отображающая иерархию <glossterm linkend="glossary_entity">сущностей</glossterm>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_treeTable.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>treeTable</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_TreeTable_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса иерархичных таблиц: для веб-приложений (класс <classname>WebTreeTable</classname>) и для десктоп-приложений (класс <classname>DesktopTreeTable</classname>). Класс <classname>WebTreeTable</classname> наследуется от абстрактного класса <classname>WebAbstractTable</classname>, класс <classname>DesktopTreeTable</classname> наследуется от абстрактного класса <classname>DesktopAbstractTable</classname>. Оба абстрактных класса реализуют интерфейс <interfacename>TreeTable</interfacename>, который, в свою очередь, наследуется от интерфейса  <interfacename>Table</interfacename>.</para>
          <para>Для того чтобы создать иерахическую таблицу, необходимо в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> задать иерархический <glossterm linkend="glossary_datasource_id">источник данных</glossterm> и определить описание таблицы:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/treeTable/treeTable.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Обязательными для иерархической таблицы являются элементы <link linkend="element_table_columns">columns</link> и  <link linkend="element_table_rows">rows</link>, а также атрибут <link linkend="attr_id">id</link>.</para>
          </warning>
        </section>
        <section id="section_gui_groupTable">
          <title>GroupTable</title>
          <para><link linkend="section_gui_table">Таблица</link> с возможностью динамической группировки по любому полю. Сгруппированными считаются столбцы, размещенные до знака <inlinemediaobject>
              <imageobject>
                <imagedata fileref="img/gui_groupTableIcon.png"/>
              </imageobject>
            </inlinemediaobject>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_groupTable.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>groupTable</classname>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_GroupTable_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса таблиц с группировкой: для веб-приложений (класс <classname>WebGroupTable</classname>) и для десктоп-приложений (класс <classname>DesktopGroupTable</classname>). Оба этих класса реализуют интерфейс <interfacename>GroupTable</interfacename>, который, в свою очередь, наследуется от интерфейса. Класс <classname>WebGroupTable</classname> наследуется от класса <classname>WebAbstractTable</classname>, класс <classname>DesktopGroupTable</classname> наследуется от класса <classname>DesktopAbstractTable</classname>.</para>
          <para>Атрибуты <classname>groupTable</classname>:</para>
          <itemizedlist>
            <listitem>
              <para>group - необязательный элемент, может в единственном экземпляре находиться внутри columns. Содержит набор элементов column, по которым будет выполняться первоначальная группировка.</para>
            </listitem>
          </itemizedlist>
          <para>Для правильного функционирования <classname>GroupTable</classname> должна быть соединена с <link linkend="glossary_datasource_id">GroupDatasource</link>.</para>
          <para>Пример использования:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/groupTable/groupTable.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Элемент <property>group</property> − необязательный элемент, может в единственном экземпляре находиться внутри <link linkend="element_table_columns">columns</link>. Содержит набор элементов <link linkend="element_table_columns_column_1">column</link>, по которым будет выполняться первоначальная группировка.</para>
        </section>
        <section id="section_gui_tree">
          <title>Tree</title>
          <para>Компонент <classname>Tree</classname> представляет иерархическую структуру данных, отображая ее в виде дерева.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/Tree.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>tree</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_tree_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса деревьев: для веб-приложений (класс <classname>WebTree</classname>) и для десктоп-приложений (класс <classname>DesktopTree</classname>). Оба этих класса реализуют интерфейс <interfacename>Tree</interfacename>, который, в свою очередь, наследуется от интерфейса  <interfacename>ListComponent</interfacename>. Класс <classname>WebTree</classname> наследуется от класса <classname>WebAbstractList</classname>, класс <classname>DesktopTree</classname> наследуется от класса <classname>DesktopAbstractActionsHolderComponent</classname>. Класс <classname>WebTree</classname> реализует интерфейс <link linkend="section_interface_wrapper">Component.Wrapper.</link></para>
          <para>Для того чтобы создать компонент дерева, создайте в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> следующий код:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/tree/tree.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Обязательными для дерева являются элемент <property>treechildren</property>, а также атрибут <link linkend="attr_id">id</link>.</para>
          </warning>
          <para>Элемент <property id="element_treechildren">treechildren</property>  декларирует используемый <glossterm linkend="glossary_datasource_id">источник данных</glossterm>. </para>
          <para>Атрибуты <classname>tree</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>editable</row>
                <row><entry>
                    <link linkend="attr_id">id</link>
                  </entry>required<entry/></row>
                <row>
                  <entry align="left">
                    <link linkend="attr_table_multiselect">multiselect</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>tree</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="1" colsep="1" rowsep="1" align="left"><colspec colname="c1"/>c <tbody>
                <row><entry align="left">
                    <link linkend="element_treechildren">treechildren</link>
                  </entry>editable</row>
                <row><entry>
                    <link linkend="element_table_actions">actions</link>
                  </entry>required</row>
              </tbody></tgroup>
          </informaltable>
          <para>Атрибуты <classname>treechildren</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_captionProperty">captionProperty</link>
                  </entry>editable</row>
                <row><entry>
                    <link linkend="attr_datasource">datasource</link>
                  </entry>required</row>
                <row>
                  <entry align="left">hierarchyProperty</entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_gui_progressBar">
          <title>ProgressBar</title>
          <para>Индикатор прогресса (<classname>ProgressBar</classname>) наглядно демонстрирует пользователю, на каком этапе выполнения находится некий процесс, так что пользователь сможет понять, как долго остается ждать его завершения. Индикатор выводится на
экран в виде непрерывно меняющейся полосы. Может отображать конкретное значение прогресса, например, 30%, а может отображать неопределенное состояние.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_progressBar.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>progressBar</classname></para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_progressBar_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса индикатора прогресса: для веб-приложений (класс <classname>WebProgressBar</classname>) и для десктоп-приложений (класс <classname>DesktopProgressBar</classname>). Оба этих класса реализуют интерфейс <interfacename>ProgressBar</interfacename>, который, в свою очередь, наследуется от интерфейса  <interfacename>Component.HasValue</interfacename>. Класс <classname>WebProgressBar</classname> наследуется от абстрактного класса <classname>WebAbstractField</classname>, класс <classname>DesktopProgressBar</classname> наследуется от абстрактного класса <classname>DesktopAbstractComponent</classname>.</para>
          <para>Для создания индикатора необходимо в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm> определить его описание:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/progressBar/progressBar.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Атрибут <link linkend="attr_id">id</link> является обязательным для компонента  <classname>ProgressBar</classname>.</para>
          </warning>
          <para>С помощью атрибута <property id="attr_indeterminate">indeterminate</property> можно задать отображение неопределенного состояния индикатора. Если значение атрибута равно <classname>true</classname>, то индикатор отображает неопределенное состояние. Значение атрибута по умолчанию равно <classname>true</classname>.</para>
          <para>Значения прогресса задачи для индикатора прогресса следует передавать в  значениях типа <type>Float</type> в диапазоне от 0.0 до 1.0.</para>
          <para>Атрибуты <classname>progressBar</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_align">align</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry><entry align="left">
                    <link linkend="attr_stylename">stylename</link>
                  </entry><entry/></row>
                <row>
                  <entry>
                    <link linkend="attr_editable">editable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_enable">enable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_indeterminate">indeterminate</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_upload">
          <title>FileUploadField</title>
          <para>Компонент загрузки файлов (<classname>FileUploadField</classname>) позволяет пользователю загружать файлы на сервер. Компонент представляет собой кнопку, при нажатии на которую на экране отображается окно загрузки файла, содержащее список файлов некоторой директории. В списке можно выбрать только один файл для загрузки.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_upload.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>upload</classname>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_FileUploadField_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса компонентов загрузки файлов: для веб-приложений (класс <classname>WebFileUploadField</classname>) и для десктоп-приложений (класс <classname>DesktopFileUploadField</classname>). Оба этих класса реализуют интерфейс <interfacename>FileUploadField</interfacename>, который, в свою очередь, наследуется от интерфейсов  <link linkend="section_interface_component">Component</link>, <link linkend="section_interface_hasCaption">Component.HasCaption</link>, <link linkend="section_interface_belongToFrame">Component.BelongToFrame</link>. Класс <classname>WebFileUploadField</classname> наследуется от абстрактного класса <classname>WebAbstractComponent</classname>, класс <classname>DesktopFileUploadField</classname> наследуется от абстрактного класса <classname>DesktopAbstractComponent</classname>.</para>
          <para>Ниже расположен пример, содержащий обработчик загрузки файла. В этом обработчике написан программный код, обеспечивающий вывод на экран сообщения об успешной или не успешной загрузке файла, а также вывод названия файла в компоненте  надписи.</para>
          <para>Для начала определим описание компонента в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/upload/upload.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Программный код <glossterm linkend="glossary_controller_id">контроллера</glossterm> выглядит следующим образом:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/upload/uploadContr.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_uploadRez.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>upload</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry><entry align="left">
                    <link linkend="attr_width">width</link>
                  </entry><entry/></row>
                <row>
                  <entry>
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                  <entry/>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_visible">visible</link>
                  </entry>
                  <entry/>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_gui_fileMultiUploadField">
          <title>FileMultiUploadField</title>
          <para>Компонент для множественной загрузки файлов позволяет пользователю загружать файлы на сервер. Компонент представляет собой кнопку, при нажатии на которую на экране отображается окно загрузки файлов, содержащее список файлов некоторой директории. В списке можно выбрать сразу несколько файлов для загрузки.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_multipleUpload.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>multiupload</classname>.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_FileMultiUploadField_dia.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Существует два класса компонентов множественной загрузки файлов: для веб-приложений (класс <classname>WebFileMultiUploadField</classname>) и для десктоп-приложений (класс <classname>DesktopFileMultiUploadField</classname>). Оба этих класса реализуют интерфейс <interfacename>FileMultiUploadField</interfacename>, который, в свою очередь, наследуется от интерфейсов  <link linkend="section_interface_component">Component</link>, <link linkend="section_interface_hasCaption">Component.HasCaption</link>, <link linkend="section_interface_belongToFrame">Component.BelongToFrame</link>. Класс <classname>WebFileMultiUploadField</classname> наследуется от абстрактного класса <classname>WebAbstractComponent</classname>, класс <classname>DesktopFileMultiUploadField</classname> наследуется от абстрактного класса <classname>DesktopAbstractComponent</classname>.</para>
          <para>Ниже расположен пример, содержащий обработчик загрузки файлов. В этом обработчике написан программный код, обеспечивающий вывод на экран сообщения об успешной или не успешной загрузке файлов, а также вывод названий файлов в <link linkend="section_textField">текстовое поле</link>.</para>
          <para>Для начала определим описание компонента в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/multipleUpload/multipleUpload.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Программный код <glossterm linkend="glossary_controller_id">контроллера</glossterm> выглядит следующим образом:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/multipleUpload/multipleUploadContr.txt" encoding="UTF-8" parse="text"/></programlisting>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_multipleUploadRez.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>multiupload</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry><entry align="left">
                    <link linkend="attr_width">width</link>
                  </entry><entry/></row>
                <row>
                  <entry>
                    <link linkend="attr_description">description</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                  <entry/>
                  <entry/>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_visible">visible</link>
                  </entry>
                  <entry/>
                  <entry/>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
      </section>
      <section id="section_gui_layouts">
        <title>Размещение компонентов внутри контейнера</title>
        <para><link linkend="section_gui_split">SplitPanel</link></para>
        <para><link linkend="section_gui_grid">GridLayout</link></para>
        <para><link linkend="section_gui_scrollBox">ScrollBoxLayout</link></para>
        <para><link linkend="section_gui_box">BoxLayout</link></para>
        <para><link linkend="section_buttonsPanel">ButtonsPanel</link></para>
        <para><link linkend="section_gui_groupBox">GroupBoxLayout</link></para>
        <para><link linkend="section_gui_frame">IFrame</link></para>
        <para><link linkend="section_gui_tabsheet">Tabsheet</link></para>
        <section id="section_gui_split">
          <title>SplitPanel</title>
          <para>Панель с разделителем (<classname>SplitPanel</classname>) − контейнер, разбитый на две области, размер которых по одному из направлений (горизонтали либо вертикали) можно менять путем перемещения разделителя. На рисунке показан пример разбивки области окна на три панели. Во внешней панели формируется горизонтальная граница, которая отделяет нижнюю панель от верхней. Верхняя панель разделяется по вертикали.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_splitPanel.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>split</classname>.</para>
          <para>Для создания панели с разделителем нужно определить ее описание в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/split/split.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>При создании панели с разделителем нужно указать ориентацию разделителия с помощью атрибута <property id="attr_layout_orientation">orientation</property>. По умолчанию значение атрибута равно <classname>vertical</classname>.</para>
          <para id="attr_layout_pos"><property>pos</property> − необязательный атрибут, определяет процентное соотношение областей. Например, pos=&quot;30%&quot; означает соотношение областей 30/70. По-умолчанию 50/50.</para>
          <warning>
            <para>Обязательными вложенными элементами являются два контейнера или компонента.</para>
          </warning>
          <para>Атрибуты <classname>split</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_layout_pos">pos</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_layout_orientation">orientation</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_buttonsPanel">
          <title>ButtonsPanel</title>
          <para>Компонент, унифицирующий использование и размещение кнопок для управления данными в таблице.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_buttonsPanel.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>buttonsPanel</classname>.</para>
          <para>Для создания панели с кнопками нужно определить ее описание в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>.</para>
          <para>Атрибуты <classname>buttonsPanel</classname>:</para>
          <itemizedlist>
            <listitem>
              <para><link linkend="attr_id">id</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_visible">visible</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_align">align</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_width">width</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_height">height</link></para>
            </listitem>
          </itemizedlist>
        </section>
        <section id="section_gui_box">
          <title>BoxLayout</title>
          <para><classname>BoxLayout</classname> представляет собой контейнер с последовательным размещением компонентов.</para>
          <para>Существует 3 типа <classname>BoxLayout</classname>, определяемых именем XML-элемента:</para>
          <itemizedlist>
            <listitem>
              <para><classname>hbox</classname> − горизонтальное расположение компонентов</para>
              <figure>
                <title/>
                <mediaobject>
                  <imageobject>
                    <imagedata align="center" fileref="img/gui_hbox.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
              <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/box/hbox.txt" encoding="UTF-8" parse="text"/></programlisting>
            </listitem>
            <listitem>
              <para><classname>vbox</classname> − вертикальное расположение компонентов. <classname>vbox</classname> имеет 100% ширину по умолчанию</para>
              <figure>
                <title/>
                <mediaobject>
                  <imageobject>
                    <imagedata align="center" fileref="img/gui_vbox.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
              <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/box/vbox.txt" encoding="UTF-8" parse="text"/></programlisting>
            </listitem>
            <listitem>
              <para><classname>flowbox</classname> − горизонтальное расположение компонентов с переносом вниз. При недостатке места по горизонтали непомещающиеся компоненты будут перенесены &quot;на следующую строку&quot; (поведение аналогично <application>Swing</application><classname> FlowLayout</classname>)</para>
              <figure>
                <title/>
                <mediaobject>
                  <imageobject>
                    <imagedata align="center" fileref="img/gui_flowbox.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
              <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/box/flowbox.txt" encoding="UTF-8" parse="text"/></programlisting>
            </listitem>
          </itemizedlist>
          <para>Могут быть использованы следующие XML-атрибуты:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_align">align</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_id">id</link>
                  </entry><entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_expand">expand</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_margin">margin</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_spacing">spacing</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_gui_groupBox">
          <title>GroupBox</title>
          <para>Контейнер, позволяющий выделить рамкой группу объектов, задать им общий заголовок и описание. Кроме того, он умеет сворачивать свое содержимое.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_groupBox.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>groupBox</classname>.</para>
          <para>Для создания контейнера с названием и рамкой нужно определить его описание в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/groupBox/groupBox.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Атрибут <property id="attr_group_orientation">orientation</property>  задает направление расположения вложенных компонентов − <classname>horizontal</classname> или <classname>vertical</classname>. По умолчанию значением атрибута является <classname>vertical</classname>.</para>
          <para><property id="attr_group_collapsable">collapsable</property> − необязательный атрибут, в значении <classname>true</classname> компонент может сворачивать свое содержимое. В верхнем нижнем углу контейнера появляется значок <inlinemediaobject>
              <imageobject>
                <imagedata fileref="img/gui_groupBox_minus.png"/>
              </imageobject>
            </inlinemediaobject>/<inlinemediaobject>
              <imageobject>
                <imagedata fileref="img/gui_groupBox_plus.png"/>
              </imageobject>
            </inlinemediaobject>.</para>
          <para><property id="attr_group_collapsed">collapsed</property> − необязательный атрибут, в значении <classname>true</classname> компонент будет свернут по умолчанию.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_groupBox_collapsed.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>Атрибуты <classname>groupBox</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_caption">caption</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_description">description</link>
                  </entry><entry>
                    <link linkend="attr_id">id</link>
                  </entry><entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_group_collapsable">collapsable</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_expand">expand</link>
                  </entry>
                  <entry>
                    <link linkend="attr_orientation">orientation</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_group_collapsed">collapsed</link>
                  </entry>
                  <entry>
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_spacing">spacing</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_gui_grid">
          <title>GridLayout</title>
          <para>Контейнер, располагающий компоненты по сетке.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_gridlayout.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>grid</classname>.</para>
          <para>Для создания контейнера с табличным расположением нужно определить его описание в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/grid/grid.txt" encoding="UTF-8" parse="text"/></programlisting>
          <warning>
            <para>Обязательными вложенными элементами являются элементы columns и rows. </para>
          </warning>
          <para><property id="attr_layout_rows">rows</property> − обязательный элемент, содержит последовательность строк (row). Хотя бы один элемент строки является обязательным.</para>
          <para><property id="attr_layout_row">row</property> − элемент строки, контейнер для содержимого ряда. Состоит из контейнеров или  компонентов.</para>
          <para><property id="attr_grid_flex_row">flex</property> − необязательный атрибут для элемента <property>row</property>, задает соотношение высот рядов сетки.</para>
          <para><property id="attr_grid_columns">columns</property> − обязательный элемент, содержит последовательность <property>column</property>.</para>
          <para>Атрибут <property id="attr_grid_count">count</property> − необязательный атрибут, задает количество колонок, если не заданы элементы <property>column</property>.</para>
          <para><property id="attr_grid_column">column</property> − необязательный элемент для элемента <link linkend="attr_grid_columns">columns</link>, декларирует атрибуты колонок сетки.</para>
          <para>Атрибут <property id="attr_grid_flex_column">flex</property> − необязательный атрибут, задает соотношение ширин колонок.</para>
          <para>Атрибуты <classname>grid</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_height">height</link>
                  </entry>editable<entry align="left">
                    <link linkend="attr_spacing">spacing</link>
                  </entry><entry>
                    <link linkend="attr_width">width</link>
                  </entry></row>
                <row>
                  <entry>
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry align="left">
                    <link linkend="attr_stylename">styleNamedth</link>
                  </entry>
                </row>
                <row>
                  <entry align="left">
                    <link linkend="attr_margin">margin</link>
                  </entry>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Элементы <classname>grid</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_grid_columns">columns</link>
                  </entry>editable</row>
                <row>
                  <entry>
                    <link linkend="attr_layout_rows">rows</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
          <para>Атрибуты <classname>columns</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_grid_count">count</link>
                  </entry>editable</row>
              </tbody></tgroup>
          </informaltable>
          <para>Атрибуты <classname>row</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_align">align</link>
                  </entry>editable</row>
                <row>
                  <entry>
                    <link linkend="attr_grid_flex_row">flex</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_spacing">spacing</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_visible">visible</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_gui_scrollBox">
          <title>ScrollBoxLayout</title>
          <para><classname>ScrollBoxLayout</classname> − контейнер, которые позволяет прокручивать свое содержимое.</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_scrollBox.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>scrollBox</classname></para>
          <para>Для создания контейнера с табличным расположением нужно определить его описание в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/scrollBox/scrollBox.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>С помощью атрибута <property id="attr_scroll_orientation">orientation</property> можно задавать направление расположения вложенных компонентов − <classname>horizontal</classname> или <classname>vertical</classname>. По умолчанию значением атрибута является <classname>vertical</classname>.</para>
          <warning>
            <para>Вложенные в <classname>scrollBox</classname> компоненты должны иметь фиксированные размеры или размеры по умолчанию. Нельзя устанавливать <classname>height=&quot;100%&quot;</classname> или <classname>width=&quot;100%&quot;</classname>.</para>
          </warning>
          <para>Атрибуты <classname>scrollBox</classname>:</para>
          <informaltable frame="none" pgwide="0" align="left">
            <tgroup cols="4" colsep="1" rowsep="1" align="left"><colspec colname="c1"/><colspec colname="c2"/><colspec colname="c3"/><colspec colname="c4"/>c <tbody>
                <row><entry align="left">
                    <link linkend="attr_align">align</link>
                  </entry><entry>
                    <link linkend="attr_scroll_orientation">orientation</link>
                  </entry>editable</row>
                <row>
                  <entry>
                    <link linkend="attr_height">height</link>
                  </entry>
                  <entry>
                    <link linkend="attr_spacing">spacing</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_id">id</link>
                  </entry>
                  <entry>
                    <link linkend="attr_stylename">stylename</link>
                  </entry>
                </row>
                <row>
                  <entry>
                    <link linkend="attr_margin">margin</link>
                  </entry>
                  <entry>
                    <link linkend="attr_width">width</link>
                  </entry>
                </row>
              </tbody></tgroup>
          </informaltable>
        </section>
        <section id="section_gui_tabsheet">
          <title>Tabsheet</title>
          <para>Контейнер, содержащий закладки (<parameter>tabs</parameter>).</para>
          <figure>
            <title/>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/gui_tabsheet.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <para>XML-имя компонента: <classname>tabsheet</classname>.</para>
          <para>Атрибуты <classname>tabsheet</classname>:</para>
          <itemizedlist>
            <listitem>
              <para><link linkend="attr_id">id</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_stylename">stylename</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_height">height</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_width">width</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_visible">visi</link>ble</para>
            </listitem>
          </itemizedlist>
          <para><parameter>tabsheet</parameter> должен содержать элементы <parameter>tab</parameter>, определяющие содержимое закладок. Каждый элемент <parameter>tab</parameter> может содержать следующие атрибуты:</para>
          <itemizedlist>
            <listitem>
              <para><property>id</property> − идентификатор закладки. Следует отметить, что закладка не является компонентом, и данный идентификатор используется только в рамках <parameter>Tabsheet</parameter>.</para>
            </listitem>
            <listitem>
              <para><property>caption</property> − заголовок закладки. Атрибут должен содержать ключ сообщения в <glossterm linkend="glossary_localized_folders_id">локализованном пакете сообщений</glossterm>.</para>
            </listitem>
            <listitem>
              <para><property>enable</property>. Это состояние закладки. Может иметь значение <property>true</property> (доступна) или <property>false</property> (недоступна). По умолчанию <property>enable = &quot;true&quot;</property>.</para>
            </listitem>
            <listitem>
              <para><property>lazy</property>. Задает отложенную загрузку содержимого закладки. Может иметь значение <property>true</property> или <property>false</property>. При отображении экрана lazy-закладки не загружают свое содержимого, что приводит к созданию меньшего количества компонентов в памяти и  к меньшему количеству запросов к БД. Компоненты закладки загружаются только в тот момент, когда пользователь выбирает данную закладку.
Если компоненты lazy-закладки требуют инициализации, проводить ее нужно не напрямую в методе <methodname>init()</methodname> <glossterm linkend="glossary_controller_id">контроллера</glossterm>, а в слушателе на переключение закладок <classname>Tabsheet.TabChangeListener</classname>.</para>
            </listitem>
          </itemizedlist>
        </section>
        <section id="section_gui_frame">
          <title>IFrame</title>
          <para>Фреймы предназначены для декомпозиции и многократного использования частей экранов.</para>
          <para>Фрейм включается в экран с помощью элемента iframe.</para>
          <para>Атрибуты:</para>
          <itemizedlist>
            <listitem>
              <para><link linkend="attr_id">id</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_stylename">stylename</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_visible">visible</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_height">height</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_width">width</link></para>
            </listitem>
            <listitem>
              <para><link linkend="attr_align">align</link></para>
            </listitem>
            <listitem>
              <para>src - путь к XML-дескриптору фрейма</para>
            </listitem>
            <listitem>
              <para>src - путь к XML-дескриптору фрейма</para>
            </listitem>
          </itemizedlist>
          <para>Обязательно должен быть указан один из атрибутов src или screen.</para>
          <para>Дескриптор фрейма идентичен описателю окна и может содержать собственный metadataContext, dsContext, messagesPack. Кроме того, фрейм может иметь собственный контроллер.</para>
          <para>Правила взаимодействия окна и вложенного в него фрейма:</para>
          <itemizedlist>
            <listitem>
              <para>из окна обращаться к компонентам фрейма можно через точку: frame_id.component_id</para>
            </listitem>
            <listitem>
              <para>из контроллера фрейма получить компонент окна можно обычным вызовом getComponent(component_id), но только в том случае, если компонент с таким именем не объявлен в самом фрейме. Т.е. компоненты фрейма маскируют компоненты окна.</para>
            </listitem>
            <listitem>
              <para>из фрейма получить датасорс окна можно простым вызовом getDsContext().get(ds_id) либо в запросе ds$ds_id , но только в том случае, если датасорс с таким именем не объявлен в самом фрейме (аналогично компонентам).</para>
            </listitem>
            <listitem>
              <para>из окна получить датасорс фрейма можно только через итерацию по getDsContext().getChildren()</para>
            </listitem>
          </itemizedlist>
          <para>При коммите окна вызывается также коммит измененных датасорсов фрейма.</para>
        </section>
      </section>
      <section>
        <title>Разное</title>
        <section>
          <title>AccessControl</title>
          <para>Компонент <classname>accessControl</classname> предназначен для декларативного управления доступом к частям экрана. Он представляет собой контейнер, который никак не отображает себя на экране, а только управляет атрибутами <parameter>visible</parameter> и <parameter>editable</parameter> входящих в него компонентов.</para>
          <para>Состояние управляемых компонентов определяется на основе двух элементов, вложенных в <classname>accessControl</classname>: <parameter>visible</parameter> и <parameter>editable</parameter>.</para>
          <para>Соответствующее значение принимается либо из скрипта, возвращающего <type>boolean</type>, либо из свойства объекта <classname>AccessData</classname>, связанного с компонентом (см. ниже).
Скрипт задается либо атрибутом <parameter>script</parameter>, либо in-place в тексте элемента. 
Свойство объекта <classname>AccessData</classname> задается атрибутом <parameter>property</parameter> и имеет больший приоритет, чем скрипт.</para>
          <warning>
            <para>В случае <parameter>visible=false</parameter> вложенные компоненты вообще не создаются, поэтому будьте осторожны при обращении к ним из контроллера.</para>
          </warning>
          <example>
            <title>Пример</title>
            <programlisting>&lt;tab id=&quot;mainTab&quot; caption=&quot;msg://mainTab&quot;&gt;
&lt;accessControl data=&quot;workflow.client.web.ui.card.CardAccessData&quot; param=&quot;accessData&quot;&gt;
&lt;editable property=&quot;notStarted&quot;/&gt;

&lt;vbox margin=&quot;true&quot; expand=&quot;attachmentsPane&quot;&gt;
                ...</programlisting>
          </example>
          <section>
            <title>Объект AccessData</title>
            <para>В связи с тем, что одни и те же параметры доступа могут многократно потребоваться в разных частях экрана и в коде контроллера, компонент <classname>accessControl</classname> может быть связан с объектом Java|Groovy, вычисляющим и хранящим эти параметры. Т.о. дорогостоящая инициализация параметра доступа производится только один раз, и затем доступна на протяжении жизни экрана.</para>
            <para>Для связи компонента с данными доступа создайте класс, унаследованный от <classname>AbstractAccessData</classname> и задайте следующие атрибуты компонента <classname>accessControl</classname>:</para>
            <itemizedlist>
              <listitem>
                <para><emphasis role="bold">data</emphasis> − имя класса <classname>AccessData</classname></para>
              </listitem>
              <listitem>
                <para><emphasis role="bold">param</emphasis> − имя параметра экрана, в котором будет сохранен объект <classname>AccessData</classname></para>
              </listitem>
            </itemizedlist>
            <para>В момент создания экрана загрузчик компонента <classname>accessControl</classname> проверяет наличие экземпляра <classname>AccessData</classname> в указанном параметре, и если его там нет, создает новый экземпляр.</para>
            <para>В дальнейшем в коде контроллера можно получить экземпляр <classname>AccessData</classname> из параметров экрана, например:</para>
            <programlisting>AbstractWfAccessData accessData = getContext().getParamValue(&quot;accessData&quot;);</programlisting>
            <para>При создании класса <classname>AccessData</classname> следует иметь в виду, что в параметры экрана-редактора всегда передается параметр <parameter>param$item</parameter>, содержащий текущий редактируемый экземпляр сущности. Однако этот экземпляр загружен по view вызывающего экрана, а не по view редактора.</para>
            <para>Свойства <classname>AccessData</classname>, на которые можно ссылаться из компонента <classname>accessControl</classname>, должны быть реализованы по стандарту JavaBeans: методами с сигнатурой boolean <methodname>getXxx()</methodname></para>
            <example>
              <title>Пример реализации AccessData</title>
              <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/CardAccessData.java" encoding="UTF-8" parse="text"/></programlisting>
            </example>
          </section>
        </section>
        <section id="section_gui_action">
          <title>Action</title>
          <para><interfacename>Action</interfacename> − интерфейс, абстрагирующий действие от визуального компонента.</para>
          <para>Визуальный компонент, содержащий одно действие, реализует интерфейс <interface>Component.ActionOwner</interface>. Это, например, <classname>Button</classname>.</para>
          <para>Визуальный компонент, содержащий несколько действий, реализует интерфейс <interface>Component.ActionsHolder</interface>. Это <classname>Window</classname>, <classname>IFrame</classname>, <classname>Table</classname> и ее наследники, <classname>Tree</classname>, <classname>PopupButton</classname>, <classname>PickerField</classname>, <classname>LookupPickerField</classname>.</para>
          <section>
            <title>Декларативное создание действий</title>
            <para>В дескрипторе экрана может быть задан набор действий для некоторого <classname>ActionsHolder</classname>.</para>
            <itemizedlist>
              <title>Доступные атрибуты действия</title>
              <listitem>
                <para><parameter>id</parameter> − идентификатор, должен быть уникален в рамках данного <classname>ActionsHolder</classname></para>
              </listitem>
              <listitem>
                <para>caption</para>
              </listitem>
              <listitem>
                <para>icon</para>
              </listitem>
              <listitem>
                <para>enable</para>
              </listitem>
              <listitem>
                <para>visible − в отличие от компонентов Groovy-выражения не поддерживаются</para>
              </listitem>
              <listitem>
                <para><parameter>invoke</parameter> − имя вызываемого метода контроллера. Метод должен быть <classname>public</classname>, не возвращать результата, и либо не иметь аргументов, либо иметь один аргумент типа <classname>Component</classname>. Если метод имеет аргумент <classname>Component</classname>, то при вызове в него будет передан экземпляр визуального компонента, запустившего данное действие.</para>
              </listitem>
              <listitem>
                <para><parameter>shortcut</parameter> − доступен только для действий, задаваемых в окне или фрейме. Задает комбинацию клавиш для вызова.</para>
              </listitem>
            </itemizedlist>
            <para>Примеры:</para>
            <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/action/example1.txt" encoding="UTF-8" parse="text"/></programlisting>
            <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/action/example2.txt" encoding="UTF-8" parse="text"/></programlisting>
            <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/action/example3.txt" encoding="UTF-8" parse="text"/></programlisting>
          </section>
          <section>
            <title>Использование в кнопках</title>
            <para>Действия, заданные для некоторого <classname>ActionsHolder</classname>, могут быть использованы в компонентах <classname>ActionOwner</classname>, например в <classname>Button</classname>. Для этого достаточно указать полное имя действия в соотв. атрибуте. Например:</para>
            <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/action/example4.txt" encoding="UTF-8" parse="text"/></programlisting>
            <para>При этом Button возьмет значения атрибутов caption, icon, enable, visible из назначенного действия.</para>
          </section>
          <section>
            <title>Стандартные действия</title>
            <para>Для наследников ListComponent (это Table и Tree) существут набор стандартных действий, определяемых перечислением ListActionType. Для таких действий не нужно определять никаких атрибутов, кроме идентификатора. Например:</para>
            <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/action/example5.txt" encoding="UTF-8" parse="text"/></programlisting>
            <para>Для компонентов PickerField и LookupPickerField существут набор стандартных действий, определяемых перечислением PickerField.ActionType. Для таких действий не нужно определять никаких атрибутов, кроме идентификатора. Например:</para>
            <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/action/example6.txt" encoding="UTF-8" parse="text"/></programlisting>
          </section>
          <section>
            <title>Программное создание и управление действиями</title>
            <para>Базовым классом реализации действий является <classname>AbstractAction</classname>. Пример использования:</para>
            <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/action/example7.txt" encoding="UTF-8" parse="text"/></programlisting>
            <para>При выполнении метода <methodname>addAction()</methodname> реализация <classname>ActionsHolder</classname> проверяет, нет ли уже в нем действия с таким же идентификатором. Если есть, то имеющееся действие будет заменено на новое переданное. Поэтому можно безопасно например декларировать стандартное действие в дескрипторе экрана, а затем в контроллере создать новое с переопределенными методами, и добавить в <classname>ActionsHolder</classname>.</para>
            <para>Кроме создания наследников <classname>AbstractAction</classname> или стандартных действий, возможно конфигурирование декларативно созданных действий путем получения их в контроллере и установки атрибутов. Например:</para>
            <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/action/example8.txt" encoding="UTF-8" parse="text"/></programlisting>
            <para>При этом во всех визуальных компонентах, связанных с данным действием, значение соответствующего атрибута также изменится.</para>
          </section>
        </section>
        <section id="section_gui_aggregation">
          <title>Aggregation</title>
          <para>Механизм задания аггрегаций для колонок в Table.</para>
          <itemizedlist>
            <title>Атрибуты aggregation</title>
            <listitem>
              <para>type −  функция аггрегирования:</para>
              <itemizedlist>
                <listitem>
                  <para>SUM − сумма</para>
                </listitem>
                <listitem>
                  <para>AVG − среднее значение</para>
                </listitem>
                <listitem>
                  <para>COUNT − количество</para>
                </listitem>
                <listitem>
                  <para>MIN − минимальное значение</para>
                </listitem>
                <listitem>
                  <para>MAX − максимальное значение</para>
                </listitem>
              </itemizedlist>
            </listitem>
            <listitem>
              <para>formatter − задает формат вывода аггрегированного значения.</para>
            </listitem>
          </itemizedlist>
          <para>Логика применения форматирования к аггрегированному значению следующая: если в элементе <classname>aggregation</classname> указан <parameter>formatter</parameter>, то применяется он; иначе применяется <parameter>formatter</parameter> соответствующего аггрегированному значению <parameter>datatype</parameter>.</para>
          <example>
            <title>Пример использования</title>
            <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_gui/aggregation/example1.txt" encoding="UTF-8" parse="text"/></programlisting>
          </example>
        </section>
        <section id="section_gui_presentation">
          <title>Presentation </title>
        </section>
        <section id="section_gui_themes_creation">
          <title>Создание темы приложения</title>
        </section>
      </section>
      <section>
        <title>Атрибуты</title>
        <variablelist>
          <varlistentry>
            <term>align</term>
            <listitem>
              <para>Атрибут, задающий расположение компонента относительно вышестоящего контейнера.</para>
              <para>Возможные значения:</para>
              <itemizedlist>
                <listitem>
                  <para>TOP_RIGHT</para>
                </listitem>
                <listitem>
                  <para>TOP_LEFT</para>
                </listitem>
                <listitem>
                  <para>TOP_CENTER</para>
                </listitem>
                <listitem>
                  <para>MIDDLE_RIGHT</para>
                </listitem>
                <listitem>
                  <para>MIDDLE_LEFT</para>
                </listitem>
                <listitem>
                  <para>MIDDLE_CENTER</para>
                </listitem>
                <listitem>
                  <para>BOTTOM_RIGHT</para>
                </listitem>
                <listitem>
                  <para>BOTTOM_LEFT</para>
                </listitem>
                <listitem>
                  <para id="attr_align">BOTTOM_CENTER</para>
                </listitem>
              </itemizedlist>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_caption">
            <term>caption</term>
            <listitem>
              <para>XML-атрибут, устанавливающий заголовок для визуального компонента.</para>
              <para>Значением атрибута должна быть либо собственно строка сообщения, либо ключ в пакете сообщений. В случае ключа значение должно начинаться с префикса msg://</para>
              <para>Спсобы задания ключа:</para>
              <itemizedlist>
                <listitem>
                  <para>Короткий ключ − при этом сообщение ищется в пакете, заданном для данного экрана:</para>
                  <programlisting>caption=&quot;msg://infoFieldCaption&quot;</programlisting>
                </listitem>
                <listitem>
                  <para>Полный ключ, с заданием пакета:</para>
                  <programlisting>caption=&quot;msg://com.haulmont.refapp.gui.app/infoFieldCaption&quot;</programlisting>
                </listitem>
              </itemizedlist>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_captionProperty">
            <term>captionProperty</term>
            <listitem>
              <para>XML-атрибут визуального компонента, реализующего интерфейс <interfacename>OptionsField</interfacename>.</para>
              <para>Задает имя атрибута сущности, которую содержит <glossterm linkend="glossary_datasource_id">источник данных</glossterm>, используемый для формирования списка опций (<link linkend="attr_optionsDatasource">optionsDatasource</link>).</para>
              <para>Если данный атрибут не задан, список опций будет содержать Instance Name экземпляров, содержащихся в списке.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_clickAction">
            <term>clickAction</term>
            <listitem>
              <para>Атрибут содержит описание действия, которое будет выполнено при клике в ячейке или в поле (для компонента <link linkend="section_gui_fieldGroup">FieldGroup</link>). Возможны два типа действий:</para>
              <itemizedlist>
                <listitem>
                  <para><classname>open</classname> − открывает для <glossterm linkend="glossary_entity">сущности</glossterm>, отображаемой в ячейке, экран редактирования с указанным именем, например: <classname>clickAction=&quot;open:sec$User.edit&quot;</classname>. Имя сущности отображается в виде ссылки:</para>
                  <figure>
                    <title/>
                    <mediaobject>
                      <imageobject>
                        <imagedata align="center" fileref="img/gui_clickAction_open.png"/>
                      </imageobject>
                    </mediaobject>
                  </figure>
                </listitem>
                <listitem>
                  <para><classname>invoke</classname> − вызывает метод <glossterm linkend="glossary_controller_id">контроллера</glossterm> экрана с указанным именем, например: <classname>clickAction=&quot;invoke:onClick&quot;</classname>. Метод должен иметь единственный параметр типа <type>Object</type>, в который будет передан экземпляр сущности, отображаемой в ячейке.</para>
                </listitem>
              </itemizedlist>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_datasource">
            <term>datasource</term>
            <listitem>
              <para>XML-атрибут компонента, реализующего интерфейс <interfacename>DatasourceComponent</interfacename>.</para>
              <para>Предназначен для задания <link linkend="glossary_datasource_id">источника данных</link> и должен содержать имя источника данных, описанного в секции <parameter>dsContext</parameter> <link linkend="glossary_xml_descriptor_id">дескриптора</link> экрана.</para>
              <para>Атрибут property является обязательным, иначе возникает ошибка java.lang.IllegalStateException: Can&apos;t set assign datasource &apos;sampleDs&apos; for component &apos;labelInfo&apos; due &apos;property&apos; attribute is not defined. </para>
              <para>Смотрите также атрибут property.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_description">
            <term>description</term>
            <listitem>
              <para>Атрибут, задающий текст подсказки для компонента.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_editable">
            <term>editable</term>
            <listitem>
              <para>XML-атрибут, указывающий на возможность редактирования содержимого (не путать с <link linkend="attr_enable">enable</link>).</para>
              <para>Возможные значения - true, false. По умолчанию true.</para>
            </listitem>
            <listitem>На возможность редактирования содержимого для компонента, связанного с данными (наследника DatasourceComponent или List), влияет также Security. Если по данным security данный компонент должен быть недоступен для редактирования, значение атрибута editable не принимается во внимание.</listitem>
          </varlistentry>
          <varlistentry id="attr_enable">
            <term>enable</term>
            <listitem>
              <para>Атрибут компонента, устанавливающий его состояние &quot;enabled/disabled&quot; − доступен/недоступен.</para>
              <para>Если компонент недоступен, то он не принимает фокус ввода. Недоступность контейнера приводит к тому, что все его компоненты также становятся недоступными.

Возможные значения − true, false.

По умолчанию у всех компонентов enable = true.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_expand">
            <term>expand</term>
            <listitem>
              <para>Атрибут контейнера для управления его внутренней компоновкой.</para>
              <para>Задает компонент внутри контейнера, который необходимо &quot;развернуть&quot;, т.е. установить ему максимально возможную высоту и ширину.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_height">
            <term>height</term>
            <listitem>
              <para>Атрибут, устанавливающий высоту компонента.</para>
              <para>Может быть задана в пикселях либо в процентах от высоты вышестоящего контейнера. Например: 100px, 100%, 50. Если единица измерения не указана, подразумевается высота в пикселях.</para>
              <para>Простановка значения в % означает, что компонент по высоте займет соотвествующую часть пространства, предоставляемого контейнером более высокого уровня.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_icon">
            <term>icon</term>
            <listitem>
              <para>XML-атрибут, устанавливающий пиктограмму для визуального компонента.</para>
              <para>Значением атрибута должен быть путь к файлу пиктограммы относительно каталога темы. Например:</para>
              <programlisting>icon=&quot;icons/create.png&quot;</programlisting>
              <para>Если пиктограмма должна быть выбрана в зависимости от языка пользователя, можно указать путь к ней в пакете сообщений, а в атрибуте icon − ключ сообщения, например:</para>
              <programlisting>icon=&quot;msg://addIcon&quot;</programlisting>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_id">
            <term>id</term>
            <listitem>
              <para>Идентификатор компонента.</para>
              <para>Возможное значение − любой допустимый Java-идентификатор. Рекомендуется использовать только camelСase, например, <classname>userGrid</classname>, <classname>filterPanel</classname>.

Может быть указан для любого компонента и должен быть уникальным в пределах экрана.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_margin">
            <term>margin</term>
            <listitem>
              <para>Атрибут margin устанавливает наличие отступа между внешними границами и содержимым контейнера.</para>
              <para>Может иметь 2 вида значений:</para>
              <itemizedlist>
                <listitem>
                  <para>margin=&quot;true&quot; - установить отступ со всех сторон сразу</para>
                </listitem>
                <listitem>
                  <para>margin=&quot;true;false;true;false;&quot; - установить отступ только сверху и снизу (формат значения &quot;сверху,справа,снизу,слева&quot;)</para>
                </listitem>
              </itemizedlist>
              <para>По умолчанию отступы отсутствуют.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_optionsDatasource">
            <term>optionsDatasource</term>
            <listitem>
              <para>XML-атрибут визуального компонента, реализующего интерфейс <interfacename>OptionsField</interfacename>.</para>
              <para>Задает имя <glossterm linkend="glossary_datasource_id">источника данных</glossterm>, используемого для формирования списка опций.</para>
              <para>Совместно с optionsDatasource может использоваться атрибут <link linkend="attr_captionProperty">captionProperty</link>.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_property">
            <term>property</term>
            <listitem>
              <para>XML-атрибут компонента, реализующего интерфейс <interfacename>DatasourceComponent</interfacename>.</para>
              <para>Предназначен для задания имени атрибута сущности, значение которого будет отображаться/редактироваться данным визуальным компонентом.</para>
              <para>Используется всегда совместно с атрибутом <link linkend="attr_datasource">datasource</link>.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_required">
            <term>required</term>
            <listitem>
              <para>XML-атрибут визуального компонента, реализующего интерфейс Field. Указывает, что в данное поле обязательно должно быть введено значение.</para>
              <para>Возможные значения атрибута - true, false. По умолчанию false.</para>
              <para>Совместно с required может использоваться атрибут requiredMessage.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_requiredMessage">
            <term>requiredMessage</term>
            <listitem>
              <para>XML-атрибут, используемый совместно с атрибутом <link linkend="attr_required">required</link>. Позволяет установить сообщение, выводимое пользователю в случае нарушения требования <link linkend="attr_required">required</link>.</para>
              <para>Атрибут должен содержать ключ сообщения в пакете, например: requiredMessage=&quot;msg://infoTextField.requiredMessage&quot;</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_spacing">
            <term>spacing</term>
            <listitem>
              <para>Атрибут spacing устанавливает наличие отступов между компонентами внутри контейнера.</para>
              <para>Возможные значения - true, false.</para>
              <para>По умолчанию отступы отсутствуют.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_stylename">
            <term>stylename</term>
            <listitem>
              <para>Атрибут, задающий имя стиля компонента.</para>
              <para>Для веб-клиента стиль задается в CSS.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_visible">
            <term>visible</term>
            <listitem>
              <para>Атрибут   либо элемент видимости компонента.</para>
              <para>Возможные значения − true, false, либо выражение Groovy с boolean-результатом. Если выражение длинное, имеет смысл использовать не атрибут, а элемент visible внутри текущего компонента - эффект тот же. Если контейнер невидим, не видны и все его компоненты. По умолчанию все компоненты видимы.</para>
            </listitem>
          </varlistentry>
          <varlistentry id="attr_width">
            <term>width</term>
            <listitem>
              <para>Атрибут, устанавливающий ширину компонента.</para>
              <para>Значение может быть задано в пикселях или в процентах от ширины вышестоящего контейнера. Например: 100px, 100%, 50. Если единица измерения не указана, подразумевается ширина в пикселях. Простановка значения в % означает, что компонент по ширине займет соотвествующую часть пространства, предоставляемого контейнером более высокого уровня.</para>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
      <section>
        <title>Элементы</title>
        <variablelist>
          <varlistentry id="element_formatter">
            <term>formatter</term>
            <listitem>
              <para>XML-элемент formatter задает класс, который будет применен для преобразования значения в строку.</para>
              <para>Атрибуты:</para>
              <itemizedlist>
                <listitem>
                  <para>class − имя класса, реализующего интерфейс <classname>com.haulmont.cuba.gui.components.Formatter</classname></para>
                </listitem>
              </itemizedlist>
            </listitem>
          </varlistentry>
          <varlistentry id="element_validator">
            <term>validator</term>
            <listitem>
              <para>XML-элемент для задания механизма валидации значений, введенных в визуальном компоненте.</para>
              <para>Атрибуты:</para>
              <itemizedlist>
                <listitem>
                  <para>script − путь к скрипту Groovy, осуществляющему валидацию</para>
                </listitem>
                <listitem>
                  <para>class − имя класса Java, реализующего интерфейс <interfacename>Field.Validator</interfacename></para>
                </listitem>
                <listitem>
                  <para>message − сообщение, выводимое пользователю в случае ошибки валидации. Атрибут должен содержать ключ сообщения в пакете, например, message=&quot;msg://infoTextField.validationMsg&quot;</para>
                </listitem>
              </itemizedlist>
              <para>Выбор механизма валидации осуществляется следующим образом:</para>
              <itemizedlist>
                <listitem>
                  <para>Если не указано значение атрибута script, и сам элемент validator не содержит текста выражения Groovy, то в качестве валидатора используется класс, указанный в атрибуте class.</para>
                </listitem>
                <listitem>
                  <para>Если элемент validator содержит текст, то он будет использован как выражение Groovy и выполнен с помощью <link linkend="section_scripting">Scripting</link>.</para>
                </listitem>
                <listitem>
                  <para>В противном случае с помощью <link linkend="section_scripting">Scripting</link> будет выполнен скрипт Groovy, указанный в атрибуте script.</para>
                </listitem>
              </itemizedlist>
              <para>В выражение или скрипт Groovy будет передана одна переменная value, содержащая значение, введенное в визуальном компоненте.</para>
              <para>Выражение или скрипт должны вернуть boolean значение: true - valid, false - not valid.</para>
              <para>CUBA уже содержит несколько реализаций наиболее часто используемых валидаторов (см. пакет <package>com.haulmont.cuba.gui.components.validators</package>), которые можно применять в своих проектах:</para>
              <itemizedlist>
                <listitem>
                  <para><classname>DateValidator</classname></para>
                </listitem>
                <listitem>
                  <para><classname>DoubleValidator</classname></para>
                </listitem>
                <listitem>
                  <para><classname>EmailValidator</classname></para>
                </listitem>
                <listitem>
                  <para><classname>IntegerValidator</classname></para>
                </listitem>
                <listitem>
                  <para><classname>LongValidator</classname></para>
                </listitem>
                <listitem>
                  <para><classname>PatternValidator</classname></para>
                </listitem>
                <listitem>
                  <para><classname>ScriptValidator</classname></para>
                </listitem>
              </itemizedlist>
              <para>Примеры использования:</para>
              <programlisting>&lt;field id=&quot;imei&quot;&gt;
    &lt;validator class=&quot;com.haulmont.cuba.gui.components.validators.PatternValidator&quot;
               pattern=&quot;\d{15}&quot;
               message=&quot;msg://general.imeiValidationFailed&quot;/&gt;
&lt;/field&gt;

&lt;field id=&quot;maxCountOfVisits&quot;&gt;
    &lt;validator class=&quot;com.haulmont.cuba.gui.components.validators.IntegerValidator&quot;/&gt;
&lt;/field&gt;</programlisting>
            </listitem>
          </varlistentry>
        </variablelist>
      </section>
    </section>
    <section id="section_datasource">
      <title>Источники данных</title>
      <para>Предназначен для реализации связанных с данными компонентов.</para>
      <para>Существуют следующие интерфейсы источников данных:</para>
      <itemizedlist>
        <listitem>
          <para><interfacename>Datasource</interfacename> − предназначен для работы с одним экземпляром сущности.</para>
          <itemizedlist>
            <listitem>
              <para><interfacename>RuntimePropsDatasource</interfacename> − предназначен для работы с динамическими свойствами сущностей.</para>
            </listitem>
          </itemizedlist>
        </listitem>
        <listitem>
          <para><interfacename>CollectionDatasource</interfacename> − предназначен для работы с коллекцией сущностей</para>
          <itemizedlist>
            <listitem>
              <para><interfacename>HierarchicalDatasource</interfacename> − предназначен для работы с компонентами <classname>Tree</classname>, <classname>TreeTable</classname>.</para>
            </listitem>
            <listitem>
              <para><interfacename>GroupDatasource</interfacename> − предназначен для работы с компонентом <classname>GroupTable</classname>.</para>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>
      <para>Как правило, источники данных объявляются декларативно в секции <parameter>dsContext</parameter> <glossterm linkend="glossary_xml_descriptor_id">дескриптора экрана</glossterm>.</para>
    </section>
    <section id="section_localization">
      <title>Пакеты локализованных сообщений</title>
      <para>Содержит файлы локализованных сообщений  для задания названий сущностей, атрибутов сущностей, папок, заголовков закладок и так далее. Правила создания файлов локализованных сообщений:</para>
      <itemizedlist>
        <listitem>
          <para>Файл по умолчанию имеет имя <filename>messages.properties</filename>, для конкретного языка − <filename>messages_ru.properties</filename> и т.д. При отсутствии файла конкретного языка или при отсутствии искомого ключа в файле конкретного языка будет использовано сообщение из файла по умолчанию.</para>
        </listitem>
        <listitem>
          <para>Кодировка <code>UTF-8</code>.</para>
        </listitem>
        <listitem>
          <para>Можно включать другие файлы сообщений с помощью ключа <literal>@include</literal>. При этом если некоторый ключ встречается и во включаемом файле, и в текущем, будет использовано сообщение из текущего (переопределение). Пример включения файла:<programlisting>@include=com.haulmont.cuba.web

actions.Create=Create
actions.Edit=Edit
...</programlisting></para>
        </listitem>
        <listitem>
          <para>Полным именем пакета сообщений считается имя Java-пакета, содержащего языковые файлы. Например, именем пакета сообщений, расположенного в <filename>/com/haulmont/cuba/web/app/ui/security/user/messages.properties</filename> является строка <package>com.haulmont.cuba.web.app.ui.security.user</package></para>
        </listitem>
      </itemizedlist>
    </section>
    <section id="section_appFolders">
      <title>Панель папок</title>
      <para>Папки поиска</para>
      <para>Папки данной категории могут быть созданы и настроены пользователем (за
исключением подкатегории &quot;Системные&quot;). Подкатегория &quot;Системные&quot; содержит
предустановленные папки поиска, которые доступны всем
пользователям системы.</para>
      <para>Папки поиска обладают следующими особенностями:</para>
      <itemizedlist>
        <listitem>
          <para>отображают экраны с <glossterm linkend="glossary_filter_id">generic-фильтром</glossterm>;</para>
        </listitem>
        <listitem>
          <para>создаются пользователем из любого отображенного экрана с generic-фильтром;</para>
        </listitem>
        <listitem>
          <para>пользователь может изменить иерархию, название, либо переопределить фильтр поиска. </para>
        </listitem>
      </itemizedlist>
      <para>Папки приложения</para>
      <para>Папки данной категории содержат задачи, по которым требуются
действия пользователя.</para>
      <para>Обладают следующими особенностями:</para>
      <itemizedlist>
        <listitem>
          <para>отображают предопределенные экраны с <glossterm linkend="glossary_filter_id">фильтром</glossterm> или без;</para>
        </listitem>
        <listitem>
          <para>набор папок зависит от ролей пользователя; </para>
        </listitem>
        <listitem>
          <para>пользователь не может изменить настройки папок;</para>
        </listitem>
        <listitem>
          <para>в заголовке папки может отображаться текущее количество входящих в нее записей;</para>
        </listitem>
        <listitem>
          <para>периодически обновляются по таймеру.</para>
        </listitem>
      </itemizedlist>
    </section>
    <section id="section_backgroundtasks">
      <title>Фоновые задачи</title>
      <para><emphasis role="bold">Предназначение</emphasis></para>
      <para>Фоновые задачи используются на клиентском уровне для выполнения длительных процессов без заморозки пользовательского интерфейса. </para>
      <para>В платформе реализован объект <classname>BackgroundWorker</classname>, который предоставляется окружением и управляет фоновыми задачами</para>
      <programlisting>BackgroundWorker backgroundWorker = AppConfig.getBackgroundWorker();</programlisting>
      <para><emphasis role="bold">Использование</emphasis></para>
      <orderedlist>
        <listitem>
          <para>Задача описывается как наследник абстрактного класса <classname>BackgroundTask</classname>. Для нее необходимо задать окно, которому принадлежит задача и описать главный метод <methodname>run()</methodname>.</para>
        </listitem>
        <listitem>
          <para>Создается объект управления задачей − <classname>BackgroundTaskHandler</classname>. Для этого задачу необходимо передать классу <classname>BackgroundWorker</classname>.</para>
        </listitem>
        <listitem>
          <para>Выполняется запуск задачи</para>
          <programlisting>// Задача с ограничением 10 секунд и с текущим окном в качестве родителя
final BackgroundTask&lt;Integer, Void&gt; progressIndicator = new BackgroundTask&lt;Integer, Void&gt;(10, this) {
    @Override
    public Void run(TaskLifeCycle&lt;T&gt; taskLifeCycle) {
        // 1 2 3 4 5 :-)
        for (int i = 0; i &lt; 5; i++) {
            Long res;
            try {
                TimeUnit.SECONDS.sleep(1);
            } catch (InterruptedException ignored) {
                return null;
            }
            // Оглашаем прогресс
            taskLifeCycle.publish(i);
        }
        return null;
    }

    @Override
    public void canceled() {
        // отменено
    }

    @Override
    public void done(Void result) {
        // завершено
    }

    @Override
    public void progress(List&lt;Integer&gt; changes) {
        // индикация прогресса
    }

    @Override
    public Map&lt;String, Object&gt; getParams() {
        // передаём параметры
        return Collections.emptyMap();
    }
};

// Получение управляющего объекта и запуск
BackgroundTaskHandler taskHandler = backgroundWorker.handle(progressIndicator);
taskHandler.execute();</programlisting>
        </listitem>
      </orderedlist>
      <para><emphasis role="bold">Объект задачи</emphasis></para>
      <para><classname>BackgroundTask&lt;T, V&gt;</classname> − параметризованный класс:</para>
      <itemizedlist>
        <listitem>
          <para><classname>T</classname> − тип объектов, показывающих прогресс задачи. Они передаются в метод <methodname>progress()</methodname> при вызове <methodname>publish()</methodname> в рабочем потоке</para>
        </listitem>
        <listitem>
          <para><classname>V</classname> − тип результата задачи, его можно получить после выполнения задачи или вызвать синхронно <methodname>getResult()</methodname> для ожидания.</para>
        </listitem>
      </itemizedlist>
      <para>Метод <methodname>canceled()</methodname> вызывается только в случае управляемой отмены задачи (то есть при вызове <methodname>cancel()</methodname> у <classname>TaskHandler</classname>).</para>
      <para>Если у задачи истек таймаут, или было закрыто окно, в котором она исполнялась, то задача будет завершена без уведомлений.</para>
      <warning>
        <para>Следует помнить, что в Java невозможно прервать поток, если он не использует операций, выбрасывающих <errorname>InterrruptedException</errorname>. Никогда не перехватывайте это исключение или все исключения с целью тихо завершить операцию. Хорошим тоном является проверка флага <classname>isInterrupted()</classname> у объекта <classname>TaskLifeCycle</classname> в различных циклических операциях, для того чтобы вовремя отменить выполнение при прерывании задачи.</para>
      </warning>
      <para>Объекты <classname>BackgroundTask</classname> не имеют состояния. Если придерживаться этого подхода и не заводить полей для хранения промежуточных данных, то можно использовать множество параллельно работающих задач, используя всего один объект задачи.</para>
      <para>Объект <classname>BackgroundHandler</classname> можно запускать всего один раз; если требуется частый перезапуск задач, то используйте <classname>BackgroundTaskWrapper</classname></para>
      <para><emphasis role="bold">Отображение фоновых действий для пользователя</emphasis></para>
      <para>Иногда необходимо показывать пользователю окно с прогрессом и кнопкой <guibutton>Отмена</guibutton>. Для этого есть <classname>BackgroundWorkWindow&lt;T,V&gt;</classname> с набором статических методов.
В окне можно отображать статус задачи и разрешать/запрещать отмену фонового процесса.</para>
      <para><emphasis role="bold">Отслеживание исполнения задач</emphasis></para>
      <para>Если Вы хотите использовать параметры из UI компонентов, то необходимо переопределить метод <methodname>Map&lt;String, Object&gt; getParams()</methodname> . Он выполняется один раз при запуске задачи в потоке UI. В методе <methodname>run</methodname> они доступны в объекте <classname>TaskLifeCycle</classname>, аксессор − <methodname>getParams()</methodname>.</para>
      <para>При возникновении исключительных ситуаций вызывается метод <methodname>handleException</methodname>, в котором можно отобразить ошибку на UI.</para>
      <para>Для отмены и удаления зависших задач предусмотрены следующие меры:</para>
      <orderedlist>
        <listitem>
          <para><classname>WatchDog</classname> − поток, постоянно проверяющий задачи на истечение таймаута. Зависшие задачи прерываются и удаляются из обработки</para>
        </listitem>
        <listitem>
          <para>При закрытии родительского окна задачи она прерывается</para>
        </listitem>
        <listitem>
          <para>По истечению сессии пользователя все его задачи прерываются.
Для этого в <filename>web.xml</filename> указать:</para>
          <programlisting>&lt;listener&gt;
    &lt;listener-class&gt;com.haulmont.cuba.web.gui.utils.BackgroundWorkerListener&lt;/listener-class&gt;
&lt;/listener&gt;</programlisting>
        </listitem>
      </orderedlist>
      <para><emphasis role="bold">Объявление WatchDog</emphasis></para>
      <para>В <filename>app-web-spring.xml</filename> и <filename>app-desktop-spring.xml</filename> добавить объявление задачи по расписанию:</para>
      <programlisting>&lt;bean id=&quot;backgroundWorkerScheduler&quot; class=&quot;org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler&quot;&gt;
    &lt;property name=&quot;daemon&quot; value=&quot;true&quot;/&gt;
    &lt;property name=&quot;poolSize&quot; value=&quot;1&quot;/&gt;
&lt;/bean&gt;

&lt;task:scheduled-tasks scheduler=&quot;backgroundWorkerScheduler&quot;&gt;
    &lt;task:scheduled ref=&quot;cuba_BackgroundWorker_WatchDog&quot; method=&quot;cleanupTasks&quot; fixed-delay=&quot;2000&quot;/&gt;
&lt;/task:scheduled-tasks&gt; </programlisting>
      <para><emphasis role="bold">Настройки</emphasis></para>
      <para>Для Web слоя в WebConfig настраивается частота проверки изменений на стороне клиента (браузера): <parameter>cuba.backgroundWorker.uiCheckInterval</parameter> ( По умолчанию 2000 мс )</para>
    </section>
    <section>
      <title>Создание экранов</title>
      <section id="section_controller">
        <title>Контроллер экрана</title>
        <para><classname>Java</classname> или <classname>Groovy</classname> класс,  в котором можно реализовывать бизнес-логику и управлять поведением компонентов, описанных в <glossterm linkend="glossary_xml_descriptor_id">xml-дескрипторе</glossterm>, с помощью различных событий. Контроллер должен быть унаследован от одного из следующих базовых классов:</para>
        <itemizedlist>
          <listitem>
            <para><classname>AbstractFrame</classname> − реализует интерфейс <interfacename>IFrame</interfacename> и предназначен для реализации фреймов − многократно используемых компонентов экранов.</para>
          </listitem>
          <listitem>
            <para><classname>AbstractWindow</classname> − реализует интерфейc <interfacename>Window</interfacename> и предназначен для реализации любых экранов.</para>
          </listitem>
          <listitem>
            <para><classname>AbstractLookup</classname> − реализует интерфейс <interfacename>Lookup</interfacename> и предназначен для реализации <glossterm linkend="glossary_browser_id">браузеров</glossterm> с возможностью выбора элемента списка для использования его в вызывающем экране.</para>
          </listitem>
          <listitem>
            <para><classname>AbstractEditor</classname> − реализует интерфейс <interfacename>Editor</interfacename> и предназначен для реализации экранов редактирования экземпляра сущности.</para>
          </listitem>
        </itemizedlist>
        <para>Основной метод контроллера − <methodname>init()</methodname>. Этот метод вызывается после создания класса окна и всего дерева компонентов, описанного XML-дескриптором. Контроллер может в этом методе произвести инициализацию экрана перед его открытием (например, создать обработчики нажатий на кнопки и пр.).</para>
        <para>В метод <methodname>init()</methodname> из вызывающего кода передается коллекция параметров, состоящая из пар «ключ − значение». Вызывающим кодом может быть как контроллер другого экрана, так и пункт главного меню, либо прямая ссылка на экран извне приложения. Каждый параметр передается в коллекции в двух экземплярах − с простым именем и с тем же именем с префиксом param$.</para>
        <para>Класс контроллера должен быть зарегистрирован в XML-дескрипторе экрана в атрибуте <parameter>class</parameter> корневого элемента.</para>
        <section id="section_AbstractEditor">
          <title>AbstractEditor</title>
          <para><classname>AbstractEditor</classname> − базовый класс контроллеров экранов редактирования экземпляра сущности.</para>
          <para>При создании конкретного класса контроллера рекомендуется параметризовать <classname>AbstractEditor</classname> типом редактируемой сущности. При этом методы <methodname>getItem</methodname> и <methodname>initItem</methodname> будут работать с конкретным типом сущности и прикладному коду не потребуется дополнительных приведений типов. Например:</para>
          <programlisting>public class UserEditor extends AbstractEditor&lt;User&gt; {
...
    @Override
    protected void initItem(User item) {
    ...</programlisting>
          <para>Помимо общего для всех <glossterm linkend="glossary_controller_id">контроллеров</glossterm> метода <methodname>init</methodname> в контроллере экрана редактирования можно переопределить следующие:</para>
          <itemizedlist>
            <listitem>
              <para>Методы инициализации:</para>
              <itemizedlist>
                <listitem>
                  <para><methodname>initItem</methodname></para>
                </listitem>
                <listitem>
                  <para><methodname>postInit</methodname></para>
                </listitem>
              </itemizedlist>
            </listitem>
            <listitem>
              <para>Методы завершения:</para>
              <itemizedlist>
                <listitem>
                  <para><methodname>postValidate</methodname></para>
                </listitem>
                <listitem>
                  <para><methodname>preCommit</methodname></para>
                </listitem>
                <listitem>
                  <para><methodname>postCommit</methodname></para>
                </listitem>
              </itemizedlist>
            </listitem>
          </itemizedlist>
          <para><emphasis role="bold">Диаграммы последовательностей</emphasis></para>
          <figure>
            <title>Инициализация экрана</title>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/EditorInit.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <figure>
            <title>Коммит и закрытие экрана с фреймом editWindowActions</title>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/EditorCommit.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <figure>
            <title>Коммит экрана с фреймом extendedEditWindowActions</title>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/ExtendedEditorCommit.png"/>
              </imageobject>
            </mediaobject>
          </figure>
          <figure>
            <title>Коммит и закрытие экрана с фреймом extendedEditWindowActions</title>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="img/ExtendedEditorCommitAndClose.png"/>
              </imageobject>
            </mediaobject>
          </figure>
        </section>
      </section>
      <section>
        <title>XML-дескриптор</title>
        <para>Описывает <glossterm linkend="glossary_datasource_id">источники данных</glossterm> и расположение визуальных компонентов экрана.</para>
        <para>XML-дескриптор содержит следующие элементы:</para>
        <itemizedlist>
          <listitem>
            <para><parameter>window</parameter> − корневой элемент. Атрибуты:</para>
            <orderedlist>
              <listitem>
                <para><property>xmlns</property>=&quot;http://www.haulmont.com/schema/cuba/gui/window.xsd&quot; − схема XML</para>
              </listitem>
              <listitem>
                <para><property>class</property> − имя класса <glossterm linkend="glossary_controller_id">контроллера</glossterm></para>
              </listitem>
              <listitem>
                <para><property>messagesPack</property> − имя <glossterm linkend="glossary_localized_folders_id">пакета сообщений</glossterm>. Фактически это имя Java-пакета, содержащего файл  <filename>messages.properties</filename></para>
              </listitem>
              <listitem>
                <para><property>caption</property> − заголовок экрана, должен содержать ссылку на сообщение из вышеуказанного пакета, например, <programlisting>caption=&quot;msg://caption&quot;</programlisting></para>
              </listitem>
              <listitem>
                <para><property>focusComponent</property> − идентификатор компонента, который получит фокус ввода при отображениее экрана (необязательно).</para>
              </listitem>
            </orderedlist>
          </listitem>
          <listitem>
            <para><parameter>metadataContext</parameter> − опциональный элемент для инициализации <glossterm linkend="glossary_view_ru_id">представлений</glossterm> (views). Предпочтительным является определение всех представлений в одном общем файле <filename>ext-views.xml</filename>  модуля <structname>core</structname>. </para>
          </listitem>
          <listitem>
            <para><parameter>dsContext</parameter> − элемент, определяющий <glossterm linkend="glossary_datasource_id">источники данных</glossterm> данного экрана. Источники данных предназначены для реализации связанных с данными  компонентов.</para>
          </listitem>
          <listitem>
            <para><parameter>layout</parameter> − элемент, определяющий компоновку экрана.</para>
          </listitem>
        </itemizedlist>
      </section>
      <section id="section_registration_screens">
        <title>Регистрация экранов</title>
        <para>Все экраны, доступные в приложении, регистрируются в  файлах <filename>*-screens.xml</filename>.</para>
        <para>Набор файлов <filename>*-screens.xml</filename> конкретного проекта указывается в <glossterm linkend="glossary_app_properties_id">свойстве приложения</glossterm> <parameter>cuba.windowConfig</parameter>.</para>
        <itemizedlist>
          <title>Элементы XML</title>
          <listitem>
            <para><emphasis role="bold">screen-config</emphasis> − корневой элемент</para>
          </listitem>
          <listitem>
            <para><emphasis role="bold">include</emphasis> − включение другого <filename>*-screens.xml</filename>. Вместо включения рекомендуется использовать комбинацию файлов в <glossterm linkend="glossary_app_properties_id">свойстве приложения</glossterm> <parameter>cuba.windowConfig</parameter>. Атрибуты:</para>
            <itemizedlist>
              <listitem>
                <para><emphasis role="bold">file</emphasis> − путь к файлу, начиная от каталога конфигурации приложения <filename>WEB-INF/conf</filename></para>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para><emphasis role="bold">screen</emphasis> − регистрация экрана. Атрибуты:</para>
            <itemizedlist>
              <listitem>
                <para><emphasis role="bold">id</emphasis> − идентификатор  экрана, по которому   производится обращение</para>
              </listitem>
              <listitem>
                <para><emphasis role="bold">template</emphasis> − путь к <glossterm linkend="glossary_xml_descriptor_id">дескриптору</glossterm> экрана. Сначала будет произведена попытка найти дескриптор в каталоге конфигурации приложения <filename>WEB-INF/conf</filename>. Если его там нет, то будет произведен поиск в <filename>classpath</filename>.</para>
              </listitem>
              <listitem>
                <para><emphasis role="bold">class</emphasis> − имя класса. Элемент может быть использован вместо <emphasis role="bold">template</emphasis>. Класс должен реализовывать либо интерфейс <interface>Callable</interface>, либо интерфейс <interface>Runnable</interface>. В случае реализации интерфейса <interface>Callable</interface> метод <methodname>call()</methodname> должен возвращать экземпляр созданного <classname>Window</classname>, который будет возвращен как результат вызова <methodname>WindowManager.openWindow()</methodname>. Класс может содержать конструктор с параметрами для передачи ему строковых значений, заданных атрибутом <emphasis role="bold">param</emphasis>.</para>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para><emphasis role="bold">params</emphasis> − задает параметры вызова экрана. Элемент используется внутри элемента <emphasis role="bold">screen</emphasis>. Параметры вызова позволяют задать несколько идентификаторов одному дескриптору экрана. Параметры будут переданы <glossterm linkend="glossary_controller_id">контроллеру</glossterm> экрана в мапе на входе <methodname>init()</methodname>, либо в конструктор класса, если задан <emphasis role="bold">class</emphasis>.</para>
          </listitem>
          <listitem>
            <para><emphasis role="bold">param</emphasis> − задает параметр внутри элемента <emphasis role="bold">params</emphasis>. Атрибуты:</para>
            <itemizedlist>
              <listitem>
                <para><emphasis role="bold">name</emphasis> − имя параметра</para>
              </listitem>
              <listitem>
                <para><emphasis role="bold">value</emphasis> − значение параметра. Если значение содержит строку &quot;true&quot; или &quot;false&quot;, в параметры экрана будет передано соответствующее значение типа <classname>Boolean</classname>.</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>
      </section>
    </section>
  </section>
  <section>
    <title>Механизмы платформы</title>
    <section id="section_extending_funct">
      <title>Механизмы расширения функциональности</title>
      <para>TODO</para>
    </section>
    <section id="section_fts">
      <title>Механизм полнотекстового поиска</title>
      <para>Полнотекстовый поиск предоставляет возможность неструктурированного поиска по всем атрибутам <glossterm linkend="glossary_entity">сущностей</glossterm> и по содержимому вложенных файлов.</para>
      <para>FTS содержит два взаимосвязанных механизма − индексирование и  поиск.</para>
      <para><emphasis role="bold">Индексирование</emphasis>. Изменения сущностей отслеживаются на уровне <glossterm linkend="glossary_entityManager_id">EntityManager</glossterm>&apos;а. Если изменился атрибут сущности, подлежащий индексированию, информация о сущности записывается в таблицу <database>SYS_FTS_QUEUE</database> с помощью <classname>FtsSenderBean</classname>. Отдельный асинхронный процесс извлекает ссылки на изменившиеся сущности из очереди, загружает сущности и индексирует их. </para>
      <para>Под индексируемыми атрибутами понимаются атрибуты данной сущности и  ссылающихся на нее сущностей, объявленные в <glossterm linkend="glossary_descriptor_fts_id">дескрипторе FTS</glossterm>.</para>
      <para><emphasis role="bold">Поиск</emphasis>. Поиск ведется по совпадению искомой строки с началом слов индексированных данных.

При включенном FTS главное окно приложения содержит поле поиска. Поиск производится с помощью <classname>FtsServiceBean</classname> и результаты отображаются в окне <filename>search-results.xml</filename>.

</para>
      <para>Дескриптор <glossterm linkend="glossary_fts_id">FTS</glossterm> представляет собой XML файл, содержащий настройки механизма полнотекстового поиска. Элементы дескриптора:</para>
      <itemizedlist>
        <listitem>
          <para><parameter>include</parameter>. Включение содержимого другого дескриптора. Атрибут <property>file</property> − путь к включаемому файлу относительно каталога конфигурации.</para>
        </listitem>
        <listitem>
          <para><parameter>entities</parameter>. Список сущностей, подлежащих индексированию и поиску.</para>
          <itemizedlist>
            <listitem>
              <para><parameter>entity</parameter>. Описание индексируемой сущности.
Атрибуты:</para>
              <itemizedlist>
                <listitem>
                  <para><property>class</property> − java класс <glossterm linkend="glossary_entity">сущности</glossterm>;</para>
                </listitem>
                <listitem>
                  <para><property>show</property> (true/false) − должна ли данная сущность показываться в результатах поиска самостоятельно. False используется для сущностей-связей, которые нужны, например, для связи  файлов и карточек;</para>
                </listitem>
              </itemizedlist>
            </listitem>
            <listitem>
              <para><parameter>include</parameter> − включить атрибут сущности в индекс.
Атрибуты:</para>
              <itemizedlist>
                <listitem>
                  <para><property>re</property> − регулярное выражение для отбора атрибутов по имени. Отбираются только атрибуты следующих типов: строка, число, дата, перечисление;</para>
                </listitem>
                <listitem>
                  <para><property>name</property> − имя атрибута, может быть путем по ссылочным атрибутам. Тип не проверяется, однако если имя является путем, то конечный атрибут должен быть сущностью, а не простым типом (атрибут простого типа не имеет здесь смысла, он должен индексироваться в своей сущности);</para>
                </listitem>
              </itemizedlist>
            </listitem>
            <listitem>
              <para><parameter>exclude</parameter> − исключить ранее включенный атрибут. Возможные атрибуты такие же как в элементе <parameter>include</parameter>;</para>
            </listitem>
            <listitem>
              <para><parameter>searchables</parameter> − <classname>Groovy</classname>-скрипт для добавления в очередь на индексирование произвольных сущностей, связанных с измененной. Скрипт оперирует двумя переменными:</para>
              <para><varname>searchables</varname> − список сущностей;</para>
              <para><varname>entity</varname> − текущая сущность, помещаемая в очередь автоматически;</para>
            </listitem>
            <listitem>
              <para><parameter>searchableIf</parameter> − <classname>Groovy</classname>-скрипт для ограничения помещения в очередь некоторых экземпляров индексируемой сущности.
Скрипт оперирует переменной <varname>entity</varname> (текущая сущность, которую нужно проверить).</para>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>
      <para>Пример дескриптора:</para>
      <para><programlisting>&lt;fts-config&gt;
  &lt;include file=&quot;cuba/fts-config.xml&quot;/&gt;
  &lt;entities&gt;
    &lt;entity class=&quot;com.haulmont.workflow.core.entity.CardAttachment&quot; show=&quot;false&quot;&gt;
      &lt;include re=&quot;.*&quot;/&gt;
      &lt;exclude name=&quot;card&quot;/&gt;
      &lt;searchables&gt;
        searchables.add(entity.card)
      &lt;/searchables&gt;
    &lt;/entity&gt;

    &lt;entity class=&quot;com.haulmont.workflow.core.entity.AssignmentAttachment&quot; show=&quot;false&quot;&gt;
      &lt;include re=&quot;.*&quot;/&gt;
      &lt;exclude name=&quot;assignment&quot;/&gt;
      &lt;searchables&gt;
        searchables.add(entity.assignment.card)
      &lt;/searchables&gt;
    &lt;/entity&gt;

    &lt;entity class=&quot;com.haulmont.taskman.core.entity.ProjectGroup&quot;&gt;
      &lt;include name=&quot;name&quot;/&gt;
    &lt;/entity&gt;

    &lt;entity class=&quot;com.haulmont.taskman.core.entity.Project&quot;&gt;
      &lt;include re=&quot;.*&quot;/&gt;
    &lt;/entity&gt;

    &lt;entity class=&quot;com.haulmont.taskman.core.entity.Task&quot;&gt;
      &lt;include re=&quot;.*&quot;/&gt;
      &lt;include name=&quot;attachments.file&quot;/&gt;
      &lt;include name=&quot;assignments.attachments.file&quot;/&gt;
      &lt;exclude name=&quot;parentCard&quot;/&gt;
      &lt;exclude name=&quot;subCards&quot;/&gt;
      &lt;exclude name=&quot;timeUnit&quot;/&gt;
    &lt;/entity&gt;

    &lt;entity class=&quot;com.haulmont.docflow.core.entity.Contract&quot;&gt;
      &lt;include re=&quot;.*&quot;/&gt;
      &lt;include name=&quot;attachments.file&quot;/&gt;
      &lt;include name=&quot;assignments.attachments.file&quot;/&gt;
      &lt;exclude name=&quot;parentCard&quot;/&gt;
      &lt;exclude name=&quot;subCards&quot;/&gt;
      &lt;searchableIf&gt;
        entity.versionOf == null
      &lt;/searchableIf&gt;
    &lt;/entity&gt;
  &lt;/entities&gt;
&lt;/fts-config&gt;</programlisting></para>
    </section>
    <section id="section_database_update">
      <title>Механизм автоматического обновления базы данных</title>
      <para>TODO</para>
    </section>
    <section id="section_charts">
      <title>Механизм отображения диаграмм</title>
      <para>TODO</para>
    </section>
    <section id="section_scheduled_tasks">
      <title>Механизм реализации назначенных заданий</title>
      <para>TODO</para>
    </section>
    <section id="section_runtime_properties">
      <title>Динамические атрибуты</title>
      <para>TODO</para>
    </section>
    <section id="section_objects_cache">
      <title>Механизм организации кэшей данных</title>
      <para>TODO</para>
    </section>
    <section id="section_audit">
      <title>Механизм ведения журнала аудита изменений сущностей и сохранения версий</title>
      <para>TODO</para>
    </section>
  </section>
  <section id="section_restapi">
    <title>Интеграция со сторонними приложениями</title>
    <para>TODO</para>
  </section>
  <section>
    <title>Подсистема работы с конфигурационными параметрами</title>
    <para>Подсистема работы с конфигурационными параметрами позволяет сохранять/извлекать пары имя-значение с помощью стандартных Java-интерфейсов. При этом хранилищем параметров может быть база данных, системные свойства Java, и свойства приложения, задаваемые в файлах app.properties.</para>
    <para>Рекомендуется использовать только для хранения системных настроек, доступных администратору системы. Для хранения настроек пользователя лучше создавать отдельную сущность для их хранения и использовать стандартный эдитор для редактирования.</para>
    <para><emphasis role="bold">Использование</emphasis></para>
    <para>Для создания конфигурационного параметра необходимо:</para>
    <itemizedlist>
      <listitem>
        <para>Создать интерфейс, унаследованный от <interface>com.haulmont.cuba.core.config.Config</interface></para>
      </listitem>
      <listitem>
        <para>Создать методы доступа к параметру (getXXX/setXXX). Возможный тип параметра обсуждается ниже.</para>
      </listitem>
      <listitem>
        <para>Добавить интерфейсу аннотацию <literal>@Prefix</literal> для указания префикса имен входящих в интрефейс параметров</para>
      </listitem>
      <listitem>
        <para>Добавить интерфейсу и/или параметру аннотацию <literal>@Source</literal> для указания источника (места хранения) параметров</para>
      </listitem>
    </itemizedlist>
    <para>Например:</para>
    <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_architecture/configurationParameters/example1.txt" encoding="UTF-8" parse="text"/></programlisting>
    <para>Реализовывать интерфейс не нужно.</para>
    <para>Для получения доступа к параметрам используется интерфейс инфраструктуры <interface>Configuration</interface> или его статический фасад <interface>ConfigProvider</interface>.</para>
    <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_architecture/configurationParameters/example2.txt" encoding="UTF-8" parse="text"/></programlisting>
    <para>Стандартный UI для доступа к параметрам, хранящимся в базе данных, предоставляет МБин haulmont.cuba:service=ConfigStorage. Он содержит следующие методы:</para>
    <itemizedlist>
      <listitem>
        <para>setProperty(p1, p2) - установить параметр с именем p1 в значение p2</para>
      </listitem>
      <listitem>
        <para>getProperty(p1) - показать параметр с именем p1</para>
      </listitem>
      <listitem>
        <para>removeProperty(p1) - удалить параметр с именем p1</para>
      </listitem>
      <listitem>
        <para>printProperties(p1) - показать все параметры с фильтром на имя p1 по правилам SQL like</para>
      </listitem>
      <listitem>
        <para>printProperties - показать все параметры</para>
      </listitem>
      <listitem>
        <para>loadSystemProperties - загрузить в System.properties параметры из файла conf/system.properties</para>
      </listitem>
    </itemizedlist>
    <para><emphasis role="bold">Возможности</emphasis></para>
    <para><emphasis role="bold">Имена параметров</emphasis></para>
    <para>Имя параметра в БД или в app.properties формируется по следующему принципу:</para>
    <itemizedlist>
      <listitem>
        <para>Если на параметре есть аннотация <literal>@Property</literal>, то берется ее значение</para>
      </listitem>
      <listitem>
        <para>Иначе:</para>
        <itemizedlist>
          <listitem>
            <para>Если есть аннотация <literal>@Prefix</literal>, берется ее значение</para>
          </listitem>
          <listitem>
            <para>Если нет аннотации <literal>@Prefix</literal>, то</para>
            <itemizedlist>
              <listitem>
                <para>Если интерфейс является внутренним, то берется полное имя включающего класса и добавляется &quot;.&quot;</para>
              </listitem>
              <listitem>
                <para>Иначе берется полное имя пакета и добавляется &quot;.&quot;</para>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para>Добавляется декапитализированное имя метода доступа без get/set/is (см. комментарии к методу <methodname>com.haulmont.cuba.core.config.ConfigUtil#extendedUncapitalize</methodname>)</para>
          </listitem>
        </itemizedlist>
      </listitem>
    </itemizedlist>
    <para><emphasis role="bold">Источники параметров</emphasis></para>
    <para>В соответствии со значениями <classname>com.haulmont.cuba.core.config.SourceType</classname> на данный момент возможны 3 источника параметров: app.propperties, System.properties или база данных.</para>
    <para>В случае базы данных параметры хранятся в таблице <database>SYS_CONFIG</database>.</para>
    <para>Аннотация <literal>@Source</literal> может быть задана как на весь интерфейс, так и на отдельный параметр. В первом случае она определяет источник всех параметров данного интерфейса. Во втором случае она переопределяет источник для данного параметра, если он отличен от указанного для интерфейса.</para>
    <para><emphasis role="bold">Типы параметров</emphasis></para>
    <para>Без дополнительных усилий параметр может быть любого простого типа либо его объектного аналога (String, int, Integer, etc.) либо сущностью, реализующей интерфейс Entity.</para>
    <para>Для произвольного типа необходимо реализовать классы TypeStringify и TypeFactory для пребразования значения в строку и из нее, и указать эти классы для параметра с помощью аннотаций @Stringify и @Factory.</para>
    <para>Рассмотрим этот процесс на примере типа UUID.</para>
    <itemizedlist>
      <listitem>
        <para>Создаем класс com.haulmont.cuba.core.config.type.UuidTypeFactory унаследованный от com.haulmont.cuba.core.config.type.TypeFactory и реализуем в нем метод:</para>
        <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_architecture/configurationParameters/example3.txt" encoding="UTF-8" parse="text"/></programlisting>
      </listitem>
      <listitem>
        <para>TypeStringify создавать не нужно, т.к. по умолчанию будет использован Object.toString() - в данном случае он нам подходит.</para>
      </listitem>
      <listitem>
        <para>Аннотируем параметр:</para>
        <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_architecture/configurationParameters/example4.txt" encoding="UTF-8" parse="text"/></programlisting>
      </listitem>
    </itemizedlist>
    <para><emphasis role="bold">Значения по-умолчанию</emphasis></para>
    <para>Для параметров могут быть заданы значения по-умолчанию. Эти значения будут возвращаться если данный параметр не задан (не существует в БД или в app.properties).</para>
    <para>Дефолтное значение может быть задано в виде строки с помощью аннотации @com.haulmont.cuba.core.config.defaults.Default, либо в виде конкретного типа с помощью других аннотаций пакета com.haulmont.cuba.core.config.defaults.</para>
    <para>Для сущностей дефолтное значение задается в виде имя_сущности-id-имя_представления, например</para>
    <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/section_architecture/configurationParameters/example5.txt" encoding="UTF-8" parse="text"/></programlisting>
    <para>имя представления необязательно.</para>
  </section>
  <section>
    <title>Описание конфигурационных файлов</title>
    <variablelist>
      <varlistentry id="text_context_xml">
        <term>context.xml</term>
        <listitem>
          <para>В данном конфигурационном файле задается <link linkend="section_dbms_types">тип используемой СУБД</link>, а также использование <classname>PersistenceManager</classname>.</para>
          <para>Пример файла <filename>context.xml</filename> для приложения <link linkend="section_quick_start_data_model">Магазин</link>:</para>
          <programlisting language="xml"><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/context.xml" encoding="UTF-8" parse="text"/></programlisting>
        </listitem>
      </varlistentry>
      <varlistentry id="text_web_xml_core">
        <term>web.xml</term>
        <listitem>
          <para>Файл <filename>web.xml</filename> модуля <structname>core</structname> приложения <link linkend="section_quick_start_data_model">Магазин</link>:</para>
          <programlisting language="xml"><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/web.xml" encoding="UTF-8" parse="text"/></programlisting>
        </listitem>
      </varlistentry>
    </variablelist>
    <para>TODO</para>
  </section>
  <section id="section_dbms_types">
    <title>Поддерживаемые СУБД</title>
    <para>Тип используемой СУБД определяется <glossterm linkend="glossary_app_properties_id">параметром</glossterm> <link linkend="section_middleware_id">среднего слоя</link> <parameter>cuba.dbmsType</parameter> и настройкой источника данных в <application>Tomcat</application>.</para>
    <variablelist>
      <varlistentry>
        <term>PostgreSQL</term>
        <listitem>
          <para>Поддерживается всеми проектами платформы: CUBA, Workflow, FTS, Charts, CCPayments, RefApp.</para>
          <para><emphasis role="bold">Настройка</emphasis></para>
          <para>Параметр среднего слоя:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/cuba_dbmstype_postgres.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Источник данных в <link linkend="text_context_xml">context.xml</link>:</para>
          <programlisting language="xml"><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/context_postgres.xml" encoding="UTF-8" parse="text"/></programlisting>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Microsoft SQL Server</term>
        <listitem>
          <para>Поддерживается проектами: CUBA, Workflow, FTS, RefApp.</para>
          <para><emphasis role="bold">Настройка</emphasis></para>
          <para>Параметр среднего слоя:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/cuba_dbmstype_mssql.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Источник данных в <link linkend="text_context_xml">context.xml</link>:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/context_mssql.xml" encoding="UTF-8" parse="text"/></programlisting>
          <para>В настройках MS SQL надо включить возможность логина для пользователя sa и задать для него пароль из context.xml. Это можно сделать из MS SQL Management Studio, в окне Object Explorer.

Instance - ваш SQL Server.</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/instance_mssql.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Включить сетевую аутентификацию:</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/instance1_mssql.txt" encoding="UTF-8" parse="text"/></programlisting>
          <para>Разрешить доступ по TCP/IP можно из Sql Server Configuration Manager</para>
          <programlisting><xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="source/instance2_mssql.txt" encoding="UTF-8" parse="text"/></programlisting>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
</chapter>
